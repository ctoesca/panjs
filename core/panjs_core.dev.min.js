function array_replace_recursive(a){var b={},c=0,d="",e=arguments.length;if(2>e)throw Error("There should be at least 2 arguments passed to array_replace_recursive()");for(d in a)b[d]=a[d];for(c=1;c<e;c++)for(d in arguments[c])b[d]=b[d]&&"object"===typeof b[d]?this.array_replace_recursive(b[d],arguments[c][d]):arguments[c][d];return b}function randomBetween(a,b){return Math.floor(Math.random()*b)+a}
function generateUUID(){var a=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var c=(a+16*Math.random())%16|0;a=Math.floor(a/16);return("x"==b?c:c&7|8).toString(16)})}function getDocHeight(){var a=document;return Math.max(Math.max(a.body.scrollHeight,a.documentElement.scrollHeight),Math.max(a.body.offsetHeight,a.documentElement.offsetHeight),Math.max(a.body.clientHeight,a.documentElement.clientHeight))}
function changeFavicon(a){document.head=document.head||document.getElementsByTagName("head")[0];var b=document.createElement("link"),c=document.getElementById("dynamic-favicon");b.id="dynamic-favicon";b.rel="shortcut icon";b.href=a;c&&document.head.removeChild(c);document.head.appendChild(b)}function getXml(a){return a.xml?a.xml:(new XMLSerializer).serializeToString(a)}
function getXmlDocument(a){if(window.DOMParser){var b=new DOMParser;try{xmlDoc=b.parseFromString(a,"text/xml")}catch(c){throw"XML parsing error.";}}else window.MsxmlObject||(window.MsxmlObject=new ActiveXObject("MSXML.DOMDocument")),xmlDoc=window.MsxmlObject,xmlDoc.loadXML(a);a=null;xmlDoc.parseError&&0!=xmlDoc.parseError.errorCode?a="XML Parsing Error: "+xmlDoc.parseError.reason+" at line "+xmlDoc.parseError.line+" at position "+xmlDoc.parseError.linepos:xmlDoc.documentElement?(b=xmlDoc.getElementsByTagName("parsererror"),
0<b.length&&(a=b[0].textContent)):a="XML Parsing Error!";if(a)throw a;return xmlDoc}function defined(a){if("undefined"!=typeof a&&null!=a){for(var b=a,c=1;c<arguments.length;c++)if(defined(b[arguments[c]]))b=b[arguments[c]];else return!1;return!0}return!1}function _extractBrowserVersion(a){var b=-1;a=new RegExp(a);null!=a.exec(navigator.userAgent)&&(b=parseFloat(RegExp.$1));return b}function getIEVersion(){return _extractBrowserVersion("MSIE ([0-9]{1,}[.0-9]{0,})")}
function getFirefoxVersion(){return _extractBrowserVersion("Firefox/([0-9]*).")}function getChromeVersion(){return _extractBrowserVersion("Chrome/([0-9]*).")}String.prototype.contains=function(a){return-1<this.indexOf(a)};String.prototype.leftOf=function(a){a=this.indexOf(a,0);return 0<=a?this.substring(0,a):""};String.prototype.capitalizeFirstLetter=function(){return 0==this.length?this:this.charAt(0).toUpperCase()+this.slice(1)};
String.prototype.htmlEntities=function(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};String.prototype.rightOf=function(a){var b=this.indexOf(a);return-1<b?this.substring(b+a.length,this.length):""};String.prototype.rightRightOf=function(a){var b=this.lastIndexOf(a);return-1<b?this.substr(b+a.length):""};String.prototype.isEmpty=function(){return""==this.trim()};
String.prototype.startsWith=function(a){return 2==arguments.length&&!0===caseInsensistive?0==this.toLowerCase().indexOf(a):0==this.indexOf(a)};String.prototype.endsWith=function(a,b){var c=2==arguments.length&&!0===b?this.toLowerCase().lastIndexOf(a.toLowerCase()):this.lastIndexOf(a);return 0<=c&&c==this.length-a.length};
String.prototype.stripAccents=function(){var a=/[\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd]/g;return this.replace(a,function(b){return"aaaaaceeeeiiiinooooouuuuyyAAAAACEEEEIIIINOOOOOUUUUY".substr(a.source.indexOf(b)-1,1)})};
String.prototype.hashCode=function(){var a=0,b,c;if(0==this.length)return a;for(b=0;b<this.length;b++)c=this.charCodeAt(b),a=(a<<5)-a+c,a&=a;return a};String.prototype.removeEnd=function(a,b){1==arguments.length&&(b=!1);return this.endsWith(a,b)?this.substring(0,this.length-a.length):this.toString()};String.prototype.occurences=function(a){for(var b=[],c=this,d=c.indexOf(a,0),e=0;-1!=d;)b.push(e+d),c=c.substring(d+a.length,c.length),e+=d+1,d=c.indexOf(a,0);return b};
Array.prototype.remove=function(a){for(i=0;i<this.length;i++)if(a==this[i]){this.splice(i,1);break}};Array.prototype.pushArray=function(a){for(var b=0;b<a.length;b++)this.push(a[b])};function callLater(a,b){var c=Array.prototype.slice.call(arguments).slice(2);return setTimeout(function(){return a.apply(null,c)},b)}function RGB2Color(a,b,c){return"#"+byte2Hex(a)+byte2Hex(b)+byte2Hex(c)}function byte2Hex(a){return String("0123456789ABCDEF".substr(a>>4&15,1))+"0123456789ABCDEF".substr(a&15,1)}
clone=function(a){return jQuery.extend(!0,{},a)};
$.fn.load=function(a){var b=$(this),c=null,d=b.attr("data-compo");if(null==d)logger.warn("This element is not a panjs component");else if("true"!=b.attr("data-loaded")){c=b.attr("data-original-id");b.attr("id");0==arguments.length&&(a={});if("undefined"!=typeof b.data("args")){var e=b.data("args"),f;for(f in a)e[f]=a[f];a=e}f=null;b[0].owner?f=b[0].owner:a.owner&&(f=a.owner);a.elem=b[0];a.owner=f;e=panjs.createComponent(d,a,!1);e.container[0].compo=e;e.container[0].loaded=!0;e.container.attr("data-loaded",
"true");e.container.attr("data-original-id",c);f?f._onSubComponentLoaded(e,b,a):(logger.debug("owner not set: dataCompo="+d+" originalId="+c),panjs.capture("$.fn.load: createComponent without owner",{componentId:e.id,classPath:e.classPath,from:null}));b.trigger(Tevent.LOADED,[e,a]);b.replaceWith(e.container);e._triggerOnAdded();b.remove();c=e}else c=b[0].compo;return c};$.fn.isLoaded=function(){return"true"==$(this).attr("data-loaded")};$.fn.isCompo=function(){return null!=$(this).attr("data-compo")};
$.fn.getCompo=function(){var a=null;$(this)[0].compo&&(a=$(this)[0].compo);return a};$.fn.getElement=function(a){a=$(this).find(a);return 0==a.length?null:$(a[0])};$.fn.getElements=function(a){logger.warn("PANJS: $.fn.getElements is deprecated");a=$(a,this);var b=$([]);if(1==a.length)b.push(a);else for(var c=0;c<a.length;c++)b.push($(a[c]));return b};$.fn.swapWith=function(a){return this.each(function(){var b=$(a).clone(!0),c=$(this).clone(!0);$(a).replaceWith(c);$(this).replaceWith(b)})};
function isNumberKey(a){var b=a.which;a=a.shiftKey;return 96<=b&&105>=b||48<=b&&57>=b&&!0==a}function isControlKey(a){var b=a.which;return 8==b||13==b||46==b||35==b||36==b||37==b||39==b||9==b||a.ctrlKey&&67||a.ctrlKey&&86||a.ctrlKey&&88}var defaultSettings={appVersion:"1.0.0",logLevel:"DEBUG",env:"dev",version:"1.0.0",addIdClass:!1,preserveElementsId:!1,setSourceInComponents:!1,stats:{active:!1,url:"http://www.nexilearn.com/apis/portail_panjs/captures"},cache:{useLocalStorage:!1},errorComponentClass:"panjs.core.display.TerrorElement.html"};
panjs=array_replace_recursive(defaultSettings,panjs);
(function(a){a._iever=getIEVersion();9>a._iever&&0<a._iever&&alert("Internet Explorer "+a._iever+" is not supported");if(!a.appName)throw"Config ERROR: panjs.appName is missing";if(!RegExp("^[0-9a-zA-Z-_]*$","g").exec(a.appName))throw"invalid appName. format: "+regAppName;a._sourceUrl="//# sourceURL=";var b=getFirefoxVersion();0<b&&17>=b&&(a._sourceUrl="//@ sourceURL=");var c=[],d=0,e={};a.logger=null;a._classes={};a.root={id:"root",components:{}};a.loader=null;a.basePath=location.pathname.removeEnd(location.pathname.rightRightOf("/"));
a.basePath=a.basePath.removeEnd("/");a.fullBasePath=location.protocol+"//"+location.host+location.pathname;a.messages={CLASSNAME_MATCHS_FILENAME:"The name of the class (%1) must match the file name (%2) (case sensitive)",LESS_IE8:"less is not fully compatible with IE%1 : transform less code in css",LESS_NOT_LOADED:"LESS not loaded. Use panjs_core_with_less.min.js or load LESS (before panJs)",SCRIPT_ALREADY_LOADED:"loadScriptSync %1 : already loaded",LESS_INJECTED:"LESS: injection OK"};for(var f in a.namespaces)a.namespaces[f].path=
a.namespaces[f].path.replace("{version}",a.version),a.namespaces[f].name=f;window.less="undefined"!=typeof a.less?a.less:{env:"production",async:!0,fileAsync:!1,poll:1E3};var g={},h=null,l=!1,m=function(){if(!1!=this.stats.active&&l){var b=a.stats.url,c=a.stats.username,d=a.stats.password,e=[],f;for(f in g)e.pushArray(g[f]),logger.debug("Sending "+g[f].length+" ["+f+"] stats");var h=e.length;0<h&&($.ajax({url:b,async:!0,type:"post",data:JSON.stringify(e),username:c,password:d,success:function(a,b,
c){logger.debug("Send "+h+" stats: success")},error:function(a,b,c){logger.error("Send "+h+" stats: failure: "+a.responseText)}}),g={})}};a.stopCaptures=function(){null!=h&&h.stop();g={};l=!1;logger.error("captures stopped")};a.startCaptures=function(){!1!=this.stats.active&&(null==h&&(uses("panjs.core.helpers.Ttimer"),h=new Ttimer({delay:5E3,onTimer:m.bind(this)})),h.start(),l=!0)};a.razCaptures=function(){if(!1!=this.stats.active){g={};var b=a.stats.username,c=a.stats.password;$.ajax({url:a.stats.url+
"/init",async:!0,type:"post",async:!1,data:JSON.stringify({appName:a.appName}),username:b,password:c,success:function(a,b,c){logger.debug("razCaptures: success")},error:function(a,b,c){logger.error("razCaptures: failure: "+a.responseText)}})}};a.capture=function(b,c){if(!1!=this.stats.active&&l){var d={message:b,classPath:c.classPath,componentId:null,fromClassName:null,fromClassPath:null,appName:a.appName,groupId:1,fromId:null,isStatic:null,timestamp:(new Date).getTime()};null!=c.from&&(d.fromClassName=
c.from.className,d.fromClassPath=c.from.classPath,null!=c.from.id&&(d.fromId=c.from.id));null!=c.componentId&&(d.componentId=c.componentId);"createStaticObject"==d.message&&(d.isStatic=!0);"createComponent"==d.message&&(d.isStatic=!1);"undefined"==typeof g[b]&&(g[b]=[]);g[b].push(d)}};a._exec=function(a){""!=a&&("undefined"!=typeof window.execScript?window.execScript(a):window.eval(a))};a.addNamespace=function(b,c){a.namespaces[b]={path:c,name:b}};a._setDOMId=function(b,c,d){c&&(d=b.getAttribute("data-preserve-id"),
d=null==d?a.preserveElementsId:"true"==d,d||(d=b.nodeName.toLowerCase(),"undefined"==typeof e[d]?e[d]=1:e[d]++,b.setAttribute("id",d+e[d]),b.setAttribute("data-original-id",c)),a.addIdClass&&(b.className+=" "+c))};a.getClass=function(b){"undefined"==typeof a._classes[b]&&uses(b);return a._classes[b].Class};a.getInstance=function(b,c){return new (a.getClass(b))(c)};a.createObject=a.getInstance;a.unload=function(b){"undefined"==typeof a._classes[b]&&(b+=".html");"undefined"!=typeof a._classes[b]&&(a._classes[b]=
void 0,delete a._classes[b])};a.createComponent=function(b,e,f){d++;var g=a._getClassNameFromClassPath(b),h=null;if("undefined"==typeof a._classes[b]&&(h=a.loader.usesComponent(b),null==h||!h.result))return e=h,"string"==typeof e&&(e={message:e,className:g}),e.stack=c,uses(a.errorComponentClass),object=new TerrorElement(e),c.push(e.message),d--,0>=d&&(c=[],d=0),object;"undefined"==typeof e&&(e={});if("undefined"!=typeof e.elem&&(g=e.elem,h=e,"undefined"!=typeof g))for(var l=0;l<g.attributes.length;l++){var m=
g.attributes.item(l),r=m.nodeName.toLowerCase(),m=m.value;r.startsWith("data-")&&(r=r.rightOf("data-"),r=a.getCamelCase(r));"true"==m?m=!0:"false"==m&&(m=!1);h[r]=m}if("undefined"!=typeof a.root.components[b]&&"undefined"!=e.reuse&&!0===e.reuse)return f=a.root.components[b],f.reuse(e),f;h=new a._classes[b].Class(e);d--;0>=d&&(c=[],d=0);h._onInitialized&&h._onInitialized();a.root.components[b]=h;!1!==f&&(e={classPath:b,componentId:h.id,classPath:b,from:null},"object"==typeof f&&"undefined"!=typeof e.from&&
(e.from=f.from),a.capture("createComponent",e));return h};a.getCamelCase=function(a){if(-1==a.indexOf("-"))return a;var b="";a=a.split("-");for(var c=0;c<a.length;c++)b=0==c?a[c]:b+a[c].capitalizeFirstLetter();return b};a.loadScriptAsync=function(a,b){$LAB.script(a).wait(function(){"undefined"!=typeof b&&b(a)})};a.loadScriptSync=function(b){var c={result:null,errorMessage:""};if(this.loader.loadedJs[b.toLowerCase()])c.result=!0,logger.debug(a.messages.SCRIPT_ALREADY_LOADED,b);else{var d=this.loader._loadFileSync(this.loader._getUrlWithVersion(b));
c.result=d.result;!0!=c.result?c.errorMessage=d.exception:(d.data+="\n"+a._sourceUrl+b+".js",a._exec(d.data),this.loader.loadedJs[b.toLowerCase()]=1)}return c};a.load=function(b,c){0==arguments.length&&(b=$(document.body));var d=[];null!=b.attr("data-compo")?d.push(b):d=b.find("[data-compo]");for(var e=0;e<d.length;e++){var f=$(d[e]),g=f.attr("data-compo"),h="false"!==f.attr("data-autoload"),l=f.attr("id");!0==h?f=f.load():(a._setDOMId(f[0],l,g),f[0].compo=null,f[0].owner=null);a.root[l]=f}2==arguments.length&&
c()};a._getClassNameFromClassPath=function(a){var b=".";if(a.startsWith("http://")||a.startsWith("file://")||a.startsWith("https://")||"/"==a[0])b="/";var c=a;a.endsWith(".html")&&(c=a.removeEnd(".html"));a=c.split(b);return c=a[a.length-1]};a.getNSFromClassPath=function(b){var c=null,d;for(d in a.namespaces)if(b.startsWith(d+".")){c=a.namespaces[d];break}return c};a.getAbsoluteUrlFromClassPath=function(b){var c=b.endsWith(".html"),d="";if(b.startsWith("http://")||b.startsWith("file://")||"/"==b[0])d=
c?b:b+".js";else if(b.removeEnd(".html").contains(".")){var e=a.getNSFromClassPath(b);e&&(d=e.path+"/"+b.rightOf(e.name+".").removeEnd(".html").replace(/\./g,"/"),d=c?d+".html":d+".js")}else d=a.basePath+"/"+b,c||(d+=".js");""==d&&(d=b.removeEnd(".html").replace(/\./g,"/"),d=c?d+".html":d+".js");return d}})(panjs=panjs||{});
var Tobject={classHierarchy:"Tobject",extend:function(a,b,c){var d=this.prototype||Tobject,e={};e.classHierarchy={value:d.classHierarchy+" "+b};for(var f in a)if("isLoaded"==f&&"TdisplayObject"!=b&&logger.warn("Error extending "+d.classHierarchy+" "+b+": 'isLoaded' property is reserved by panjs"),f.startsWith("$")){var g=a[f];f=f.rightOf("$");e["__"+f]={value:g,writable:!0,enumerable:!0};var g=new Function('var key = "__'+f+'", propName="'+f+'",oldValue=this[key];newValue=arguments[0]; if (this[key] != arguments[0]){this[key] = arguments[0]; this.__OnPropChanged(propName, oldValue, newValue, this);}'),
h=new Function('var key = "__'+f+'"; return this[key]');e[f]={get:h,set:g}}else e[f]={value:a[f],writable:!0,configurable:!0,enumerable:!0};a=Object.create(d,e);b=a.constructor;if(!(b instanceof Function))throw Error("You must define a method 'constructor'");b.prototype=a;b.prototype.parentClassName=c;b._super=d;b.extend=this.extend;return b},__OnPropChanged:function(a,b,c,d){},injectParam:function(a,b,c,d){if("undefined"==typeof b||null==b){if("undefined"!=typeof d)return this[a]=d,!0;if("undefined"!=
typeof c&&!0==c)throw"The "+a+" argument has no default value on "+this.className;return!1}this[a]=b;return!0}};function defineStaticClass(a,b,c){defineClass(a,b,c,!0)}
function defineClass(a,b,c,d){4>arguments.length&&(d=!1);var e=b.endsWith(".html"),f=panjs._getClassNameFromClassPath(b),g=null,g="undefined"!=typeof __CLASSPATH__&&null!=__CLASSPATH__?__CLASSPATH__:a,h=g.removeEnd(".html");h.contains(".")&&(h=h.rightRightOf("."));if(g!=a&&h!=a)throw logger.parse(panjs.messages.CLASSNAME_MATCHS_FILENAME,a,h);if("undefined"==typeof panjs._classes[b]&&"Tloader"!=f&&"Tlogger"!=f&&"Tobject"!=f&&(e?panjs.loader.usesComponent(b):panjs.loader.uses(b),"undefined"==typeof panjs._classes[b]))return logger&&
logger.error("Unable to inherit from "+b+": class is not loaded"),null;f=panjs._classes[b]?panjs._classes[b].Class.extend(c,a,f):window[f].extend(c,a,f);panjs._classes[g]={Class:f,isComponent:e,lastId:0};f.prototype.classPath=g;f.prototype.className=a;d?(window[a]=new f,window[a].id=g):window[a]=f;e=g.split(".");f=window;for(h=0;h<e.length;h++){var l=e[h];h==e.length-1?f[l]=window[a]:"undefined"==typeof f[l]&&(f[l]={});f=f[l]}__CLASSPATH__=null;panjs._lastDefinedClassName=a;d&&(g={classPath:g,componentId:window[a].id,
from:null},"object"==typeof sendData&&"undefined"!=typeof g.from&&(g.from=sendData.from),panjs.capture("createStaticObject",g))}function uses(a){return a.endsWith(".html")?panjs.loader.usesComponent(a):panjs.loader.uses(a)}
defineClass("Tlogger","panjs.core.Tobject",{_level:null,name:"MAIN",creationDate:null,_currentGroup:0,_tabulation:"",tab:[],constructor:function(a){this.injectParam("_level",a.level,!1,Tlogger.INFO);this.injectParam("name",a.name,!1);this.creationDate=(new Date).getTime();this.setLevel(this._level);this.razTime();this.info("Init logger LEVEL=%1",this.getLevelName())},razTime:function(){this.creationDate=new Date},isLevelEnabled:function(a){return a>=this._level},getLevelName:function(){if(this._level==
Tlogger.TRACE)return"TRACE";if(this._level==Tlogger.DEBUG)return"DEBUG";if(this._level==Tlogger.INFO)return"INFO";if(this._level==Tlogger.WARN)return"WARN";if(this._level==Tlogger.ERROR)return"ERROR"},groupStart:function(){this._currentGroup++;this._calcTabultation()},groupEnd:function(){this._currentGroup--;this._calcTabultation()},_calcTabultation:function(){this._tabulation="";for(var a=0;a<this._currentGroup;a++)this._tabulation+="\t"},_getTime:function(){return(new Date).getTime()-this.creationDate},
_trace:function(){console.trace(this._getMessage("TRACE",arguments))},_debug:function(){console.debug(this._getMessage("DEBUG",arguments))},_info:function(){console.info(this._getMessage("INFO",arguments))},_warn:function(){console.warn(this._getMessage("WARN",arguments))},_error:function(){console.error(this._getMessage("ERROR",arguments))},_fallback:function(){if("undefined"!=typeof console){var a=this.logger._getMessage(this.levelStr,arguments);console.log(a)}},parse:function(){if("string"==typeof arguments[0])for(var a=
arguments[0],b=1;b<arguments.length;b++){var c=arguments[b];null==c&&(c="null");a=a.replace("%"+b,c)}else for(a="",b=0;b<arguments.length;b++)a+=JSON.stringify(arguments[b])+"\n";return a},_getMessage:function(a,b){var c=this.parse.apply(this,b);return this._getTime()+"ms("+this._currentGroup+") - "+a+"\t"+this._tabulation+c},setLevel:function(){return this._level},setLevel:function(a){this._level=a;"undefined"!=typeof console?(this.trace="undefined"==typeof console.trace?this._fallback.bind({levelStr:"TRACE",
logger:this}):this._trace,this.debug="undefined"==typeof console.debug?this._fallback.bind({levelStr:"DEBUG",logger:this}):this._debug,this.info="undefined"==typeof console.info?this._fallback.bind({levelStr:"INFO",logger:this}):this._info,this.warn="undefined"==typeof console.warn?this._fallback.bind({levelStr:"WARN",logger:this}):this._warn,this.error="undefined"==typeof console.error?this._fallback.bind({levelStr:"ERROR",logger:this}):this._error):(this.trace=this._fallback.bind({levelStr:"TRACE",
logger:this}),this.debug=this._fallback.bind({levelStr:"DEBUG",logger:this}),this.info=this._fallback.bind({levelStr:"INFO",logger:this}),this.warn=this._fallback.bind({levelStr:"WARN",logger:this}),this.error=this._fallback.bind({levelStr:"ERROR",logger:this}));a>=Tlogger.DEBUG&&(this.trace=function(){});a>=Tlogger.INFO&&(this.debug=function(){});a>=Tlogger.WARN&&(this.info=function(){});a>=Tlogger.ERROR&&(this.warn=function(){})}});Tlogger.TRACE=10;Tlogger.DEBUG=20;Tlogger.INFO=30;
Tlogger.WARN=40;Tlogger.ERROR=50;panjs.logger=new Tlogger({level:Tlogger[panjs.logLevel],name:"main"});logger=panjs.logger;Ttracer=function(){};Ttracer.getLogger=function(a){return logger};
defineClass("Tloader","panjs.core.Tobject",{queue:[],loadedJs:null,loadedCss:null,_lessIsLoaded:null,randomId:"",_addedcss:"",_stylenode:null,constructor:function(a){this.loadedJs={};this.loadedCss={};this.randomId=Math.random()},init:function(){if(!panjs.cache.useLocalStorage){panjs.cache={};var a="cache_"+panjs.appName,b;for(b in localStorage)b.startsWith(a)&&localStorage.removeItem(b)}},lessIsLoaded:function(){null==this._lessIsLoaded&&(this._lessIsLoaded=defined(window.less,"refresh"));return this._lessIsLoaded},
getClassPathDir:function(a){var b=a;a.endsWith(".js")?b=a.removeEnd(".js"):a.endsWith(".html")&&(b=a.removeEnd(".html"));return b=b.substr(0,b.lastIndexOf("."))},_getUrlWithVersion:function(a){a=!1==a.contains("?")?a+"?":a+"&";a+="v="+panjs.appVersion;"dev"==panjs.env&&(a=a+"&rid="+this.randomId);return a},_loadFileSync:function(a){var b=panjs.cache.useLocalStorage&&"prod"==panjs.env&&panjs.appName;if(b){var c="cache_"+panjs.appName,d=c+"."+panjs.appVersion+"."+a.hashCode(),e=localStorage.getItem(d);
if(e)return{result:!0,data:e}}try{var f={result:!1,exception:"",status:"erreur inconnue"};logger.debug("Loadfile SYNC %1",a);jQuery.support.cors=!0;var g=jQuery.ajax({url:a,method:"GET",cache:!0,async:!1,dataType:"html",processData:!1,context:this,beforeSend:function(a){},success:function(e,g,h){f={result:!0,data:e};if(b){for(var p in localStorage)p.startsWith(c)&&!p.startsWith(c+"."+panjs.appVersion)&&(logger.debug("Removing old version from locaStorage: %1",p),localStorage.removeItem(p));try{localStorage.setItem(d,
e)}catch(q){logger.debug(q+": data from "+a+" will not be saved")}}},error:function(b,c,d){logger.error("Load error. url=%1, exception=%2",a,d);f={result:!1,jqXHR:g,exception:d};f.status=g&&g.status?g.status:d}})}catch(h){f={result:!1,exception:h,status:h}}return f},getFileSync:function(a){return this._loadFileSync(a)},usesComponent:function(a){var b=panjs._getClassNameFromClassPath(a),c={result:!1,message:"",className:b,classPath:a,url:null,path:null,Class:null};if("undefined"==typeof panjs._classes[a]){logger.debug("USESCOMPONENT %1",
a);logger.groupStart();c.path=panjs.getAbsoluteUrlFromClassPath(a);c.url=this._getUrlWithVersion(c.path);var d=this._loadFileSync(c.url);if(d.result){try{var e=getXmlDocument(d.data)}catch(f){return logger.error("XML error in class "+b+": "+f),c.isXmlError=!0,c.message=f,c}for(var g=e.getElementsByTagName("head")[0],e=e.getElementsByTagName("body")[0],h=[],l=[],m=c.path.substring(0,c.path.lastIndexOf("/")),n=0;n<g.childNodes.length;n++){var p=g.childNodes[n],q=p.nodeName.toLowerCase();"script"==q?
this.addScriptNode(p,m,b,a):"link"==q?h.push(p):"style"==q&&l.push(p)}if("undefined"==typeof panjs._classes[a])return c.message="Classe "+a+" not loaded",c;b=panjs._classes[a].Class;for(n=0;n<h.length;n++)this.addLinkNode(h[n],m);for(n=0;n<l.length;n++)logger.debug("Load style %1",a),this.addStyleNode(l[n]);g=b.prototype.parentClassName;defined(e)?(h=getXml(e),defined(window[g].prototype.html)&&window[g].prototype.html.contains("\x3c!--CONTENT--\x3e")&&(h=window[g].prototype.html.replace("\x3c!--CONTENT--\x3e",
h)),h=h.replace(/<body>/gi,"").replace(/<\/body>/gi,""),b.prototype.html=h,b.prototype.bodyNode=e):defined(window[g].prototype.html)&&(h=window[g].prototype.html,b.prototype.html=h,b.prototype.bodyNode=e);panjs.setSourceInComponents&&(b.prototype.source=d.data);b.prototype.classPathDir=this.getClassPathDir(a);b.prototype.dirPath=m;b.lastId=0;logger.groupEnd();logger.debug("END USESCOMPONENT %1",a);c.result=!0;c.message="ok";c.Class=b}else a="Error loading "+a+": "+d.status,logger.warn(a),c.mess=a}else c.result=
!0,c.mess="Already loaded",c.Class=panjs._classes[a].Class;return c},uses:function(a){var b=panjs._getClassNameFromClassPath(a),c={result:!1,message:"",className:b,classPath:a,url:null,path:null,Class:null};if("undefined"==typeof panjs._classes[a]){logger.debug("USES %1",a);logger.groupStart();c.path=panjs.getAbsoluteUrlFromClassPath(a);var d=c.path.substring(0,c.path.lastIndexOf("/"));c.url=this._getUrlWithVersion(c.path);var e=this._loadFileSync(c.url);if(e.result){e.data=this._processCode(e.data,
b,d,a,".js");panjs._exec(e.data);if("undefined"==typeof panjs._classes[a])return c.message="Classe "+a+" not loaded",c;e=panjs._classes[a].Class;e.prototype.classPathDir=this.getClassPathDir(a);e.prototype.dirPath=d;panjs._classes[a].lastId=0;c.result=!0;c.message="ok";c.Class=e}else throw a+" not loaded: "+e.status;logger.groupEnd();logger.debug("END USES %1",a)}else c.result=!0,c.message="Already loaded",c.Class=e;return c},_transformUrl:function(a,b){"/"!=a[0]&&"http://"!=a.substring(0,7)&&"file://"!=
a.substring(0,7)&&"https://"!=a.substring(0,8)&&(a=b+"/"+a);return a},addLinkNode:function(a,b){var c=this._transformUrl(a.getAttribute("href"),b),d=a.getAttribute("type")||"text/css",e=a.getAttribute("rel")||"stylesheet";this.loadCssFile(c,d,e)},loadCssFile:function(a,b,c){if(0==arguments.length)throw"loadCssFile(url, type , rel): Missing url";var d=!1;a=this._getUrlWithVersion(a);if(this.loadedCss[a.toLowerCase()])return d;2>arguments.length&&(b="text/css");3>arguments.length&&(c="stylesheet");
var e=document.createElement("link");e.rel=c;e.type=b;e.href=a;"stylesheet/less"==c?this.lessIsLoaded()?(less.sheets.push(e),less.refresh(!0),logger.debug(panjs.messages.LESS_INJECTED),d=!0):logger.warn(panjs.messages.LESS_NOT_LOADED):(document.getElementsByTagName("head")[0].appendChild(e),d=!0);!0==d&&logger.debug("Load <link> ASYNC: %1",a);this.loadedCss[a.toLowerCase()]=!0;return d},addStyle:function(a,b){0<panjs._iever?this.addStyleIE(a,b):""!=a.trim()&&(2>arguments.length&&(b="text/css"),$('<style type="'+
b+'">'+a+"</style>").appendTo("head"),"text/less"==b&&(this.lessIsLoaded()?(less.refresh(),logger.debug(panjs.messages.LESS_INJECTED)):logger.warn(panjs.messages.LESS_NOT_LOADED)))},addStyleIE:function(a,b){if(""!=a.trim())if(2>arguments.length&&(b="text/css"),"text/less"==b){var c=$('<style type="'+b+'">'+a+"</style>");c.appendTo("head");this.lessIsLoaded()?(less.refresh(),logger.debug(panjs.messages.LESS_INJECTED)):logger.warn(panjs.messages.LESS_NOT_LOADED)}else null==this._stylenode?(c=$('<style type="'+
b+'">'+a+"</style>"),c.appendTo("head"),this._stylenode=c[0]):(this._addedcss+="\n"+a,this._stylenode.innerHTML=this._addedcss,$(this._stylenode).appendTo("head"))},addStyleNode:function(a){var b=a.getAttribute("type");null==b&&(b="text/css");this.addStyle(a.textContent,b)},_processCode:function(a,b,c,d,e){a=a.replace("defineClass(","var __CLASSPATH__='"+d+"';defineClass(").replace(/this._super/g,'panjs._classes["'+d+'"].Class._super')+"\n"+panjs._sourceUrl+c+"/"+b+e;return a=a.replace("defineStaticClass(",
"var __CLASSPATH__='"+d+"';defineStaticClass(")},addScriptNode:function(a,b,c,d){var e=a.getAttribute("data-subtype"),f=a.getAttribute("src");if(null==f)f=a.textContent,null!=c&&"text/x-class-definition"==e&&(f=this._processCode(f,c,b,d,".html")),panjs._exec(f);else if(a=this._transformUrl(f,b),this.loadedJs[a.toLowerCase()])logger.debug(panjs.messages.SCRIPT_ALREADY_LOADED,a);else{var g=this._loadFileSync(this._getUrlWithVersion(a));g.data=null!=c&&"text/x-class-definition"==e?this._processCode(g.data,
c,b,d,".js"):g.data+("\n"+panjs._sourceUrl+f+".js");panjs._exec(g.data);this.loadedJs[a.toLowerCase()]=1}return!0}});panjs.loader=new Tloader;panjs.loader.init();panjs.stats.active&&panjs.startCaptures();logger.info("READY. Panjs version: "+panjs.version);__CLASSPATH__="panjs.core.events.Tevent";
defineClass("Tevent","panjs.core.Tobject",{type:null,data:null,relatedData:null,bubbles:!1,cancelable:!1,currentTarget:null,cancelled:!1,defaultPrevented:!1,constructor:function(a,b,c,d){this.injectParam("type",a,!0);this.injectParam("data",b);this.injectParam("bubbles",c);this.injectParam("cancelable",d)},preventDefault:function(){this.defaultPrevented=!0}});Tevent.CLICK="click";Tevent.CHANGE="change";Tevent.SUCCESS="success";Tevent.ERROR="error";Tevent.DELETE="delete";Tevent.UPDATE="update";
Tevent.ADDED="added";Tevent.LOADED="loaded";Tevent.BEFORE_LOAD="before_load";Tevent.DATA_LOADED="data-loaded";Tevent.REFRESH="refresh";Tevent.REPLACE="replace";Tevent.ITEM_CLICKED="item-clicked";Tevent.ITEM_MOVED="item-moved";Tevent.OPEN="open";Tevent.CLOSE="close";Tevent.READY="ready";Tevent.BEFORE_STATE_CHANGE="before_state_change";Tevent.STATE_CHANGED="state_changed";Tevent.KEYDOWN="keydown";Tevent.SHOW="show";Tevent.SHOWN="shown";Tevent.HIDE="hide";Tevent.HIDDEN="hidden";Tevent.WAITING="waiting";
Tevent.BEFORE_DESTROY="BEFORE_DESTROY";Tevent.DESTROY="DESTROY";uses("panjs.core.events.Tevent");__CLASSPATH__="panjs.core.events.TeventDispatcher";
defineClass("TeventDispatcher","panjs.core.Tobject",{_listeners:null,constructor:function(a){this._listeners={}},free:function(){logger.trace("FREE className=%1 id=%2",this.className,this.id);this.removeAllListeners()},_getListenerIndex:function(a,b){if(!this.hasEventListener(a))return-1;for(var c=0;c<this._listeners[a].length;c++)if(null!=this._listeners[a][c]&&this._listeners[a][c].listener==b)return c;return-1},dispatchEvent:function(a,b,c,d){var e=null,f=null;"object"==typeof a?(f=a,e=a.type):
e=a;if(this.hasEventListener(e))for(null==f&&(f=new Tevent(e,b,c,d)),a=this._listeners[f.type],b=0;b<a.length&&(null==a[b]||(c=a[b],null==f.currentTarget&&(f.currentTarget=this),f.bind=c.bind,f.relatedData=c.data,null==f.bind?c.listener.call(this,f):c.listener.call(f.bind,f),!f.cancelled));b++);},on:function(a,b,c,d){4>arguments.length&&(d=null);3>arguments.length&&(c=null);var e={listener:b,data:d,bind:c};this.hasEventListener(a)||(this._listeners[a]=[]);for(var f=0;f<this._listeners[a].length;f++)if(null==
this._listeners[a][f]){this._listeners[a][f]=e;return}this._listeners[a].push(e)},offByCtx:function(a){for(type in this._listeners)for(var b=this._listeners[type],c=0;c<b.length;c++)null!=b[c]&&b[c].bind==a&&(b[c]=null)},off:function(a,b){var c=this._getListenerIndex(a,b);0<=c&&(this._listeners[a][c]=null)},removeAllListeners:function(){for(type in this._listeners)this._listeners[type].length=0,this._listeners[type]=null,delete this._listeners[type]},hasEventListener:function(a){return"undefined"!=
typeof this._listeners[a]}});__CLASSPATH__="panjs.core.managers.Trouter";
defineClass("Trouter","panjs.core.events.TeventDispatcher",{hash:"",sendEvents:!0,keys:{},listeners:{},base64encode:!1,constructor:function(a){Trouter._super.constructor.call(this,a);this.base64encode&&uses("panjs.helpers.EncodeTools");"onhashchange"in window?window.onhashchange=this.onhashchange.bind(this):logger.error("Trouter.constructor: Event window.hashchanging not supported!")},refreshkeys:function(){var a=window.location.hash.rightOf("#");this.keys=this.decode(a)},registerComponent:function(a,
b){this.refreshkeys();"undefined"==typeof this.listeners[a.hashKey]&&(this.listeners[a.hashKey]=[]);this.listeners[a.hashKey].push({owner:a,onhashchange:b.bind(a)})},getHash:function(a){return this.keys[a.hashKey]||null},setHash:function(a,b,c){if(this.keys[a.hashKey]!=b){var d=this.keys[a.hashKey];this.keys[a.hashKey]=b||null;var e=this.encode(this.keys);this.sendEvents=!1;window.location.hash=e;c||this._dispatchOnhashchange(a.hashKey,b,d);this.sendEvents=!0}else logger.debug("Trouter.setHash: "+
b+" => inchang\u00e9 sur "+a.id)},_dispatchOnhashchange:function(a,b,c){"undefined"==typeof b&&(b=null);if(null!=a&&this.listeners[a])for(var d=0;d<this.listeners[a].length;d++)this.listeners[a][d].onhashchange(b,c)},decode:function(a){var b={};if(""!=a)try{this.base64encode&&(a=EncodeTools.base64decode(a));a=a.split("&");for(var c=0;c<a.length;c++)if(""!=a[c].trim()){var d=a[c].split("=");k=d[0];v=d[1];b[k]=v}}catch(e){logger.error("Trouter.decode: Echec decodage de "+a+" en objet: "+e)}return b},
encode:function(a){var b="";try{for(k in a)"string"==typeof a[k]&&(b=b+k+"="+a[k]+"&");this.base64encode&&(b=EncodeTools.base64encode(b))}catch(c){logger.error("Trouter.encode: Echec encodage de "+a+" en string: "+c),logger.debug("Trouter.encode: obj = "+JSON.encode(a))}return b},onhashchange:function(a){if(!this.sendEvents)return!1;this.hash=window.location.hash.rightOf("#");this.keysTmp=this.decode(this.hash);for(k in this.keysTmp)"undefined"==typeof this.keys[k]||null==this.keys[k]?(a=null,this.keys[k]=
this.keysTmp[k],logger.debug("Trouter.onhashchange: [1] Le composant "+k+" va \u00eatre notifi\u00e9 que son hash a chang\u00e9: hash="+this.keys[k]+", oldhash="+a),this._dispatchOnhashchange(k,this.keys[k],a)):this.keysTmp[k]!=this.keys[k]&&(a=this.keys[k],this.keys[k]=this.keysTmp[k],logger.debug("Trouter.onhashchange: [2] Le composant "+k+" va \u00eatre notifi\u00e9 que son hash a chang\u00e9: hash="+this.keys[k]+", oldhash="+a),this._dispatchOnhashchange(k,this.keys[k],a));for(k in this.keys)found=
!0,"undefined"==typeof this.keysTmp[k]&&(this.keys[k]=null,logger.debug("Trouter.onhashchange: [3] Le composant "+k+" va \u00eatre notifi\u00e9 que son hash a chang\u00e9: hash="+this.keys[k]),"undefined"!=typeof this.listeners[k]&&this._dispatchOnhashchange(k,this.keys[k],null));a=new Tevent(Trouter.HASH_CHANGE,this.keys);this.dispatchEvent(a);return!1}});Trouter.HASH_CHANGE="HASH_CHANGE";panjs.router=new Trouter;__CLASSPATH__="panjs.core.collections.TarrayCollection";
defineClass("TarrayCollection","panjs.core.events.TeventDispatcher",{_source:null,length:0,key:null,_byId:null,filterFunction:null,_items:null,constructor:function(a){TarrayCollection._super.constructor.call(this,a);this._items=[];var b=[];a&&("undefined"!=typeof a.push?b=a:(a.key&&(this.key=a.key),a.data&&(b=a.data),a.filterFunction&&(this.filterFunction=a.filterFunction)));this._byId={};this.setSource(b)},sort:function(a){defined(a)&&this._items.sort(a)},getSource:function(){return this._items},
setSource:function(a,b){if("object"!=typeof a||"function"!=typeof a.push)logger.error("TarrayCollection.setSource: data must be a array !");else if(this._source!=a){this._source=a;this._items=null!=this.filterFunction?this._source.filter(this.filterFunction):this._source.slice(0);if(null!=this.key){this._byId={};for(var c=0;c<this._items.length;c++)this._byId[this._items[c][this.key]]=this._items[c]}this.length=this._items.length;this.refresh(b)}},find:function(a){var b=[];if(a.filterFunction)for(var c=
0;c<this._source.length;c++)a.filterFunction(this._source[c])&&b.push(this._source[c]);return b},swap:function(a,b){if(a!=b){var c=this.getItemIndex(a),d=this.getItemIndex(b);this._items[c]=b;this._items[d]=a}},moveAfter:function(a,b){if(a!=b){var c=this.getItemIndex(a),d=this.getItemIndex(b);c<d?this.moveItem(a,d):c>d&&this.moveItem(a,d+1)}},moveItem:function(a,b){var c=this.getItemIndex(a);if(c!=b){var d=this._items[c];this._items.splice(c,1);this._items.splice(b,0,d);this.dispatchEvent(new Tevent(Tevent.ITEM_MOVED,
{item:a,fromIndex:c,toIndex:b}));this.dispatchEvent(new Tevent(Tevent.CHANGE,{action:"ITEM_MOVED",item:a,fromIndex:c,toIndex:b}))}},getByKey:function(a){return this._byId[a]},getByProp:function(a,b,c,d){var e=null;if(null!=this.key&&a==this.key)"undefined"!=typeof this._byId[b]&&(e=this._byId[b]);else{"undefined"==typeof d&&(d=!1);d||"string"!=typeof b||(b=b.toLowerCase());3>arguments.length?c=!1:e=[];for(var f=0;f<this._items.length;f++){var g=this._items[f];if("undefined"!=typeof g[a]){var h=g[a];
d||"string"!=typeof g[a]||(h=g[a].toLowerCase());if(h==b)if(!0==c)e.push(g);else{e=g;break}}}}return e},getFilterFunction:function(){return this.filterFunction},setFilterFunction:function(a){this.filterFunction!=a&&(this.filterFunction=a)},dispatchUpdateEvent:function(a){this.dispatchEvent(new Tevent(Tevent.UPDATE,{item:a}));this.dispatchEvent(new Tevent(Tevent.CHANGE,{action:"UPDATE",item:a}))},refresh:function(a){null!=this.filterFunction&&(this._items=this._source.filter(this.filterFunction));
this.length=this._items.length;a||(this.dispatchEvent(new Tevent(Tevent.REFRESH,this)),this.dispatchEvent(new Tevent(Tevent.CHANGE,{action:"REFRESH"})))},getItems:function(){return this._items},_getItemIndex:function(a,b){for(var c=0;c<b.length;c++)if(b[c]==a)return c;return-1},getItemIndex:function(a){return this._getItemIndex(a,this._items)},getItemAt:function(a){return this._items[a]},contains:function(a){return 0<=this.getItemIndex(a)},_replaceItem:function(a,b,c,d){this._items[a]=c;null!=this.key&&
(this._byId[b[this.key]]=c,this.dispatchEvent(new Tevent(Tevent.UPDATE,b)));this.length=this._items.length;d||(this.dispatchEvent(new Tevent(Tevent.REPLACE,{item:b,newItem:c})),this.dispatchEvent(new Tevent(Tevent.CHANGE,{action:"REPLACE",item:b,newItem:c})))},replaceItem:function(a,b,c){if(a!=b){var d=this._getItemIndex(a,this._source);-1<d&&(this._source[d]=b);d=this.getItemIndex(a);-1<d&&(null==this.filterFunction?this._replaceItem(d,a,b,c):this.filterFunction(b)?this._replaceItem(d,a,b,c):this._removeItemAt(d,
b,c))}},_addItemAt:function(a,b,c){if(null!=this.key){if("undefined"!=typeof this._byId[b[this.key]])throw"Key already in collection: "+b[this.key];this._byId[b[this.key]]=b}this._items.splice(a,0,b);this.length=this._items.length;c||(this.dispatchEvent(new Tevent(Tevent.ADDED,{item:b,index:a})),this.dispatchEvent(new Tevent(Tevent.CHANGE,{action:"ADDED",item:b,index:a})))},addItem:function(a,b){this._source.push(a);(null==this.filterFunction||this.filterFunction(a))&&-1==this.getItemIndex(a)&&this._addItemAt(this.length,
a,b)},addItemsAt:function(a,b,c){if(b>this.length)this.addItems(a,c);else for(var d=b,e=0;e<a.length;e++)if(this._source.push(a[e]),null==this.filterFunction||this.filterFunction(a[e]))b=this.getItemIndex(a[e]),-1<b&&(d++,this._addItemAt(d,a[e],c))},addItems:function(a,b){this.addItemsAt(a,this.length,b)},addItemAt:function(a,b,c){b>this.length?this.addItem(a):(this._source.push(a),(null==this.filterFunction||this.filterFunction(a))&&this._addItemAt(b,a,c))},forEach:function(a){this._items.forEach(a)},
removeItems:function(a,b){if("function"==typeof a)for(var c=[],d=0;d<this._items.length;d++)a(this._items[d])&&c.push(this._items[d]);else c=a;for(d=0;d<c.length;d++)this.removeItem(c[d],b);return c},removeItem:function(a,b){if(null!=a){var c=this.getItemIndex(a);0<=c&&this._removeItemAt(c,a,b)}else c=-1;return c},removeItemAt:function(a,b){var c=this.getItemAt(a);null!=c&&this._removeItemAt(a,c,b)},removeAll:function(a){this._source=[];this._items=[];this._byId={};this.refresh(a)},_removeItemAt:function(a,
b,c){this._items.splice(a,1);a=this._getItemIndex(b,this._source);0<=a&&this._source.splice(a,1);this.length=this._items.length;null!=this.key&&delete this._byId[b[this.key]];c||(this.dispatchEvent(new Tevent(Tevent.DELETE,{item:b})),this.dispatchEvent(new Tevent(Tevent.CHANGE,{action:"DELETE",item:b})))}});__CLASSPATH__="panjs.core.display.TdisplayObject";
defineClass("TdisplayObject","panjs.core.events.TeventDispatcher",{container:null,id:null,owner:null,visible:!0,autoload:!0,baseElement:null,_realVisible:!1,args:null,load:function(){return this},isLoaded:function(){return!0},free:function(){TdisplayObject._super.free.call(this);this.container.remove();panjs.capture("free",{classPath:this.classPath,componentId:this.id})},_onInitialized:function(){},constructor:function(a){TdisplayObject._super.constructor.call(this,a);this.args=a;if(null==this.baseElement)throw'La propri\u00e9t\u00e9 "baseElement" n\'est pas d\u00e9fini sur '+
this.className;this.container=$("<"+this.baseElement+"/>");panjs._classes[this.classPath].lastId++;this.id=this.classPath+"_"+panjs._classes[this.classPath].lastId;this.container[0].owner=this;this.container[0].compo=this},addClass:function(a){this.container.addClass(a)},removeClass:function(a){this.container.removeClass(a)},createComponent:function(a,b,c){return panjs.createComponent(a,b,!1)},_triggerOnAdded:function(){this._onAdded&&($.contains(document.body,this.container[0])?this._onAdded():setTimeout(function(){$.contains(document.body,
this.container[0])&&this._onAdded()}.bind(this),50))},append:function(a){var b=a,c=this.container;a.isCompo()&&(b=a.container,null!=this.content&&(c=this.content));c.append(b);a._onAdded&&a._onAdded()},appendTo:function(a){a.append(this.container);a.isCompo()&&a[0].owner._children.push(this);this._triggerOnAdded()},prependTo:function(a){this.container.prependTo(a);a.isCompo()&&this._children.push(a[0].owner)},hide:function(a){defined(a,"hideFn")?a.hideFn(this.container):this.container.hide(a);this._realVisible=
this.visible=!1;"undefined"!=typeof this._onHide&&this._onHide()},show:function(a){this._realVisible||(defined(a,"showFn")?a.showFn(this.container):this.container.show(a),this._realVisible=this.visible=!0,"undefined"!=typeof this._onShow&&this._onShow())},toggle:function(a){this.container.toggle(a);this.visible=!this._visible}});__CLASSPATH__="panjs.core.display.TdisplayObjectContainer";
defineClass("TdisplayObjectContainer","panjs.core.display.TdisplayObject",{_statesElements:null,currentState:null,defaultState:null,_bindElements:null,__bindings:null,_children:null,constructor:function(a){this._bindElements=[];this.__bindings={html:[]};TdisplayObjectContainer._super.constructor.call(this,a);null==this._children&&(this._children=[]);this._children=[];this._statesElements=[];this.currentState=[];defined(this.html)&&""!=this.html.trim()&&(this.container.html(this.html),this._populateElements(this.container[0],
!0));0<this._statesElements.length&&this.setState([])},bindEvent:function(a,b,c,d){c.startsWith("{{")?(d=c.rightOf("{{").leftOf("}}"),d=(new Function(d)).bind(this),a.on(b,d)):(c=(new Function('arguments[0].on("'+b+'", '+c+".bind(this));")).bind(this),d?c(d,b):c(a,b))},bindEvents:function(a,b){1==arguments.length&&(b=null);for(var c=0;c<a[0].attributes.length;c++){var d=a[0].attributes[c].nodeName;if(0===d.indexOf("data-on")){var e=a[0].attributes[c].value,d=d.substr(7);this.bindEvent(a,d,e,b)}}},
bind:function(a){},renderBindings:function(){for(var a=0;a<this.__bindings.html.length;a++){var b=this.__bindings.html[a];try{b.element.html(b.tempFn(this))}catch(c){logger.error(c)}}},createComponent:function(a,b){var c=TdisplayObjectContainer._super.createComponent(a,b);null==this._children&&(this._children=[]);this._children.push(c);panjs.capture("createComponent",{classPath:a,componentId:c.id,from:{id:this.id,className:this.className,classPath:this.classPath}});return c},free:function(){if(null!=
this._children){for(var a=0;a<this._children.length;a++)this._children[a].free();this._children=null}TdisplayObjectContainer._super.free.call(this)},__OnPropChanged:function(a,b,c,d){this.renderBindings()},processStates:function(a){var b=a.getAttribute("data-include-in");null!=b&&(b=b.split(" "));var c=a.getAttribute("data-include-logic")||"OR",d=a.getAttribute("data-exclude-from");null!=d&&(d=d.split(" "));var e=a.getAttribute("data-exclude-logic")||"OR";if(null!=d&&null!=b)throw"'excludeFrom' and 'includeIn' attributes are exclusive";
if(null!=b||null!=d){var f=null!=a.getAttribute("data-compo"),g="true"==a.getAttribute("data-loaded");a={display:a.style.display,loaded:g,isCompo:f,visible:null,elem:a,excludeLogic:e,includeLogic:c,id:a.getAttribute("id"),includeIn:b,excludeFrom:d};this._statesElements.push(a)}},stateExists:function(a){var b=!1;if(null==a||""==a)return!1;for(var c=0;c<this._statesElements.length;c++){var d=this._statesElements[c];if(null!=d.includeIn&&0<=d.includeIn.indexOf(a)){b=!0;break}else if(null!=d.excludeFrom&&
0<=d.excludeFrom.indexOf(a)){b=!0;break}}return b},_onSubComponentLoaded:function(a,b,c){this._children.push(a);c=a.container.attr("data-original-id");this.bindEvents(b,a);c&&(this[c]=a);for(c=0;c<this._statesElements.length;c++){var d=this._statesElements[c];if(d.elem==b[0]){d.loaded=!0;d.elem=a.container[0];this.setStatesAttributes(b[0],d.elem);break}}panjs.capture&&panjs.capture("createComponent",{classPath:a.classPath,componentId:a.id,from:{id:this.id,className:this.className,classPath:this.classPath}})},
getChildren:function(){return this._children},findComponents:function(a){var b=$([]);this.container.find(0==arguments.length?"[data-compo]":'[data-compo*="'+a+'"]').each(function(a,d){d.isCompo()&&b.push(d.owner)});return b},setStatesAttributes:function(a,b){a.getAttribute("data-include-in")&&b.setAttribute("data-include-in",a.getAttribute("data-include-in"));a.getAttribute("data-include-logic")&&b.setAttribute("data-include-logic",a.getAttribute("data-include-logic"));a.getAttribute("data-exclude-from")&&
b.setAttribute("data-exclude-from",a.getAttribute("data-exclude-from"));a.getAttribute("data-exclude-logic")&&b.setAttribute("data-exclude-logic",a.getAttribute("data-exclude-logic"))},_setStateElementVisible:function(a,b,c){var d=!1;if(b.visible!=a){var d=!0,e=$(b.elem);a?b.isCompo?b.loaded?b.elem.compo.show(c):e.load().show(c):defined(c,"showFn")?c.showFn(e,b):(e.show(c),"none"!=b.display&&e.css("display",b.display)):b.isCompo?b.loaded?b.elem.compo.hide(c):defined(c,"hideFn")?c.hideFn(e,b):e.hide(c):
defined(c,"hideFn")?c.hideFn(e,b):e.hide(c);b.visible=a}return d},hasState:function(a){var b=!1;if("string"==typeof a)for(var c=0;c<this.currentState.length;c++){if(this.currentState[c]==a){b=!0;break}}else logger.error("hasState error: state is undefined");return b},toggleState:function(a,b,c){var d=!1;1==arguments.length?b=!this.hasState(a):2==arguments.length&&"boolean"!=typeof b&&(c=b,b=!this.hasState(a));return d=!1==b?this.removeState(a,c):this.addState(a,c)},addState:function(a,b){var c=!1;
if("string"==typeof a){for(var d=[],e=!1,f=0;f<this.currentState.length;f++)this.currentState[f]==a?e=!0:d.push(this.currentState[f]);e||(c=!0,d.push(a),this.setState(d,b))}else logger.error("addState error: state is undefined");return c},removeState:function(a,b){var c=!1;if("string"==typeof a){for(var d=[],e=0;e<this.currentState.length;e++)this.currentState[e]!=a?d.push(this.currentState[e]):c=!0;c&&this.setState(d,b)}else logger.error("removeState error: state is undefined");return c},setState:function(a,
b){var c={},d={},e=!1;if("string"==typeof a){var f=[a];c[a]=1}else for(var f=a,g=0;g<f.length;g++)void 0!=f[g]?c[f[g]]=1:logger.error("setState error: state is undefined");f=this.currentState;for(g=0;g<this.currentState.length;g++)this.container.removeClass(this.currentState[g]),d[this.currentState[g]]=1;this.currentState=[];for(var h=0;h<this._statesElements.length;h++){var l=this._statesElements[h],m=!0,n=!0;if(null!=l.includeIn)for(n=null,m=!0,g=0;g<l.includeIn.length;g++){var p=l.includeIn[g],
p="undefined"!=typeof c[p];if("OR"==l.includeLogic){if(m=p)break}else m=m&&p}else if(null!=l.excludeFrom)for(n=!1,m=null,g=0;g<l.excludeFrom.length;g++)if(p=l.excludeFrom[g],p="undefined"!=typeof c[p],"OR"==l.excludeLogic){if(n=p)break}else n=n&&p;if(null!=m||null!=n)e=this._setStateElementVisible(!0==m||!1==n,l,b)||e}this.currentState=[];for(var q in c)this.currentState.push(q),this.container.addClass(q);if(e){logger.isLevelEnabled(Tlogger.TRACE)&&logger.trace(this.id+".currentState = "+JSON.stringify(this.currentState));
g=[];for(q in c)"undefined"==typeof d[q]&&g.push(q);h=[];for(q in d)"undefined"==typeof c[q]&&h.push(q);this.dispatchEvent(new Tevent(Tevent.STATE_CHANGED,{oldStates:f,newStates:this.currentState,removedStates:h,addedStates:g}))}return e},processElement:function(a,b){var c=a[0];1==arguments.length&&(b={});c=this._processElement(c,a.parent()[0],!0);b&&!0==b.processStates&&this.setState(this.currentState);null==c&&(c=a);return c},_processElement:function(a,b,c,d){if(!a.owner){if(1==a.nodeType){var e=
a.getAttribute("id"),f=a.getAttribute("data-compo"),g=$(a),h=null;null==f?a.owner||(a.owner=this,c&&null!=e&&(defined(this[e])&&logger.warn('1-Duplication du id "'+e+'" sur objet '+this.className),this[panjs.getCamelCase(e)]=g,panjs._setDOMId(a,e,f)),this.bindEvents(g),this.processStates(a),this._populateElements(a,c)):f==this.classPath?logger.error("R\u00e9f\u00e9rence circulaire dans "+this.classPath):(4>arguments.length&&(d="false"!==a.getAttribute("data-autoload")),d?(h=this.createComponent(f,
{elem:a,owner:this}),h.owner=this,c&&null!=e&&(defined(this[e])&&logger.warn('2-Duplication du id "'+e+'" sur objet '+this.className),this[e]=h,panjs._setDOMId(h.container[0],e,f)),this.bindEvents(g,h),g.replaceWith(h.container),a.setAttribute("data-loaded","true"),h.container[0].loaded=!0,h.container[0].compo=h,h.container[0].owner=this,this.setStatesAttributes(a,h.container[0]),this.processStates(h.container[0]),h._triggerOnAdded()):a.owner||(panjs._setDOMId(a,e,f),g[0].compo=null,g[0].owner=this,
this[e]=g,this.processStates(a)))}else 8==a.nodeType&&(e="",e=a.textContent,e=e.toUpperCase(),"CONTENT"==e&&(e=document.createElement("div"),e.setAttribute("data-class","content"),b.replaceChild(e,a),this.content=$(e)));return h}},_populateElements:function(a,b,c){for(var d=0;d<a.childNodes.length;d++){var e=a.childNodes[d];3>arguments.length?this._processElement(e,a,b):this._processElement(e,a,b,c)}}});TdisplayObjectContainer._listeIdElements=[];__CLASSPATH__="panjs.core.display.Telement";
defineClass("Telement","panjs.core.display.TdisplayObjectContainer",{html:null,content:null,sourceElement:null,inheritsStyle:!0,enableHashManager:!1,hashKey:null,sourceElementStyle:null,constructor:function(a){Telement._super.constructor.call(this,a);!0==this.enableHashManager&&(uses("panjs.core.managers.Trouter"),"undefined"!=typeof a.hashKey&&(this.hashKey=a.hashKey),null==this.hashKey&&(this.hashKey=1<this.id?this.className+this.id:this.className),panjs.router.registerComponent(this,this._onHashChange,
this.hashKey));var b;b=this.inheritsStyle?this.classHierarchy.rightOf("Telement"):this.className;this.container.addClass(b);this.container.attr("data-compo",this.classPath);this.container.attr("data-class-name",this.className);this.container.attr("data-loaded",!0);"undefined"!=typeof a&&defined(a,"elem")&&(this.sourceElement=a.elem,null!=this.content&&""!=this.sourceElement.innerHTML.trim()&&(this.content[0].innerHTML=this.sourceElement.innerHTML,"undefined"!=typeof a.owner&&(this.owner=a.owner,a.owner._populateElements(this.content[0],
!0))),b=a.elem.getAttribute("class"),null!=b&&this.container.addClass(b));a=a.inlineStyle||null;null!=a&&(this.sourceElementStyle=a,this.setStyle(a))},setStyle:function(a){this.container.attr("style",a)},_onHashChange:function(a,b){var c=!1;this.enableHashManager&&"function"===typeof this.onHashChange&&(logger.debug("Telement."+this.id+"._onHashChange: "+b+" --\x3e "+a),c=this.onHashChange(a,b));return c},_onShow:function(){},_onHide:function(){},setHash:function(a,b){this.enableHashManager&&(2>arguments.length&&
(b=!1),panjs.router.setHash(this,a,b))},getHash:function(){return this.enableHashManager?panjs.router.getHash(this):null}});
