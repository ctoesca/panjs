(function(){panjs.logger=null;panjs.root={id:"root"};panjs.loader=null;panjs.iever=getIEVersion();panjs.chromever=getChromeVersion();panjs.ffver=getFirefoxVersion();panjs.stack=[];panjs.stackLevel=0;panjs.messages={CLASSNAME_MATCHS_FILENAME:"The name of the class (%1) must match the file name %2 (case sensitive)",LESS_IE8:"less.js is not fully compatible with IE%1 : transform less code in css",LESS_NOT_LOADED:"LESS not loaded. Use panjs_core_with_less.min.js or load LESS (before panJs)"};panjs.getMessage=
function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];null==c&&(c="null");a=a.replace("%"+b,c)}return a};window.less="undefined"!=typeof panjs.less?panjs.less:{env:"production",async:!0,fileAsync:!1,poll:1E3,functions:{},dumpLineNumbers:"comments",relativeUrls:!1,rootpath:":/a.com/"};for(var b=0;b<panjs.namespaces.length;b++)"undefined"!=typeof panjs.namespaces[b]&&(panjs.namespaces[b].path=panjs.namespaces[b].path.replace("{version}",panjs.version));panjs.createComponent=function(a,
b){panjs.stackLevel++;var c=panjs.getClassNameFromClassPath(a),d=null;if("undefined"==typeof window[c]){var f=panjs.loader.usesComponent(a);if(!f.result)return uses("core.display.TerrorElement.html"),d=new TerrorElement(f),panjs.stack.push(f.message),panjs.stackLevel--,0>=panjs.stackLevel&&(panjs.stack=[],panjs.stackLevel=0),d}try{d=new window[c](b)}catch(h){f="Error instantiating "+c+": "+h;logger.error(f);uses("core.display.TerrorElement.html");var d=panjs.getAbsoluteUrlFromClassPath(a),m=panjs.loader.getUrlWithVersion(d),
d=new TerrorElement({message:h,path:d,url:m,className:c});panjs.stack.push(f)}panjs.stackLevel--;0>=panjs.stackLevel&&(panjs.stack=[],panjs.stackLevel=0);d._onInitialized&&d._onInitialized();return d};panjs.loadScript=function(a,b){$LAB.script(a).wait(function(){"undefined"!=typeof b&&b(a)})};panjs.load=function(a){panjs._load(a)};panjs._load=function(a){0==arguments.length&&(a=$(document.body));var b=[];null!=a.attr("data-compo")?b.push(a):b=a.getElements("[data-compo]");for(var c=0;c<b.length;c++){var d=
b[c],f=d.attr("data-compo"),h="false"!==d.attr("autoload"),m=d.attr("id");!0==h?(f=panjs.createComponent(f,{elem:d[0]}),d.replaceWith(f.container),f.container[0].owner=f):(uses("core.display.TproxyDisplayObject"),f=new TproxyDisplayObject({sourceElement:d[0]}),d.hide(),d[0].setAttribute("id",panjs.root.id+"_"+m),d[0].originalId=m,d[0].owner=panjs.root);panjs.root[m]=f}logger.info("READY");"undefined"!=typeof onReady&&onReady()};panjs.getClassNameFromClassPath=function(a){var b=".";if(a.startsWith("http://")||
a.startsWith("https://")||"/"==a[0])b="/";var c=a;a.endsWith(".html")&&(c=a.removeEnd(".html"));a=c.split(b);return c=a[a.length-1]};panjs.getNamespace=function(a){for(var b=0;b<panjs.namespaces.length;b++){var c=panjs.namespaces[b];if(c.name==a)return c}return null};panjs.getAbsoluteUrlFromClassPath=function(a){var b=a.endsWith(".html"),c="";if(a.startsWith("http://")||"/"==a[0])c=b?a:a+".js";else for(var d=0;d<panjs.namespaces.length;d++){var f=panjs.namespaces[d];if(a.startsWith(f.name+".")){c=
a.removeEnd(".html").replace(/\./g,"/");c=c.replace(f.name,f.path);c=b?c+".html":c+".js";break}}if(""==c)throw"Can't resolve "+a+": verify namespaces";return c};panjs.isAbsoluteUrl=function(a){a=a.toLowerCase();return"/"==a[0]||a.toLowerCase().startsWith("http://")||a.toLowerCase().startsWith("https://")};panjs.transformUrl=function(a,b){"/"!=a[0]&&"http://"!=a.substring(0,7)&&"https://"!=a.substring(0,8)&&(a=b+"/"+a);return a}})();
var Tobject={classHierarchy:"Tobject",extend:function(b,a,e){var c=this.prototype||Tobject,d={};d.classHierarchy={value:c.classHierarchy+" "+a};if(8!=panjs.iever){for(k in b)d[k]={value:b[k],writable:!0,configurable:!0,enumerable:!0};b=Object.create(c,d);a=b.constructor;if(!(a instanceof Function))throw Error("You must define a method 'constructor'");a.prototype=b;a.prototype.parentClassName=e;a._super=c;a.extend=this.extend}else{d=b.constructor;for(k in c)"constructor"!=k&&"_super"!=k&&(d.prototype[k]=
c[k]);for(k in b)"constructor"!=k&&"_super"!=k&&(d.prototype[k]=b[k]);d.extend=this.extend;d._super=c;d.prototype.parentClassName=e;d.prototype.classHierarchy=c.classHierarchy+" "+a;a=d}return a},copyOwnTo:function(b,a){Object.getOwnPropertyNames(b).forEach(function(e){console.log(e);Object.defineProperty(a,e,Object.getOwnPropertyDescriptor(b,e))});return a},injectParam:function(b,a,e,c){if("undefined"==typeof a||null==a){if("undefined"!=typeof c)return this[b]=c,!0;if("undefined"!=typeof e&&!0==
e)throw"The "+b+" argument has no default value on "+this.className;return!1}this[b]=a;return!0},callLater:function(b,a){setTimeout(b.bind(this,a),50)}};
function defineClass(b,a,e){var c=a.endsWith(".html"),d=panjs.getClassNameFromClassPath(a);if("undefined"==typeof window[d]&&(c?panjs.loader.usesComponent(a):panjs.loader.uses(a),"undefined"==typeof window[d]))return logger&&logger.error("Unable to inherit from "+a+": class is not loaded"),null;try{window[b]=window[d].extend(e,b,d)}catch(f){alert(d+" "+f)}panjs.lastDefinedClassName=b}function uses(b){b.endsWith(".html")?panjs.loader.usesComponent(b):panjs.loader.uses(b)}
defineClass("Tlogger","core.Tobject",{_level:null,name:"MAIN",creationDate:null,active:!0,_currentGroup:0,_tabulation:"",tab:[],constructor:function(b){this.injectParam("_level",b.level,!1,Tlogger.INFO);this.injectParam("name",b.name,!1);this.creationDate=(new Date).getTime();this.setLevel(this._level);this.active="undefined"!=typeof console;this.razTime();this.info("Init logger LEVEL=",this.getLevelName())},razTime:function(){this.creationDate=new Date},getLevelName:function(){if(this._level==Tlogger.DEBUG)return"DEBUG";
if(this._level==Tlogger.INFO)return"INFO";if(this._level==Tlogger.WARN)return"WARN";if(this._level==Tlogger.ERROR)return"ERROR"},groupStart:function(){this.active&&(this._currentGroup++,this._calcTabultation())},groupEnd:function(){this.active&&(this._currentGroup--,this._calcTabultation())},_calcTabultation:function(){this._tabulation="";for(var b=0;b<this._currentGroup;b++)this._tabulation+="\t"},_getTime:function(){return(new Date).getTime()-this.creationDate},_debug:function(){this.active&&(console.debug?
console.debug(this._getMessage("DEBUG",arguments)):console.info(this._getMessage("DEBUG",arguments)))},_info:function(){this.active&&console.log(this._getMessage("INFO",arguments))},_warn:function(){this.active&&console.warn(this._getMessage("WARN",arguments))},_error:function(){this.active&&console.error(this._getMessage("ERROR",arguments))},_getMessage:function(b,a){for(var e="",c=0;c<a.length;c++)e+=a[c];c=this._getTime()+"ms("+this._currentGroup+")";100>c&&(c+=" ");1E3>c&&(c+=" ");1E4>c&&(c+=
" ");1E5>c&&(c+=" ");return c+" - "+b+"\t"+this._tabulation+e},setLevel:function(b){this._level=b;this.debug=this._debug;this.info=this._info;this.warn=this._warn;this.error=this._error;b>=Tlogger.INFO&&(this.debug=function(){});b>=Tlogger.WARN&&(this.info=function(){});b>=Tlogger.ERROR&&(this.warn=function(){})}});Tlogger.DEBUG=10;Tlogger.INFO=20;Tlogger.WARN=25;Tlogger.ERROR=30;panjs.logger=new Tlogger({level:Tlogger[panjs.logLevel],name:"main"});logger=panjs.logger;Ttracer=function(){};
Ttracer.getLogger=function(b){return logger};
defineClass("Tloader","core.Tobject",{queue:[],_count:0,maxImbrications:10,loadedJs:null,loadedCss:null,_lessIsLoaded:null,constructor:function(b){this.loadedJs={};this.loadedCss={}},lessIsLoaded:function(){null==this._lessIsLoaded&&(this._lessIsLoaded=defined(window.less,"refresh"));return this._lessIsLoaded},getClassPathDir:function(b){var a=null,a=panjs.getClassNameFromClassPath(b);if(b.endsWith(".js"))a=b.removeEnd(a+".js");else if(b.endsWith(".html"))a=b.removeEnd(a+".html");else return;return a},
getUrlWithVersion:function(b){b=!1==b.contains("?")?b+"?":b+"&";b+="v="+panjs.appVersion;"dev"==panjs.env&&(b=b+"&rid="+Math.random());return b},loadFile:function(b){try{var a={result:!1,exception:"",status:"erreur inconnue"};logger.debug("Loadfile SYNC ",b);jQuery.support.cors=!0;var e=jQuery.ajax({url:b,method:"GET",cache:!0,async:!1,dataType:"html",processData:!1,context:this,success:function(c,e,h){this.onLoadFileSuccess(h,b);a={result:!0,data:c}},error:function(c,f,h){this.onLoadFileError(e,
f,h,b);a={result:!1,jqXHR:e,exception:h};a.status=e&&e.status?e.status:h}})}catch(c){a={result:!1,exception:c,status:c}}return a},onLoadFileSuccess:function(b,a){},onLoadFileError:function(b,a,e,c){logger.error("Echec chargement "+c+": "+e)},usesComponent:function(b){var a=panjs.getClassNameFromClassPath(b),e=null,c=null;if(this._count>this.maxImbrications)return{result:!1,message:"Too much nested components (max: "+this.maxImbrications+")",className:a,classPath:b,url:e,path:"?"};if("undefined"==
typeof window[a]){logger.groupStart();0==this._count&&logger.info(" ************ "," USESCOMPONENT ",b," ************ ");this._count++;var c=panjs.getAbsoluteUrlFromClassPath(b),e=this.getUrlWithVersion(c),d=this.loadFile(e);if(d.result){try{var f=getXmlDocument(d.data)}catch(h){return logger.error(h),{result:!1,message:h,className:a,classPath:b,url:e,path:c}}for(var d=f.getElementsByTagName("head")[0],f=f.getElementsByTagName("body")[0],m=[],q=[],r=c.substring(0,c.lastIndexOf("/")),l=0;l<d.childNodes.length;l++){var n=
d.childNodes[l],p=n.nodeName.toLowerCase();if("script"==p)try{this.addScriptNode(n,r,a)}catch(s){var g="Error processing <"+p+"> in "+a+" => "+s;logger.error(c,g);return{result:!1,message:g,className:a,classPath:b,url:e,path:c,stack:s.stack}}else"link"==p?m.push(n):"style"==p&&q.push(n)}if("undefined"==typeof window[a])return g=b+" class has not been loaded. ",panjs.lastDefinedClassName!=a&&(g+="\n"+panjs.getMessage(panjs.messages.CLASSNAME_MATCHS_FILENAME,panjs.lastDefinedClassName,c)),logger.error(g),
{result:!1,message:g,className:a,classPath:b,url:e,path:c,stack:null};for(l=0;l<m.length;l++)this.addLinkNode(m[l],r);for(l=0;l<q.length;l++)logger.debug("Load style ",b),this.addStyleNode(q[l]);if(defined(f))try{var g=getXml(f),t=window[a].prototype.parentClassName;defined(window[t].prototype.html)&&(g=window[t].prototype.html.replace("\x3c!--CONTENT--\x3e",g));g=g.replace(/<body>/gi,"").replace(/<\/body>/gi,"");g=g.replace(/\\r/gi,"").replace(/\\n/gi,"").trim();window[a].prototype.html=g;if(8==
panjs.iever){var u=$("<div>"+g+"</div>");window[a].prototype.html=u[0].innerHTML}window[a].prototype.bodyNode=f}catch(v){return{result:!1,message:v.message,className:a,classPath:b,url:e,path:c}}window[a].prototype.classPath=b;window[a].prototype.classPathDir=this.getClassPathDir(b);window[a].prototype.className=a;window[a].prototype.dirPath=r;window[a].lastId=0;this._count--;0==this._count&&logger.debug(" ************ "," END USESCOMPONENT ",b," ************ ");logger.groupEnd();return{result:!0,
message:"ok",className:a,classPath:b,url:e,path:c}}g="Error loading "+b+": "+d.status;logger.warn(g);this._count--;logger.groupEnd();return{result:!1,message:g,className:a,classPath:b,url:e,path:c}}return{result:!0,message:"Already loaded",className:a,classPath:b,url:e,path:c}},uses:function(b){var a=panjs.getClassNameFromClassPath(b),e=null,e=null;if("undefined"==typeof window[a]){logger.groupStart();0==this._count&&logger.info(" ------------ "," USES ",b," ------------ ");e=panjs.getAbsoluteUrlFromClassPath(b);
if(this.loadedJs[e.toLowerCase()])return!0;this._count++;logger.groupStart();e=this.getUrlWithVersion(e);e=this.loadFile(e);e.result&&(e.data=this.processCode(e.data,a),exec(e.data),window[a].prototype.classPath=b,window[a].prototype.className=a,window[a].prototype.classPathDir=this.getClassPathDir(b),window[a].lastId=0);this._count--;logger.groupEnd();0==this._count&&logger.debug(" ------------ "," END USES ",b," ------------ ");logger.groupEnd();return!0}},addLinkNode:function(b,a){var e=panjs.transformUrl(b.getAttribute("href"),
a),c=b.getAttribute("type")||"text/css",d=b.getAttribute("rel")||"stylesheet";this.loadCssFile(e,c,d)},loadCssFile:function(b,a,e){var c=!1;if(this.loadedCss[b.toLowerCase()])return c;var d=arguments.length;if(0==d)throw"loadCssFile(url, type , rel): Missing url";2==d&&(e="stylesheet/less");b=this.getUrlWithVersion(b);document.createStyleSheet&&8==panjs.iever?(document.createStyleSheet(b),c=!0):(d=document.createElement("link"),d.rel=e,d.type=a,d.href=b,"stylesheet/less"==e?0<panjs.iever&&8>=panjs.iever?
logger.warn(panjs.getMessage(panjs.messages.LESS_IE8,panjs.iever)):this.lessIsLoaded()?(less.sheets.push(d),less.refresh(!0),logger.debug("INJECTION LESS OK"),c=!0):logger.warn(panjs.getMessage(panjs.messages.LESS_NOT_LOADED)):(document.getElementsByTagName("head")[0].appendChild(d),c=!0));!0==c&&logger.debug("Load <link> ASYNC: "+b);this.loadedCss[b.toLowerCase()]=!0;return c},addStyle:function(b,a){"undefined"==typeof a&&(a="text/css");$('<style type="'+a+'">'+b+"</style>").appendTo("head");"text/less"==
a&&(0<panjs.iever&&8>=panjs.iever?logger.warn(panjs.getMessage(panjs.messages.LESS_IE8,panjs.iever)):this.lessIsLoaded()?(less.refresh(),logger.debug("INJECTION LESS OK")):logger.warn(panjs.getMessage(panjs.messages.LESS_NOT_LOADED)));8==panjs.iever&&"undefined"!=typeof respond&&respond.update()},addStyleNode:function(b){var a=b.getAttribute("type");null==a&&(a="text/css");b=getText(b);this.addStyle(b,a)},processCode:function(b,a){return b.replace(/this._super/g,a+"._super")},addScriptNode:function(b,
a,e){if(null==b.getAttribute("src"))a=getText(b),null!=e&&"text/x-class-definition"==b.getAttribute("type")?a=this.processCode(a,e):null!=e&&logger.warn('type="text/x-class-definition" doesn\'t exist on <script> ('+e+")"),exec(a);else if(a=panjs.transformUrl(b.getAttribute("src"),a),this.loadedJs[a.toLowerCase()])logger.debug("Le script "+a+" est d\u00e9j\u00e0 charg\u00e9");else{var c=this.loadFile(this.getUrlWithVersion(a));null!=e&&"text/x-class-definition"==b.getAttribute("type")&&(c.data=this.processCode(c.data,
e));exec(c.data);this.loadedJs[a.toLowerCase()]=1}return!0}});panjs.loader=new Tloader;
