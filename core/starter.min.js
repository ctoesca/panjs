(function(){panjs.logger=null;panjs.root={id:"root",components:{}};panjs.loader=null;panjs.iever=getIEVersion();panjs.chromever=getChromeVersion();panjs.ffver=getFirefoxVersion();panjs.stack=[];panjs.stackLevel=0;panjs.setSourceInComponents=!1;panjs.messages={CLASSNAME_MATCHS_FILENAME:"The name of the class (%1) must match the file name %2 (case sensitive)",LESS_IE8:"less is not fully compatible with IE%1 : transform less code in css",LESS_NOT_LOADED:"LESS not loaded. Use panjs_core_with_less.min.js or load LESS (before panJs)"};
panjs.getMessage=function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];null==c&&(c="null");a=a.replace("%"+b,c)}return a};panjs.getClass=function(a){"undefined"==typeof window[a]&&uses(a);return window[a]};panjs.getInstance=function(a,b){return new (panjs.getClass(a))(b)};window.less="undefined"!=typeof panjs.less?panjs.less:{env:"production",async:!0,fileAsync:!1,poll:1E3,functions:{},dumpLineNumbers:"comments",relativeUrls:!1,rootpath:":/a.com/"};for(var b in panjs.namespaces)panjs.namespaces[b].path=
panjs.namespaces[b].path.replace("{version}",panjs.version);panjs.createComponent=function(a,b){panjs.stackLevel++;var c=panjs.getClassNameFromClassPath(a),d=null;if("undefined"==typeof window[c])try{var f=panjs.loader.usesComponent(a);if(!f.result)throw f;}catch(g){return"string"==typeof g&&(g={message:g,className:c}),uses("core.display.TerrorElement.html"),d=new TerrorElement(g),panjs.stack.push(g.message),panjs.stackLevel--,0>=panjs.stackLevel&&(panjs.stack=[],panjs.stackLevel=0),d}try{"undefined"==
typeof b&&(b={});"undefined"!=typeof b.elem&&panjs.setElementArgs(b.elem,b);if("undefined"!=typeof panjs.root.components[a]&&"undefined"!=b.reuse&&!0===b.reuse){var h=panjs.root.components[a];h.reuse(b);return h}d=new window[c](b)}catch(m){f="Error instantiating "+c+": "+m,logger.error(f),uses("core.display.TerrorElement.html"),d=panjs.getAbsoluteUrlFromClassPath(a),h=panjs.loader.getUrlWithVersion(d),d=new TerrorElement({message:f,path:d,url:h,className:c}),panjs.stack.push(f)}panjs.stackLevel--;
0>=panjs.stackLevel&&(panjs.stack=[],panjs.stackLevel=0);d._onInitialized&&d._onInitialized();return panjs.root.components[a]=d};panjs.setElementArgs=function(a,b){if("undefined"!=typeof a)for(var c=0;c<a.attributes.length;c++){var d=a.attributes.item(c),f=d.nodeName.toLowerCase(),d=d.value;f.startsWith("data-")&&(f=panjs.getFormatedArgName(f));"true"==d?d=!0:"false"==d&&(d=!1);b[f]=d}};panjs.getFormatedIdName=function(a){if(-1==a.indexOf("-"))return a;var b="";a=a.split("-");for(var c=0;c<a.length;c++)b=
0==c?a[c]:b+a[c].capitalizeFirstLetter();return b};panjs.getFormatedArgName=function(a){var b="";a=a.split("-");for(var c=1;c<a.length;c++)b=1==c?a[c]:b+a[c].capitalizeFirstLetter();return b};panjs.loadScript=function(a,b){$LAB.script(a).wait(function(){"undefined"!=typeof b&&b(a)})};panjs.load=function(a){panjs._load(a)};panjs.exec=function(a){""!=a&&("undefined"!=typeof window.execScript?window.execScript(a):window.eval(a))};panjs._load=function(a){0==arguments.length&&(a=$(document.body));var b=
[];null!=a.attr("data-compo")?b.push(a):b=a.getElements("[data-compo]");for(var c=0;c<b.length;c++){var d=b[c],f=d.attr("data-compo"),g="false"!==d.attr("autoload"),h=d.attr("id");!0==g?(f=panjs.createComponent(f,{elem:d[0]}),d.replaceWith(f.container),f.container[0].owner=f):(uses("core.display.TproxyDisplayObject"),f=new TproxyDisplayObject({sourceElement:d[0]}),f.parent=this,d[0].loaded=!1,d.hide(),d[0].setAttribute("id",panjs.root.id+"_"+h),d[0].originalId=h,d[0].owner=panjs.root);panjs.root[h]=
f}logger.info("READY");"undefined"!=typeof onReady&&onReady()};panjs.getClassNameFromClassPath=function(a){var b=".";if(a.startsWith("http://")||a.startsWith("https://")||"/"==a[0])b="/";var c=a;a.endsWith(".html")&&(c=a.removeEnd(".html"));a=c.split(b);return c=a[a.length-1]};panjs.getNamespace=function(a){a=null;"undefined"!=typeof panjs.namespaces[b]&&(a=panjs.namespaces[b]);return a};panjs.getAbsoluteUrlFromClassPath=function(a){var b=a.endsWith(".html"),c="";if(a.startsWith("http://")||"/"==
a[0])c=b?a:a+".js";else if(a.contains("."))for(var d in panjs.namespaces){if(a.startsWith(d+".")){c=a.removeEnd(".html").replace(/\./g,"/");c=c.replace(d,panjs.namespaces[d].path);c=b?c+".html":c+".js";break}}else c=a,c=b?c+".html":c+".js";if(""==c)throw"Can't resolve "+a+": verify namespaces";return c};panjs.isAbsoluteUrl=function(a){a=a.toLowerCase();return"/"==a[0]||a.toLowerCase().startsWith("http://")||a.toLowerCase().startsWith("https://")};panjs.transformUrl=function(a,b){"/"!=a[0]&&"http://"!=
a.substring(0,7)&&"https://"!=a.substring(0,8)&&(a=b+"/"+a);return a}})();
var Tobject={classHierarchy:"Tobject",extend:function(b,a,e){var c=this.prototype||Tobject,d={};d.classHierarchy={value:c.classHierarchy+" "+a};for(var f in b)if(f.startsWith("$")){a=b[f];f=f.droite("$");logger.debug("BINDABLE => "+f+", defaultValue="+a);d["__"+f]={value:a,writable:!0,enumerable:!0};a=new Function('var key = "__'+f+'", propName="'+f+'",oldValue=this[key];newValue=arguments[0]; if (this[key] != arguments[0]){this[key] = arguments[0]; this.__OnPropChanged(propName, oldValue, newValue, this);}');var g=
new Function('var key = "__'+f+'"; return this[key]');d[f]={get:g,set:a}}else d[f]={value:b[f],writable:!0,configurable:!0,enumerable:!0};b=Object.create(c,d);d=b.constructor;if(!(d instanceof Function))throw Error("You must define a method 'constructor'");d.prototype=b;d.prototype.parentClassName=e;d._super=c;d.extend=this.extend;return d},__OnPropChanged:function(b,a,e,c){},copyOwnTo:function(b,a){Object.getOwnPropertyNames(b).forEach(function(e){console.log(e);Object.defineProperty(a,e,Object.getOwnPropertyDescriptor(b,
e))});return a},injectParam:function(b,a,e,c){if("undefined"==typeof a||null==a){if("undefined"!=typeof c)return this[b]=c,!0;if("undefined"!=typeof e&&!0==e)throw"The "+b+" argument has no default value on "+this.className;return!1}this[b]=a;return!0}};
function defineClass(b,a,e){var c=a.endsWith(".html"),d=panjs.getClassNameFromClassPath(a);if("undefined"==typeof window[d]&&(c?panjs.loader.usesComponent(a):panjs.loader.uses(a),"undefined"==typeof window[d]))return logger&&logger.error("Unable to inherit from "+a+": class is not loaded"),null;try{window[b]=window[d].extend(e,b,d)}catch(f){alert(d+" "+f)}panjs.lastDefinedClassName=b}function uses(b){return b.endsWith(".html")?panjs.loader.usesComponent(b):panjs.loader.uses(b)}
defineClass("Tlogger","core.Tobject",{_level:null,name:"MAIN",creationDate:null,active:!0,_currentGroup:0,_tabulation:"",tab:[],constructor:function(b){this.injectParam("_level",b.level,!1,Tlogger.INFO);this.injectParam("name",b.name,!1);this.creationDate=(new Date).getTime();this.setLevel(this._level);this.active="undefined"!=typeof console;this.razTime();this.info("Init logger LEVEL=",this.getLevelName())},razTime:function(){this.creationDate=new Date},isLevelEnabled:function(b){return b>=this._level},
getLevelName:function(){if(this._level==Tlogger.TRACE)return"TRACE";if(this._level==Tlogger.DEBUG)return"DEBUG";if(this._level==Tlogger.INFO)return"INFO";if(this._level==Tlogger.WARN)return"WARN";if(this._level==Tlogger.ERROR)return"ERROR"},groupStart:function(){this.active&&(this._currentGroup++,this._calcTabultation())},groupEnd:function(){this.active&&(this._currentGroup--,this._calcTabultation())},_calcTabultation:function(){this._tabulation="";for(var b=0;b<this._currentGroup;b++)this._tabulation+=
"\t"},_getTime:function(){return(new Date).getTime()-this.creationDate},_trace:function(){if(this.active){var b=this._getMessage("TRACE",arguments);console.trace?console.trace(b):console.log(b)}},_debug:function(){if(this.active){var b=this._getMessage("DEBUG",arguments);console.debug?console.debug(b):console.log(b)}},_info:function(){if(this.active){var b=this._getMessage("INFO",arguments);console.info?console.info(b):console.log(b)}},_warn:function(){if(this.active){var b=this._getMessage("WARN",
arguments);console.warn?console.warn(b):console.log(b)}},_error:function(){this.active&&console.error(this._getMessage("ERROR",arguments))},_getMessage:function(b,a){for(var e="",c=0;c<a.length;c++)e+=a[c];return this._getTime()+"ms("+this._currentGroup+") - "+b+"\t"+this._tabulation+e},setLevel:function(b){this._level=b;this.trace=this._trace;this.debug=this._debug;this.info=this._info;this.warn=this._warn;this.error=this._error;b>=Tlogger.DEBUG&&(this.trace=function(){});b>=Tlogger.INFO&&(this.debug=
function(){});b>=Tlogger.WARN&&(this.info=function(){});b>=Tlogger.ERROR&&(this.warn=function(){})}});Tlogger.TRACE=10;Tlogger.DEBUG=20;Tlogger.INFO=30;Tlogger.WARN=40;Tlogger.ERROR=50;panjs.logger=new Tlogger({level:Tlogger[panjs.logLevel],name:"main"});logger=panjs.logger;Ttracer=function(){};Ttracer.getLogger=function(b){return logger};
defineClass("Tloader","core.Tobject",{queue:[],_count:0,maxImbrications:10,loadedJs:null,loadedCss:null,_lessIsLoaded:null,randomId:"",constructor:function(b){this.loadedJs={};this.loadedCss={};this.randomId=Math.random()},lessIsLoaded:function(){null==this._lessIsLoaded&&(this._lessIsLoaded=defined(window.less,"refresh"));return this._lessIsLoaded},getClassPathDir:function(b){var a=b;b.endsWith(".js")?a=b.removeEnd(".js"):b.endsWith(".html")&&(a=b.removeEnd(".html"));return a=a.substr(0,a.lastIndexOf("."))},
getUrlWithVersion:function(b){b=!1==b.contains("?")?b+"?":b+"&";b+="v="+panjs.appVersion;"dev"==panjs.env&&(b=b+"&rid="+this.randomId);return b},loadFile:function(b){try{var a={result:!1,exception:"",status:"erreur inconnue"};logger.debug("Loadfile SYNC ",b);jQuery.support.cors=!0;var e=jQuery.ajax({url:b,method:"GET",cache:!0,async:!1,dataType:"html",processData:!1,context:this,beforeSend:function(a){a.setRequestHeader("Cache-Control","no-transform")},success:function(c,e,g){this.onLoadFileSuccess(g,
b);a={result:!0,data:c}},error:function(c,f,g){this.onLoadFileError(e,f,g,b);a={result:!1,jqXHR:e,exception:g};a.status=e&&e.status?e.status:g}})}catch(c){a={result:!1,exception:c,status:c}}return a},onLoadFileSuccess:function(b,a){},onLoadFileError:function(b,a,e,c){logger.error("Echec chargement "+c+": "+e)},usesComponent:function(b){var a=panjs.getClassNameFromClassPath(b),e=null,c=null;if(this._count>this.maxImbrications)return{result:!1,message:"Too much nested components (max: "+this.maxImbrications+
")",className:a,classPath:b,url:e,path:"?",Class:null};if("undefined"==typeof window[a]){logger.groupStart();0==this._count&&logger.info(" ************ "," USESCOMPONENT ",b," ************ ");this._count++;var c=panjs.getAbsoluteUrlFromClassPath(b),e=this.getUrlWithVersion(c),d=this.loadFile(e);if(d.result){try{var f=getXmlDocument(d.data)}catch(g){return logger.error(g),{result:!1,message:g,className:a,classPath:b,url:e,path:c}}for(var h=f.getElementsByTagName("head")[0],f=f.getElementsByTagName("body")[0],
m=[],q=[],r=c.substring(0,c.lastIndexOf("/")),k=0;k<h.childNodes.length;k++){var n=h.childNodes[k],p=n.nodeName.toLowerCase();if("script"==p)try{this.addScriptNode(n,r,a)}catch(t){return d="Error processing <"+p+"> in "+a+" => "+t,logger.error(c,d),{result:!1,message:d,className:a,classPath:b,url:e,path:c,stack:t.stack}}else"link"==p?m.push(n):"style"==p&&q.push(n)}if("undefined"==typeof window[a])return d=b+" class has not been loaded. ",panjs.lastDefinedClassName!=a&&(d+="\n"+panjs.getMessage(panjs.messages.CLASSNAME_MATCHS_FILENAME,
panjs.lastDefinedClassName,c)),logger.error(d),{result:!1,message:d,className:a,classPath:b,url:e,path:c,stack:null};for(k=0;k<m.length;k++)this.addLinkNode(m[k],r);for(k=0;k<q.length;k++)logger.debug("Load style ",b),this.addStyleNode(q[k]);if(defined(f))try{var l=getXml(f),s=window[a].prototype.parentClassName;defined(window[s].prototype.html)&&window[s].prototype.html.contains("\x3c!--CONTENT--\x3e")&&(l=window[s].prototype.html.replace("\x3c!--CONTENT--\x3e",l));l=l.replace(/<body>/gi,"").replace(/<\/body>/gi,
"");l=l.replace(/\\r/gi,"").replace(/\\n/gi,"").trim();window[a].prototype.html=l;window[a].prototype.bodyNode=f}catch(u){return{result:!1,message:u.message,className:a,classPath:b,url:e,path:c,Class:null}}panjs.setSourceInComponents&&(window[a].prototype.source=d.data);window[a].prototype.classPath=b;window[a].prototype.classPathDir=this.getClassPathDir(b);window[a].prototype.className=a;window[a].prototype.dirPath=r;window[a].lastId=0;this._count--;0==this._count&&logger.debug(" ************ ",
" END USESCOMPONENT ",b," ************ ");logger.groupEnd();return{result:!0,message:"ok",className:a,classPath:b,url:e,path:c,Class:window[a]}}d="Error loading "+b+": "+d.status;logger.warn(d);this._count--;logger.groupEnd();return{result:!1,message:d,className:a,classPath:b,url:e,path:c,Class:null}}return{result:!0,message:"Already loaded",className:a,classPath:b,url:e,path:c,Class:window[a]}},uses:function(b){var a=panjs.getClassNameFromClassPath(b),e=null,c=null;if("undefined"==typeof window[b]){logger.groupStart();
0==this._count&&logger.info(" ------------ "," USES ",b," ------------ ");var c=panjs.getAbsoluteUrlFromClassPath(b),d=c.substring(0,c.lastIndexOf("/"));if(this.loadedJs[c.toLowerCase()])return!0;this._count++;logger.groupStart();var e=this.getUrlWithVersion(c),f=this.loadFile(e);f.result&&(f.data=this.processCode(f.data,a),panjs.exec(f.data),panjs.setSourceInComponents&&(window[a].prototype.source=f.data),window[a].prototype.classPath=b,window[a].prototype.className=a,window[a].prototype.classPathDir=
this.getClassPathDir(b),window[a].prototype.dirPath=d,window[b]=window[a]);this._count--;logger.groupEnd();0==this._count&&logger.debug(" ------------ "," END USES ",b," ------------ ");logger.groupEnd();return{result:!0,message:"ok",className:a,classPath:b,url:e,path:c,Class:window[a]}}return{result:!0,message:"Already loaded",className:a,classPath:b,url:e,path:c,Class:window[a]}},addLinkNode:function(b,a){var e=panjs.transformUrl(b.getAttribute("href"),a),c=b.getAttribute("type")||"text/css",d=
b.getAttribute("rel")||"stylesheet";this.loadCssFile(e,c,d)},loadCssFile:function(b,a,e){var c=!1;b=this.getUrlWithVersion(b);if(this.loadedCss[b.toLowerCase()])return c;if(0==arguments.length)throw"loadCssFile(url, type , rel): Missing url";"undefined"==typeof a&&(a="text/css");"undefined"==typeof e&&(e="stylesheet");var d=document.createElement("link");d.rel=e;d.type=a;d.href=b;"stylesheet/less"==e?this.lessIsLoaded()?(less.sheets.push(d),less.refresh(!0),logger.debug("INJECTION LESS OK"),c=!0):
logger.warn(panjs.getMessage(panjs.messages.LESS_NOT_LOADED)):(document.getElementsByTagName("head")[0].appendChild(d),c=!0);!0==c&&logger.debug("Load <link> ASYNC: "+b);this.loadedCss[b.toLowerCase()]=!0;return c},addStyle:function(b,a){""!=b.trim()&&("undefined"==typeof a&&(a="text/css"),$('<style type="'+a+'">'+b+"</style>").appendTo("head"),"text/less"==a&&(this.lessIsLoaded()?(less.refresh(),logger.debug("INJECTION LESS OK")):logger.warn(panjs.getMessage(panjs.messages.LESS_NOT_LOADED))))},addStyleNode:function(b){var a=
b.getAttribute("type");null==a&&(a="text/css");b=getText(b);this.addStyle(b,a)},processCode:function(b,a){return b.replace(/this._super/g,a+"._super")},addScriptNode:function(b,a,e){if(null==b.getAttribute("src"))a=getText(b),null!=e&&"text/x-class-definition"==b.getAttribute("type")&&(a=this.processCode(a,e)),panjs.exec(a);else if(a=panjs.transformUrl(b.getAttribute("src"),a),this.loadedJs[a.toLowerCase()])logger.debug("Le script "+a+" est d\u00e9j\u00e0 charg\u00e9");else{var c=this.loadFile(this.getUrlWithVersion(a));
null!=e&&"text/x-class-definition"==b.getAttribute("type")&&(c.data=this.processCode(c.data,e));panjs.exec(c.data);this.loadedJs[a.toLowerCase()]=1}return!0}});panjs.loader=new Tloader;
