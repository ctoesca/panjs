(function(){panjs.logger=null;panjs.root={id:"root",components:{}};panjs.loader=null;panjs.iever=getIEVersion();panjs.chromever=getChromeVersion();panjs.ffver=getFirefoxVersion();panjs.stack=[];panjs.stackLevel=0;panjs.setSourceInComponents=!1;panjs.messages={CLASSNAME_MATCHS_FILENAME:"The name of the class (%1) must match the file name %2 (case sensitive)",LESS_IE8:"less is not fully compatible with IE%1 : transform less code in css",LESS_NOT_LOADED:"LESS not loaded. Use panjs_core_with_less.min.js or load LESS (before panJs)"};
panjs.getMessage=function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];null==c&&(c="null");a=a.replace("%"+b,c)}return a};panjs.getClass=function(a){"undefined"==typeof window[a]&&uses(a);return window[a]};window.less="undefined"!=typeof panjs.less?panjs.less:{env:"production",async:!0,fileAsync:!1,poll:1E3,functions:{},dumpLineNumbers:"comments",relativeUrls:!1,rootpath:":/a.com/"};for(var b=0;b<panjs.namespaces.length;b++)"undefined"!=typeof panjs.namespaces[b]&&(panjs.namespaces[b].path=
panjs.namespaces[b].path.replace("{version}",panjs.version));panjs.createComponent=function(a,b){panjs.stackLevel++;var c=panjs.getClassNameFromClassPath(a),d=null;if("undefined"==typeof window[c]){var f=panjs.loader.usesComponent(a);if(!f.result)return uses("core.display.TerrorElement.html"),d=new TerrorElement(f),panjs.stack.push(f.message),panjs.stackLevel--,0>=panjs.stackLevel&&(panjs.stack=[],panjs.stackLevel=0),d}try{"undefined"==typeof b&&(b={});if("undefined"!=typeof b.elem)for(var g=b.elem,
f=0;f<g.attributes.length;f++){var l=g.attributes.item(f),m=l.nodeName.toLowerCase(),n=l.value;"id"!=m&&"data-compo"!=m&&(m.startsWith("data-")&&(m=panjs.getFormatedArgName(m)),"true"==n&&(n=!0),"false"==n&&(n=!1),b[m]=n)}if("undefined"!=typeof panjs.root.components[a]&&"undefined"!=b.reuse&&!0===b.reuse){var q=panjs.root.components[a];q.reuse(b);return q}d=new window[c](b)}catch(h){g="Error instantiating "+c+": "+h,logger.error(g),uses("core.display.TerrorElement.html"),d=panjs.getAbsoluteUrlFromClassPath(a),
l=panjs.loader.getUrlWithVersion(d),d=new TerrorElement({message:h,path:d,url:l,className:c}),panjs.stack.push(g)}panjs.stackLevel--;0>=panjs.stackLevel&&(panjs.stack=[],panjs.stackLevel=0);d._onInitialized&&d._onInitialized();return panjs.root.components[a]=d};panjs.getFormatedIdName=function(a){if(-1==a.indexOf("-"))return a;var b="";a=a.split("-");for(var c=0;c<a.length;c++)b=0==c?a[c]:b+a[c].capitalizeFirstLetter();return b};panjs.getFormatedArgName=function(a){var b="";a=a.split("-");for(var c=
1;c<a.length;c++)b=1==c?a[c]:b+a[c].capitalizeFirstLetter();return b};panjs.loadScript=function(a,b){$LAB.script(a).wait(function(){"undefined"!=typeof b&&b(a)})};panjs.load=function(a){panjs._load(a)};panjs._load=function(a){0==arguments.length&&(a=$(document.body));var b=[];null!=a.attr("data-compo")?b.push(a):b=a.getElements("[data-compo]");for(var c=0;c<b.length;c++){var d=b[c],f=d.attr("data-compo"),g="false"!==d.attr("autoload"),l=d.attr("id");!0==g?(f=panjs.createComponent(f,{elem:d[0]}),d.replaceWith(f.container),
f.container[0].owner=f):(uses("core.display.TproxyDisplayObject"),f=new TproxyDisplayObject({sourceElement:d[0]}),f.parent=this,d[0].loaded=!1,d.hide(),d[0].setAttribute("id",panjs.root.id+"_"+l),d[0].originalId=l,d[0].owner=panjs.root);panjs.root[l]=f}logger.info("READY");"undefined"!=typeof onReady&&onReady()};panjs.getClassNameFromClassPath=function(a){var b=".";if(a.startsWith("http://")||a.startsWith("https://")||"/"==a[0])b="/";var c=a;a.endsWith(".html")&&(c=a.removeEnd(".html"));a=c.split(b);
return c=a[a.length-1]};panjs.getNamespace=function(a){for(var b=0;b<panjs.namespaces.length;b++){var c=panjs.namespaces[b];if(c.name==a)return c}return null};panjs.getAbsoluteUrlFromClassPath=function(a){var b=a.endsWith(".html"),c="";if(a.startsWith("http://")||"/"==a[0])c=b?a:a+".js";else for(var d=0;d<panjs.namespaces.length;d++){var f=panjs.namespaces[d];if(a.startsWith(f.name+".")){c=a.removeEnd(".html").replace(/\./g,"/");c=c.replace(f.name,f.path);c=b?c+".html":c+".js";break}}if(""==c)throw"Can't resolve "+
a+": verify namespaces";return c};panjs.isAbsoluteUrl=function(a){a=a.toLowerCase();return"/"==a[0]||a.toLowerCase().startsWith("http://")||a.toLowerCase().startsWith("https://")};panjs.transformUrl=function(a,b){"/"!=a[0]&&"http://"!=a.substring(0,7)&&"https://"!=a.substring(0,8)&&(a=b+"/"+a);return a}})();
var Tobject={classHierarchy:"Tobject",extend:function(b,a,e){var c=this.prototype||Tobject,d={};d.classHierarchy={value:c.classHierarchy+" "+a};if(8!=panjs.iever){for(k in b)d[k]={value:b[k],writable:!0,configurable:!0,enumerable:!0};b=Object.create(c,d);a=b.constructor;if(!(a instanceof Function))throw Error("You must define a method 'constructor'");a.prototype=b;a.prototype.parentClassName=e;a._super=c;a.extend=this.extend}else{d=b.constructor;for(k in c)"constructor"!=k&&"_super"!=k&&(d.prototype[k]=
c[k]);for(k in b)"constructor"!=k&&"_super"!=k&&(d.prototype[k]=b[k]);d.extend=this.extend;d._super=c;d.prototype.parentClassName=e;d.prototype.classHierarchy=c.classHierarchy+" "+a;a=d}return a},copyOwnTo:function(b,a){Object.getOwnPropertyNames(b).forEach(function(e){console.log(e);Object.defineProperty(a,e,Object.getOwnPropertyDescriptor(b,e))});return a},injectParam:function(b,a,e,c){if("undefined"==typeof a||null==a){if("undefined"!=typeof c)return this[b]=c,!0;if("undefined"!=typeof e&&!0==
e)throw"The "+b+" argument has no default value on "+this.className;return!1}this[b]=a;return!0}};function defineClass(b,a,e){var c=a.endsWith(".html"),d=panjs.getClassNameFromClassPath(a);if("undefined"==typeof window[d]&&(c?panjs.loader.usesComponent(a):panjs.loader.uses(a),"undefined"==typeof window[d]))return logger&&logger.error("Unable to inherit from "+a+": class is not loaded"),null;try{window[b]=window[d].extend(e,b,d)}catch(f){alert(d+" "+f)}panjs.lastDefinedClassName=b}
function uses(b){return b.endsWith(".html")?panjs.loader.usesComponent(b):panjs.loader.uses(b)}
defineClass("Tlogger","core.Tobject",{_level:null,name:"MAIN",creationDate:null,active:!0,_currentGroup:0,_tabulation:"",tab:[],constructor:function(b){this.injectParam("_level",b.level,!1,Tlogger.INFO);this.injectParam("name",b.name,!1);this.creationDate=(new Date).getTime();this.setLevel(this._level);this.active="undefined"!=typeof console;this.razTime();this.info("Init logger LEVEL=",this.getLevelName())},razTime:function(){this.creationDate=new Date},getLevelName:function(){if(this._level==Tlogger.DEBUG)return"DEBUG";
if(this._level==Tlogger.INFO)return"INFO";if(this._level==Tlogger.WARN)return"WARN";if(this._level==Tlogger.ERROR)return"ERROR"},groupStart:function(){this.active&&(this._currentGroup++,this._calcTabultation())},groupEnd:function(){this.active&&(this._currentGroup--,this._calcTabultation())},_calcTabultation:function(){this._tabulation="";for(var b=0;b<this._currentGroup;b++)this._tabulation+="\t"},_getTime:function(){return(new Date).getTime()-this.creationDate},_debug:function(){this.active&&(console.debug?
console.debug(this._getMessage("DEBUG",arguments)):console.info(this._getMessage("DEBUG",arguments)))},_info:function(){this.active&&console.log(this._getMessage("INFO",arguments))},_warn:function(){this.active&&console.warn(this._getMessage("WARN",arguments))},_error:function(){this.active&&console.error(this._getMessage("ERROR",arguments))},_getMessage:function(b,a){for(var e="",c=0;c<a.length;c++)e+=a[c];c=this._getTime()+"ms("+this._currentGroup+")";100>c&&(c+=" ");1E3>c&&(c+=" ");1E4>c&&(c+=
" ");1E5>c&&(c+=" ");return c+" - "+b+"\t"+this._tabulation+e},setLevel:function(b){this._level=b;this.debug=this._debug;this.info=this._info;this.warn=this._warn;this.error=this._error;b>=Tlogger.INFO&&(this.debug=function(){});b>=Tlogger.WARN&&(this.info=function(){});b>=Tlogger.ERROR&&(this.warn=function(){})}});Tlogger.DEBUG=10;Tlogger.INFO=20;Tlogger.WARN=25;Tlogger.ERROR=30;panjs.logger=new Tlogger({level:Tlogger[panjs.logLevel],name:"main"});logger=panjs.logger;Ttracer=function(){};
Ttracer.getLogger=function(b){return logger};
defineClass("Tloader","core.Tobject",{queue:[],_count:0,maxImbrications:10,loadedJs:null,loadedCss:null,_lessIsLoaded:null,randomId:"",constructor:function(b){this.loadedJs={};this.loadedCss={};this.randomId=Math.random()},lessIsLoaded:function(){null==this._lessIsLoaded&&(this._lessIsLoaded=defined(window.less,"refresh"));return this._lessIsLoaded},getClassPathDir:function(b){var a=b;b.endsWith(".js")?a=b.removeEnd(".js"):b.endsWith(".html")&&(a=b.removeEnd(".html"));return a=a.substr(0,a.lastIndexOf("."))},
getUrlWithVersion:function(b){b=!1==b.contains("?")?b+"?":b+"&";b+="v="+panjs.appVersion;"dev"==panjs.env&&(b=b+"&rid="+this.randomId);return b},loadFile:function(b){try{var a={result:!1,exception:"",status:"erreur inconnue"};logger.debug("Loadfile SYNC ",b);jQuery.support.cors=!0;var e=jQuery.ajax({url:b,method:"GET",cache:!0,async:!1,dataType:"html",processData:!1,context:this,beforeSend:function(a){a.setRequestHeader("Cache-Control","no-transform")},success:function(c,e,g){this.onLoadFileSuccess(g,
b);a={result:!0,data:c}},error:function(c,f,g){this.onLoadFileError(e,f,g,b);a={result:!1,jqXHR:e,exception:g};a.status=e&&e.status?e.status:g}})}catch(c){a={result:!1,exception:c,status:c}}return a},onLoadFileSuccess:function(b,a){},onLoadFileError:function(b,a,e,c){logger.error("Echec chargement "+c+": "+e)},usesComponent:function(b){var a=panjs.getClassNameFromClassPath(b),e=null,c=null;if(this._count>this.maxImbrications)return{result:!1,message:"Too much nested components (max: "+this.maxImbrications+
")",className:a,classPath:b,url:e,path:"?",Class:null};if("undefined"==typeof window[a]){logger.groupStart();0==this._count&&logger.info(" ************ "," USESCOMPONENT ",b," ************ ");this._count++;var c=panjs.getAbsoluteUrlFromClassPath(b),e=this.getUrlWithVersion(c),d=this.loadFile(e);if(d.result){try{var f=getXmlDocument(d.data)}catch(g){return logger.error(g),{result:!1,message:g,className:a,classPath:b,url:e,path:c}}for(var l=f.getElementsByTagName("head")[0],f=f.getElementsByTagName("body")[0],
m=[],n=[],q=c.substring(0,c.lastIndexOf("/")),h=0;h<l.childNodes.length;h++){var r=l.childNodes[h],s=r.nodeName.toLowerCase();if("script"==s)try{this.addScriptNode(r,q,a)}catch(u){return d="Error processing <"+s+"> in "+a+" => "+u,logger.error(c,d),{result:!1,message:d,className:a,classPath:b,url:e,path:c,stack:u.stack}}else"link"==s?m.push(r):"style"==s&&n.push(r)}if("undefined"==typeof window[a])return d=b+" class has not been loaded. ",panjs.lastDefinedClassName!=a&&(d+="\n"+panjs.getMessage(panjs.messages.CLASSNAME_MATCHS_FILENAME,
panjs.lastDefinedClassName,c)),logger.error(d),{result:!1,message:d,className:a,classPath:b,url:e,path:c,stack:null};for(h=0;h<m.length;h++)this.addLinkNode(m[h],q);for(h=0;h<n.length;h++)logger.debug("Load style ",b),this.addStyleNode(n[h]);if(defined(f))try{var p=getXml(f),t=window[a].prototype.parentClassName;defined(window[t].prototype.html)&&window[t].prototype.html.contains("\x3c!--CONTENT--\x3e")&&(p=window[t].prototype.html.replace("\x3c!--CONTENT--\x3e",p));p=p.replace(/<body>/gi,"").replace(/<\/body>/gi,
"");p=p.replace(/\\r/gi,"").replace(/\\n/gi,"").trim();window[a].prototype.html=p;if(8==panjs.iever){var v=$("<div>"+p+"</div>");window[a].prototype.html=v[0].innerHTML}window[a].prototype.bodyNode=f}catch(w){return{result:!1,message:w.message,className:a,classPath:b,url:e,path:c,Class:null}}panjs.setSourceInComponents&&(window[a].prototype.source=d.data);window[a].prototype.classPath=b;window[a].prototype.classPathDir=this.getClassPathDir(b);window[a].prototype.className=a;window[a].prototype.dirPath=
q;window[a].lastId=0;this._count--;0==this._count&&logger.debug(" ************ "," END USESCOMPONENT ",b," ************ ");logger.groupEnd();return{result:!0,message:"ok",className:a,classPath:b,url:e,path:c,Class:window[a]}}d="Error loading "+b+": "+d.status;logger.warn(d);this._count--;logger.groupEnd();return{result:!1,message:d,className:a,classPath:b,url:e,path:c,Class:null}}return{result:!0,message:"Already loaded",className:a,classPath:b,url:e,path:c,Class:window[a]}},uses:function(b){var a=
panjs.getClassNameFromClassPath(b),e=null,e=null;if("undefined"==typeof window[b]){logger.groupStart();0==this._count&&logger.info(" ------------ "," USES ",b," ------------ ");var e=panjs.getAbsoluteUrlFromClassPath(b),c=e.substring(0,e.lastIndexOf("/"));if(this.loadedJs[e.toLowerCase()])return!0;this._count++;logger.groupStart();e=this.getUrlWithVersion(e);e=this.loadFile(e);e.result&&(e.data=this.processCode(e.data,a),exec(e.data),window[a].prototype.classPath=b,window[a].prototype.className=a,
window[a].prototype.classPathDir=this.getClassPathDir(b),window[a].prototype.dirPath=c,window[a].lastId=0,window[b]=window[a]);this._count--;logger.groupEnd();0==this._count&&logger.debug(" ------------ "," END USES ",b," ------------ ");logger.groupEnd();return!0}},addLinkNode:function(b,a){var e=panjs.transformUrl(b.getAttribute("href"),a),c=b.getAttribute("type")||"text/css",d=b.getAttribute("rel")||"stylesheet";this.loadCssFile(e,c,d)},loadCssFile:function(b,a,e){var c=!1;b=this.getUrlWithVersion(b);
if(this.loadedCss[b.toLowerCase()])return c;if(0==arguments.length)throw"loadCssFile(url, type , rel): Missing url";"undefined"==typeof a&&(a="text/css");"undefined"==typeof e&&(e="stylesheet");if(document.createStyleSheet&&8==panjs.iever)document.createStyleSheet(b),c=!0;else{var d=document.createElement("link");d.rel=e;d.type=a;d.href=b;"stylesheet/less"==e?0<panjs.iever&&8>=panjs.iever?logger.warn(panjs.getMessage(panjs.messages.LESS_IE8,panjs.iever)):this.lessIsLoaded()?(less.sheets.push(d),less.refresh(!0),
logger.debug("INJECTION LESS OK"),c=!0):logger.warn(panjs.getMessage(panjs.messages.LESS_NOT_LOADED)):(document.getElementsByTagName("head")[0].appendChild(d),c=!0)}!0==c&&logger.debug("Load <link> ASYNC: "+b);this.loadedCss[b.toLowerCase()]=!0;return c},addStyle:function(b,a){"undefined"==typeof a&&(a="text/css");$('<style type="'+a+'">'+b+"</style>").appendTo("head");"text/less"==a&&(0<panjs.iever&&8>=panjs.iever?logger.warn(panjs.getMessage(panjs.messages.LESS_IE8,panjs.iever)):this.lessIsLoaded()?
(less.refresh(),logger.debug("INJECTION LESS OK")):logger.warn(panjs.getMessage(panjs.messages.LESS_NOT_LOADED)));8==panjs.iever&&"undefined"!=typeof respond&&respond.update()},addStyleNode:function(b){var a=b.getAttribute("type");null==a&&(a="text/css");b=getText(b);this.addStyle(b,a)},processCode:function(b,a){return b.replace(/this._super/g,a+"._super")},addScriptNode:function(b,a,e){if(null==b.getAttribute("src"))a=getText(b),null!=e&&"text/x-class-definition"==b.getAttribute("type")&&(a=this.processCode(a,
e)),exec(a);else if(a=panjs.transformUrl(b.getAttribute("src"),a),this.loadedJs[a.toLowerCase()])logger.debug("Le script "+a+" est d\u00e9j\u00e0 charg\u00e9");else{var c=this.loadFile(this.getUrlWithVersion(a));null!=e&&"text/x-class-definition"==b.getAttribute("type")&&(c.data=this.processCode(c.data,e));exec(c.data);this.loadedJs[a.toLowerCase()]=1}return!0}});panjs.loader=new Tloader;
