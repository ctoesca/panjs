function exec(s){if(s==""){return}if(typeof window.execScript!="undefined"){window.execScript(s)}else{window.eval(s)}}function getDateFromTimestamp(j){var g="";if(j!=null){g=new Date(parseInt(j)*1000);var f=g.getFullYear();var h=g.getMonth()+1;if(h<10){h="0"+h}var b=g.getDate();if(b<10){b="0"+b}var a=g.getHours();if(a<10){a="0"+a}var c=g.getMinutes();if(c<10){c="0"+c}var e=g.getSeconds();if(e<10){e="0"+e}g=f+"/"+h+"/"+b+" "+a+":"+c+":"+e}return g}function generateUUID(){var b=new Date().getTime();var a="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var d=(b+Math.random()*16)%16|0;b=Math.floor(b/16);return(e=="x"?d:(d&7|8)).toString(16)});return a}function getDocHeight(){var a=document;return Math.max(Math.max(a.body.scrollHeight,a.documentElement.scrollHeight),Math.max(a.body.offsetHeight,a.documentElement.offsetHeight),Math.max(a.body.clientHeight,a.documentElement.clientHeight))}function getXml(b){var a;try{if(b.xml){a=b.xml}else{a=(new XMLSerializer()).serializeToString(b)}}catch(c){alert("Erreur getXml: "+c)}return a}function getText(a){try{var c;if(typeof a.text!="undefined"){c=a.text}else{c=a.textContent}return c}catch(b){return b}}function getXmlDocument(a){if(window.DOMParser){parser=new DOMParser();xmlDoc=parser.parseFromString(a,"text/xml")}else{xmlDoc=new ActiveXObject("Microsoft.XMLDOM");xmlDoc.async=false;xmlDoc.loadXML(a)}return xmlDoc}function defined(b){if((typeof b!="undefined")&&(b!=null)){var c=b;for(var a=1;a<arguments.length;a++){if(defined(c[arguments[a]])){c=c[arguments[a]]}else{return false}}return true}else{return false}}function getIEVersion(){var b=-1;var a=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");if(a.exec(navigator.userAgent)!=null){b=parseFloat(RegExp.$1)}return b}function getFirefoxVersion(){var b=-1;var a=new RegExp("Firefox/([0-9]*).");if(a.exec(navigator.userAgent)!=null){b=parseFloat(RegExp.$1)}return b}function getChromeVersion(){var b=-1;var a=new RegExp("Chrome/([0-9]*).");if(a.exec(navigator.userAgent)!=null){b=parseFloat(RegExp.$1)}return b}if(!Number.toFixed){Number.prototype.toFixed=function(a){var a=Math.pow(10,a);return Math.round(this*a)/a}}String.prototype.contains=function(a){return this.indexOf(a)>-1};String.prototype.trim=function(){var a=this.replace(/^\s+/g,"").replace(/\s+$/g,"");a=a.replace(/^\n+/g,"").replace(/\n+$/g,"");return a};String.prototype.gauche=function(a){var b=this.indexOf(a,0);if(b>=0){return this.substring(0,b)}else{return""}};String.prototype.capitalizeFirstLetter=function(){if(this.length==0){return this}var a=this.charAt(0).toUpperCase();if(this.length>1){a=a+this.substr(1)}return a};String.prototype.htmlEntities=function(){try{return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}catch(a){}return"ERREUR htmlEntities"};String.prototype.droite=function(a){var b=this.indexOf(a);if(b>-1){return this.substring(b+a.length,this.length)}else{return""}};String.prototype.droitedroite=function(a){var b=this.lastIndexOf(a);var c="";if(b>0){c=this.substr(b+a.length)}return c};String.prototype.isEmpty=function(){var a=this.trim();return((a=="")||(this==null))};String.prototype.startsWith=function(a){return this.indexOf(a)==0};String.prototype.endsWith=function(a){return this.lastIndexOf(a)==(this.length-a.length)};String.prototype.removeEnd=function(a){if(this.endsWith(a)){return this.substring(0,this.length-a.length)}else{return this}};String.prototype.hashCode=function(){var b=0;var a,d;if(this.length==0){return b}for(a=0;a<this.length;a++){d=this.charCodeAt(a);b=((b<<5)-b)+d;b=b&b}return b};String.prototype.removeEndCaseInsensitive=function(b){var a=((this.toLowerCase().lastIndexOf(b)+b.length)==this.length);if(a==true){var c=this.toLowerCase().lastIndexOf(b.toLowerCase());return this.substr(0,c)}return this};Array.prototype.remove=function(a){for(i=0;i<this.length;i++){if(a==this[i]){this.splice(i,1);return}}};String.prototype.nbsouschaine=function(b){var d=this;var a=0;var c=d.indexOf(b,0);while(c!=-1){a++;d=d.substring(c+b.length,d.length);c=d.indexOf(b,0)}return a};Array.prototype.pushArray=function(a){for(var b=0;b<a.length;b++){this.push(a[b])}};if(!Array.prototype.indexOf){Array.prototype.indexOf=function(c,d){for(var b=(d||0),a=this.length;b<a;b++){if(this[b]===c){return b}}return -1}}if(!Function.prototype.bind){Function.prototype.bind=function(a){if(typeof this!=="function"){throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable")}var e=Array.prototype.slice.call(arguments,1),d=this,b=function(){},c=function(){return d.apply(this instanceof b&&a?this:a,e.concat(Array.prototype.slice.call(arguments)))};b.prototype=this.prototype;c.prototype=new b();return c}}function getInternetExplorerVersion(){var c=-1;if(navigator.appName=="Microsoft Internet Explorer"){var a=navigator.userAgent;var b=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");if(b.exec(a)!=null){c=parseFloat(RegExp.$1)}}return c}if(!Array.prototype.map){Array.prototype.map=function(j,h){var b,a,c;if(this==null){throw new TypeError(" this is null or not defined")}var e=Object(this);var f=e.length>>>0;if(typeof j!=="function"){throw new TypeError(j+" is not a function")}if(h){b=h}a=new Array(f);c=0;while(c<f){var d,g;if(c in e){d=e[c];g=j.call(b,d,c,e);a[c]=g}c++}return a}}function base64encode(t){var h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";if(typeof t!=="string"){return t}if(typeof window.btoa!=="undefined"){return window.btoa(t)}var j="",u,s,r,q,o,n,m,l=0;while(l<t.length){u=t.charCodeAt(l++);s=t.charCodeAt(l++);r=t.charCodeAt(l++);q=u>>2;o=((u&3)<<4)|(s>>4);n=((s&15)<<2)|(r>>6);m=r&63;if(isNaN(s)){n=m=64}else{if(isNaN(r)){m=64}}j+=h.charAt(q)+h.charAt(o)+h.charAt(n)+h.charAt(m)}return j}function base64decode(s){if(typeof s!=="string"){return s}else{s.replace(/[^A-Za-z0-9\+\/\=]/g,"")}if(typeof window.atob!=="undefined"){return window.atob(s)}var h="",t,r,q,o,n,m,l,j=0;while(j<s.length){o=map.indexOf(s.charAt(j++));n=map.indexOf(s.charAt(j++));m=map.indexOf(s.charAt(j++));l=map.indexOf(s.charAt(j++));t=(o<<2)|(n>>4);r=((n&15)<<4)|(m>>2);q=((m&3)<<6)|l;h+=String.fromCharCode(t);if(m!=64){h+=String.fromCharCode(r)}if(l!=64){h+=String.fromCharCode(q)}}return h}$.fn.getElement=function(a){var b=$(a,this);if(b.length==0){return null}else{if(b.length==1){return b}else{if(b.length>1){return $(b[0])}}}};$.fn.getElements=function(b){var d=$(b,this);var a=$([]);if(d.length==1){a.push(d)}else{for(var c=0;c<d.length;c++){a.push($(d[c]))}}return a};function isNumberKey(b){var c=b.which;var a=b.shiftKey;var e=((c>=96)&&(c<=105));var d=((c>=48)&&(c<=57));return e||(d&&(a==true))}function isControlKey(a){var b=a.which;return(b==8)||(b==13)||(b==46)||(b==37)||(b==39)||(b==9)||(a.ctrlKey&&(b=67))||(a.ctrlKey&&(b=86))||(a.ctrlKey&&(b=88))}(function(){panjs.logger=null;panjs.root={id:"root"};panjs.loader=null;if(typeof panjs.less!="undefined"){window.less=panjs.less}else{window.less={env:"production",async:true,fileAsync:false,poll:1000,functions:{},dumpLineNumbers:"comments",relativeUrls:false,rootpath:":/a.com/"}}for(var a=0;a<panjs.namespaces.length;a++){if(typeof(panjs.namespaces[a])!="undefined"){panjs.namespaces[a].path=panjs.namespaces[a].path.replace("{version}",panjs.version)}}panjs.iever=-1;var b=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");if(b.exec(navigator.userAgent)!=null){panjs.iever=parseFloat(RegExp.$1)}panjs.createComponent=function(h,d){var e=panjs.getClassNameFromClassPath(h);if(typeof window[e]=="undefined"){var g=panjs.loader.usesComponent(h);if(!g.result){uses("core.display.TerrorElement.html");var c=new TerrorElement(g);return c}}try{var c=new window[e](d)}catch(f){uses("core.display.TerrorElement.html");var c=new TerrorElement({message:f,path:g.path,url:g.url,className:e})}if(c._onInitialized){c._onInitialized()}return c};panjs.load=function(g){if(arguments.length==0){g=$(document.body)}var d=g.getElements("[data-compo]");for(var f=0;f<d.length;f++){var h=d[f];var e=h.attr("data-compo");var j=(h.attr("autoload")!=="false");var l=h.attr("id");if(j==true){var c=panjs.createComponent(e,{elem:h[0]});h.replaceWith(c.container);c.container[0].owner=c}else{uses("core.display.TproxyDisplayObject");var c=new TproxyDisplayObject({sourceElement:h[0]});h.hide();h[0].setAttribute("id",panjs.root.id+"_"+l);h[0].originalId=l;h[0].owner=panjs.root}panjs.root[l]=c}logger.info("FIN _load");if(typeof onReady!="undefined"){onReady()}};panjs.getClassNameFromClassPath=function(f){var c=".";if((f.startsWith("http://"))||(f.startsWith("https://"))||(f[0]=="/")){c="/"}var d=f;if(f.endsWith(".html")){d=f.removeEnd(".html")}var e=d.split(c);d=e[e.length-1];return d};panjs.getAbsoluteUrlFromClassPath=function(g){var e=(g.endsWith(".html"));var d="";if((g.startsWith("http://")||g[0]=="/")){if(!e){d=g+".js"}else{d=g}}else{for(var c=0;c<panjs.namespaces.length;c++){var f=panjs.namespaces[c];if(g.startsWith(f.name)){var d=g.removeEnd(".html").replace(/\./g,"/");d=d.replace(f.name,f.path);if(e){d=d+".html"}else{d=d+".js"}break}}}return d};panjs.isAbsoluteUrl=function(c){var d=c.toLowerCase();return((d[0]=="/")||(d.toLowerCase().startsWith("http://"))||(d.toLowerCase().startsWith("https://")))};panjs.transformUrl=function(c,d){if((c[0]!="/")&&(c.substring(0,7)!="http://")&&(c.substring(0,8)!="https://")){c=d+"/"+c}return c}})();var Tobject={classHierarchy:"Tobject",extend:function(c,d,a){var b=this.prototype||Tobject;var h={};h.classHierarchy={value:b.classHierarchy+" "+d};if(panjs.iever!=8){for(k in c){h[k]={value:c[k],writable:true,configurable:true,enumerable:true}}var g=Object.create(b,h);var f=g.constructor;if(!(f instanceof Function)){throw new Error("You must define a method 'constructor'")}f.prototype=g;f.prototype.parentClassName=a;f._super=b;f.extend=this.extend}else{var e=c.constructor;for(k in b){if((k!="constructor")&&(k!="_super")){e.prototype[k]=b[k]}}for(k in c){if((k!="constructor")&&(k!="_super")){e.prototype[k]=c[k]}}e.extend=this.extend;e._super=b;e.prototype.parentClassName=a;e.prototype.classHierarchy=b.classHierarchy+" "+d;var f=e}return f},copyOwnTo:function(a,b){Object.getOwnPropertyNames(a).forEach(function(c){console.log(c);Object.defineProperty(b,c,Object.getOwnPropertyDescriptor(a,c))});return b},injectParam:function(a,b,d,c){if((typeof b=="undefined")||(b==null)){if(typeof c!="undefined"){this[a]=c;return true}else{if((typeof d!="undefined")&&(d==true)){throw"Le paramètre "+a+" n'a pas de valeur pas défaut sur object "+this.className}else{return false}}}else{this[a]=b;return true}},callLater:function(c,b){setTimeout(c.bind(this,b),50)}};function defineClass(c,a,d){var e=a.endsWith(".html");var b=panjs.getClassNameFromClassPath(a);if(typeof window[b]=="undefined"){if(e){panjs.loader.usesComponent(a)}else{panjs.loader.uses(a)}if(typeof window[b]=="undefined"){if(logger){logger.error("Impossible d'hériter de "+a+": CLASSE NON CHARGEE")}return null}}window[c]=window[b].extend(d,c,b);panjs.lastDefinedClassName=c}function uses(b){var a=b.endsWith(".html");if(a){panjs.loader.usesComponent(b)}else{panjs.loader.uses(b)}}defineClass("Tlogger","core.Tobject",{_severity:null,name:"MAIN",creationDate:null,active:true,_currentGroup:0,_tabulation:"",tab:[],constructor:function(a){this.injectParam("_severity",a.severity,false,Tlogger.INFO);this.injectParam("name",a.name,false);this.creationDate=new Date().getTime();this.setSeverity(this._severity);this.active=(typeof console!="undefined");this.razTime();this.info("Init logger SEVERITY=",this.getSeverityName())},razTime:function(){this.creationDate=new Date()},getSeverityName:function(){if(this._severity==Tlogger.DEBUG){return"DEBUG"}if(this._severity==Tlogger.INFO){return"INFO"}if(this._severity==Tlogger.WARN){return"WARN"}if(this._severity==Tlogger.ERROR){return"ERROR"}},groupStart:function(){if(this.active){this._currentGroup++;this._calcTabultation()}},groupEnd:function(){if(this.active){this._currentGroup--;this._calcTabultation()}},_calcTabultation:function(){this._tabulation="";for(var a=0;a<this._currentGroup;a++){this._tabulation+="\t"}},_getTime:function(){return new Date().getTime()-this.creationDate},_debug:function(){if(this.active){if(console.debug){console.debug(this._getMessage("DEBUG",arguments))}else{console.info(this._getMessage("DEBUG",arguments))}}},_info:function(){if(this.active){console.log(this._getMessage("INFO",arguments))}},_warn:function(){if(this.active){console.warn(this._getMessage("WARN",arguments))}},_error:function(){if(this.active){console.error(this._getMessage("ERROR",arguments))}},_getMessage:function(e,a){var d="";for(var c=0;c<a.length;c++){d+=a[c]}var b=this._getTime()+"ms("+this._currentGroup+")";if(b<100){b=b+" "}if(b<1000){b=b+" "}if(b<10000){b=b+" "}if(b<100000){b=b+" "}return b+" - "+e+"\t"+this._tabulation+d},setSeverity:function(a){this._severity=a;this.debug=this._debug;this.info=this._info;this.warn=this._warn;this.error=this._error;if(a>=Tlogger.INFO){this.debug=function(){}}if(a>=Tlogger.WARN){this.info=function(){}}if(a>=Tlogger.ERROR){this.warn=function(){}}}});Tlogger.DEBUG=10;Tlogger.INFO=20;Tlogger.WARN=25;Tlogger.ERROR=30;panjs.logger=new Tlogger({severity:Tlogger[panjs.logLevel],name:"main"});logger=panjs.logger;defineClass("Tloader","core.Tobject",{queue:[],_count:0,maxImbrications:10,loadedJs:null,loadedCss:null,_lessIsLoaded:null,constructor:function(a){this.loadedJs={};this.loadedCss={}},lessIsLoaded:function(){if(this._lessIsLoaded==null){this._lessIsLoaded=defined(window.less,"refresh")}return this._lessIsLoaded},getClassPathDir:function(c){var b=null;var a=panjs.getClassNameFromClassPath(c);if(c.endsWith(".js")){b=c.removeEnd(a+".js")}else{if(c.endsWith(".html")){b=c.removeEnd(a+".html")}else{return}}return b},getUrlWithVersion:function(a){if(a.contains("?")==false){a=a+"?version="+panjs.appVersion}else{a=a+"&version="+panjs.appVersion}if(panjs.env=="dev"){a=a+"&rid="+Math.random()}return a},loadFile:function(b){try{var a={result:false,exception:"",status:"erreur inconnue"};logger.info("Loadfile SYNC ",b);jQuery.support.cors=true;var d=jQuery.ajax({url:b,method:"GET",cache:true,async:false,dataType:"html",processData:false,context:this,success:function(f,g,e){this.onLoadFileSuccess(e,b);a={result:true,data:f}},error:function(g,f,e){this.onLoadFileError(d,f,e,b);a={result:false,jqXHR:d,exception:e};if(d&&d.status){a.status=d.status}else{a.status=e}}})}catch(c){a={result:false,exception:c,status:c}}return a},onLoadFileSuccess:function(b,a){},onLoadFileError:function(c,b,a,d){logger.error("Echec chargement "+d+": "+a)},usesComponent:function(t){var w=" ************ ";var f=panjs.getClassNameFromClassPath(t);var g=null;var q=null;if(this._count>this.maxImbrications){return{result:false,message:"Trop de composants imbriqués (max: "+this.maxImbrications+")",className:f,classPath:t,url:g,path:q}}if(typeof window[f]=="undefined"){logger.groupStart();if(this._count==0){logger.info(w," USESCOMPONENT ",t,w)}this._count++;q=panjs.getAbsoluteUrlFromClassPath(t);g=this.getUrlWithVersion(q);var o=this.loadFile(g);if(o.result){var x=getXmlDocument(o.data);var B=x.getElementsByTagName("head")[0];var b=x.getElementsByTagName("body")[0];var y=[];var m=[];var d=q.substring(0,q.lastIndexOf("/"));for(var u=0;u<B.childNodes.length;u++){var s=B.childNodes[u];var a=s.nodeName.toLowerCase();try{if(a=="script"){this.addScriptNode(s,d,f)}else{if(a=="link"){y.push(s)}else{if(a=="style"){m.push(s)}}}}catch(j){var z="Erreur chargement node "+a+" => "+j;logger.error(q,z+"\n"+j.stack);return{result:false,message:z,className:f,classPath:t,url:g,path:q,stack:j.stack}}}if(typeof window[f]=="undefined"){var z="La class "+t+" ne s'est pas chargée. ";if(panjs.lastDefinedClassName!=f){z+="\nLe nom de la classe ("+panjs.lastDefinedClassName+") doit correspondre avec le nom du fichier "+q+" (respectez la casse)"}logger.error(z);return{result:false,message:z,className:f,classPath:t,url:g,path:q,stack:null}}for(var u=0;u<y.length;u++){this.addLinkNode(y[u],d)}for(var u=0;u<m.length;u++){logger.debug("Load style ",t);this.addStyleNode(m[u])}if(defined(b)){try{var l=getXml(b);var c=window[f].prototype.parentClassName;if(defined(window[c].prototype.html)){l=window[c].prototype.html.replace("<!--CONTENT-->",l);l=l.replace(/<body>/gi,"");l=l.replace(/<\/body>/gi,"");l="<div>"+l+"</div>"}else{l=l.replace(/<body>/gi,"<div>");l=l.replace(/<\/body>/gi,"</div>")}l=l.replace(/\\r/gi,"").replace(/\\n/gi,"").trim();if(iever==8){var n=$(l);window[f].prototype.html=n[0].innerHTML}else{window[f].prototype.html=l}window[f].prototype.bodyNode=b}catch(A){return{result:false,message:A.message,className:f,classPath:t,url:g,path:q}}}else{}window[f].prototype.classPath=t;window[f].prototype.classPathDir=this.getClassPathDir(t);window[f].prototype.className=f;window[f].lastId=0;this._count--;if(this._count==0){logger.debug(w," END USESCOMPONENT ",t,w)}logger.groupEnd();return{result:true,message:"ok",className:f,classPath:t,url:g,path:q}}else{var z="Echec chargement "+t+": "+o.status;logger.warn(z);this._count--;logger.groupEnd();return{result:false,message:z,className:f,classPath:t,url:g,path:q}}}return{result:true,message:"Déjà chargé",className:f,classPath:t,url:g,path:q}},uses:function(f){var c=" ------------ ";var b=panjs.getClassNameFromClassPath(f);var a=null;var e=null;if(typeof window[b]=="undefined"){logger.groupStart();if(this._count==0){logger.info(c," USES ",f,c)}e=panjs.getAbsoluteUrlFromClassPath(f);if(this.loadedJs[e.toLowerCase()]==true){logger.info("Déjà chargé: "+e);return}this._count++;logger.groupStart();a=this.getUrlWithVersion(e);var d=this.loadFile(a);if(d.result){d.data=this.processCode(d.data,b);exec(d.data);window[b].prototype.classPath=f;window[b].prototype.className=b;window[b].prototype.classPathDir=this.getClassPathDir(f);window[b].lastId=0}logger.debug(b+" = "+typeof window[b]+" path = "+e+", result="+d.result);this._count--;logger.groupEnd();if(this._count==0){logger.debug(c," END USES ",f,c)}logger.groupEnd()}},addLinkNode:function(e,f){var b=panjs.transformUrl(e.getAttribute("href"),f);if(this.loadedCss[b.toLowerCase()]==true){logger.info("Déjà chargé: "+b);return}b=this.getUrlWithVersion(b);if((document.createStyleSheet)&&(iever==8)){document.createStyleSheet(b)}else{var a=e.getAttribute("rel");if(a==null){a="stylesheet"}var c=e.getAttribute("type");if(c==null){c="text/css"}var d=document.createElement("link");d.rel=a;d.type=c;d.href=b;if(a=="stylesheet/less"){if((iever>0)&&(iever<=8)){logger.warn("less.js n'es pas compatible avec IE"+iever+": transformer le code less en css")}else{if(this.lessIsLoaded()){less.sheets.push(d);less.refresh(true);logger.debug("INJECTION LESS OK")}else{logger.warn("LESS non chargé. Utilisez panjs_core_with_less.min.js ou bien chargez LESS avant panJs")}}}else{document.getElementsByTagName("head")[0].appendChild(d)}}logger.info("Load link ASYNC: "+b);this.loadedCss[b.toLowerCase()]=true},addStyle:function(a,b){if(typeof b=="undefined"){var b="text/css"}$('<style type="'+b+'">'+a+"</style>").appendTo("head");if(b=="text/less"){if((iever>0)&&(iever<=8)){logger.warn("less.js n'es pas compatible avec IE"+iever+": transformer le code less en css")}else{if(this.lessIsLoaded()){less.refresh();logger.debug("INJECTION LESS OK")}else{logger.warn("LESS non chargé. Utilisez panjs_core_with_less.min.js ou bien chargez LESS avant panJs")}}}},addStyleNode:function(c){var b=c.getAttribute("type");if(b==null){b="text/css"}var a=getText(c);this.addStyle(a,b)},processCode:function(c,a){var b=c;if(c.indexOf("this._super")==1){b=b.replace("this._super",a+"._super")}else{b=b.replace(/this._super/g,a+"._super")}return b},addScriptNode:function(e,f,c){if(e.getAttribute("src")==null){var a=getText(e);if((c!=null)&&(e.getAttribute("type")=="text/x-class-definition")){a=this.processCode(a,c)}else{if(c!=null){logger.warn('type="text/x-class-definition" n\'a pas été mis sur sur élément <script> de '+c)}}exec(a)}else{var b=panjs.transformUrl(e.getAttribute("src"),f);if(this.loadedJs[this.getUrlWithVersion(b).toLowerCase()]==true){logger.info("Déjà chargé: "+b)}else{var d=this.loadFile(this.getUrlWithVersion(b));if((c!=null)&&(e.getAttribute("type")=="text/x-class-definition")){d.data=this.processCode(d.data,c)}exec(d.data)}}}});panjs.loader=new Tloader();$(document).ready(function(){});defineClass("Tevent","core.Tobject",{type:null,data:null,bubbles:false,cancelable:false,currentTarget:null,cancelled:false,defaultPrevented:false,constructor:function(c,d,b,a){this.injectParam("type",c,true);this.injectParam("data",d);this.injectParam("bubbles",b);this.injectParam("cancelable",a)},preventDefault:function(){this.defaultPrevented=true}});Tevent.CLICK="CLICK";Tevent.CHANGE="CHANGE";Tevent.SUCCESS="SUCCESS";Tevent.ERROR="ERROR";Tevent.DELETE="DELETE";Tevent.UPDATE="UPDATE";Tevent.ADDED="ADDED";Tevent.LOADED="LOADED";Tevent.DATA_LOADED="DATA_LOADED";Tevent.REFRESH="REFRESH";Tevent.REPLACE="REPLACE";Tevent.ITEM_CLICKED="ITEM_CLICKED";Tevent.OPEN="OPEN";Tevent.CLOSE="CLOSE";Tevent.READY="READY";Tevent.BEFORE_STATE_CHANGE="BEFORE_STATE_CHANGE";Tevent.STATE_CHANGED="STATE_CHANGED";Tevent.SHOW="SHOW";Tevent.SHOWN="SHOWN";Tevent.HIDE="HIDE";Tevent.HIDDEN="HIDDEN";Tevent.WAITING="WAITING";uses("core.events.Tevent");defineClass("TeventDispatcher","core.Tobject",{_listeners:null,constructor:function(a){this._listeners={}},_getListenerIndex:function(b,c){if(!this.hasEventListener(b)){return -1}for(var a=0;a<this._listeners[b].length;a++){if(this._listeners[b][a].listener==c){return a}}return -1},dispatchEvent:function(c){if(!this.hasEventListener(c.type)){return}var b=this._listeners[c.type];for(var a=0;a<b.length;a++){if(b[a]!=null){var d=b[a];c.currentTarget=this;c.data=c.data||d.data;c.bind=d.bind;if(c.bind==null){d.listener(c)}else{d.listener.call(c.bind,c)}if(c.cancelled){break}}}},on:function(c,e,d,f){if(arguments.length<4){var f=null}if(arguments.length<3){var d=null}var a={listener:e,data:d,bind:f};if(!this.hasEventListener(c)){this._listeners[c]=[]}for(var b=0;b<this._listeners[c].length;b++){if(this._listeners[c][b]==null){this._listeners[c][b]=a;return}}this._listeners[c].push(a)},off:function(a,c){var b=this._getListenerIndex(a,c);if(b>=0){this._listeners[a][b]=null}},removeAllListeners:function(){for(type in this._listeners){this._listeners[type].length=0;this._listeners[type]=null;delete this._listeners[type]}},hasEventListener:function(a){return(typeof this._listeners[a]!="undefined")}});defineClass("Trouter","core.events.TeventDispatcher",{hash:"",sendEvents:true,keys:{},listeners:{},base64encode:false,constructor:function(a){Trouter._super.constructor.call(this,a);if("onhashchange" in window){window.onhashchange=this.onhashchange.bind(this)}else{logger.error("Event window.hashchanging not supported!")}},refreshkeys:function(){var a=window.location.hash.droite("#");this.keys=this.decode(a)},registerComponent:function(b,a){this.refreshkeys();this.listeners[b.hashKey]={owner:b,onhashchange:a.bind(b)}},getHash:function(a){this.refreshkeys();return this.keys[a.hashKey]},setHash:function(a,d){if(this.keys[a.hashKey]!=d){var b=this.keys[a.hashKey];this.keys[a.hashKey]=d;var e=this.encode(this.keys);sendEvents=false;window.location.hash=e;var c=this._dispatchOnhashchange(a.hashKey,d);logger.debug("RETOUR Onhashchange="+c);sendEvents=true}else{logger.debug("setHash "+d+" => inchangé")}},_dispatchOnhashchange:function(b,c){var a=this.listeners[b];return a.onhashchange(c)},decode:function(e){var d={};if((e!="")){try{if(this.base64encode){e=base64decode(e)}e=e.split("&");for(var b=0;b<e.length;b++){if(e[b].trim()!=""){var a=e[b].split("=");k=a[0];v=a[1];if(v.trim()!=""){d[k]=v}}}}catch(c){logger.error("Echec decodage de "+e+" en objet: "+c)}}else{logger.error("Echec decodage  de "+e+" en objet: chaine vide")}return d},encode:function(c){var b="";try{for(k in c){if(c[k].trim()!=""){b=b+k+"="+c[k]+"&"}}if(this.base64encode){b=base64encode(b)}}catch(a){logger.error("Echec encodage de "+c+" en string: "+a)}return b},onhashchange:function(b){if(!this.sendEvents){return false}this.hash=window.location.hash.droite("#");this.keysTmp=this.decode(this.hash);for(k in this.keysTmp){logger.debug("keys["+k+"] = "+this.keys[k]+" this.keysTmp[k] = "+this.keysTmp[k]);if(this.keysTmp[k]!=this.keys[k]){this.keys[k]=this.keysTmp[k];if(typeof this.listeners[k]!="undefined"){logger.debug("Le composant "+k+" va être notifié que son hash a changé: hash="+this.keys[k]);this._dispatchOnhashchange(k,this.keys[k])}}}var a=new Tevent(Trouter.HASH_CHANGE,this.keys);this.dispatchEvent(a);return false}});Trouter.HASH_CHANGE="HASH_CHANGE";panjs.router=new Trouter();defineClass("TproxyDisplayObject","core.events.TeventDispatcher",{autoload:false,loaded:false,sourceElement:null,parent:null,constructor:function(a){TproxyDisplayObject._super.constructor.call(this,a);this.className="TproxyDisplayObject";this.injectParam("sourceElement",a.sourceElement,true);this.sourceElement.style.display="none"},load:function(d){var e=this.sourceElement;if((e!=null)&&(this.loaded==false)){var a=e.getAttribute("data-compo");var c=e.originalId;if(arguments.length==0){var d={elem:e,parent:this.parent}}else{d.elem=e;d.parent=this.parent}var b=panjs.createComponent(a,d);b.parent=this.parent;e.owner[c]=b;$(e).replaceWith(b.container);b.loaded=true;if(b.visible){b.show()}e.setAttribute("id",e.owner.id+"_"+c);this.dispatchEvent(new Tevent(Tevent.LOADED,b));return b}},hide:function(){},show:function(){}});defineClass("TarrayCollection","core.events.TeventDispatcher",{_source:null,length:0,constructor:function(a){TarrayCollection._super.constructor.call(this,a);if(a){this._source=a}else{this._source=[]}this.length=this._source.length},sort:function(a){if(defined(a)){this._source.sort(a)}},getSource:function(){return this._source},setSource:function(a){if(this._source!=a){this._source=a;this.refresh()}},getByProp:function(g,b,a){var e=null;var f=false;if(arguments.length>2){if(a===true){e=[];f=true}}for(var c=0;c<this._source.length;c++){var d=this._source[c];if(typeof d[g]!="undefined"){if(d[g]==b){if(f==true){e.push(d)}else{e=d;break}}}}return e},replaceItem:function(c,a){var b=this.getItemIndex(c);if(b>-1){this._source[b]=a;this.length=this._source.length;this.dispatchEvent(new Tevent(Tevent.REPLACE,{item:c,newItem:a}))}},updateItem:function(a){this.dispatchEvent(new Tevent(Tevent.UPDATE,a))},getItemIndex:function(b){for(var a=0;a<this._source.length;a++){if(this._source[a]==b){return a}}return -1},getItemAt:function(a){return this._source[a]},addItem:function(b){var a=this.getItemIndex(b);if(a==-1){this._source.push(b);this.length=this._source.length;this.dispatchEvent(new Tevent(Tevent.ADDED,{item:b,index:this.length-1}))}},addItems:function(a){for(var b=0;b<a.length;b++){this._source.push(a[b])}this.length=this._source.length;this.dispatchEvent(new Tevent(Tevent.REFRESH,this))},addItemAt:function(b,a){this._source.splice(a,0,b);this.length=this._source.length;this.dispatchEvent(new Tevent(Tevent.ADDED,{item:b,index:a}))},removeItem:function(b){var a=this.getItemIndex(b);if(a>=0){this._removeItemAt(a,b)}},removeItemAt:function(b){var a=this.getItemAt(b);if(a!=null){this._removeItemAt(b,a)}},removeAll:function(){this._source=[];this.refresh()},refresh:function(){this.length=this._source.length;this.dispatchEvent(new Tevent(Tevent.REFRESH,this))},_removeItemAt:function(b,a){this._source.splice(b,1);this.length=this._source.length;this.dispatchEvent(new Tevent(Tevent.DELETE,a))}});defineClass("TdisplayObject","core.events.TeventDispatcher",{container:null,id:null,parent:null,_parent:null,visible:true,autoload:true,loaded:false,baseElement:null,_realVisible:false,load:function(){return this},_onInitialized:function(){},constructor:function(a){TdisplayObject._super.constructor.call(this,a);if(this.baseElement==null){throw'La propriété "baseElement" n\'est pas défini sur '+this.className}this.container=$("<"+this.baseElement+"/>");window[this.className].lastId++;if(!defined(a,"id")){this._setId(this.className+window[this.className].lastId)}else{this._setId(a.id)}if(a){this.injectParam("visible",a.visible,false,this.visible)}this.container[0].owner=this},appendTo:function(a){if(this._parent!=null){if(this._parent[0]!=a[0]){this._parent[0].removeChild(this.container[0]);a[0].appendChild(this.container[0]);this._parent=$(a[0])}else{}}else{a[0].appendChild(this.container[0]);this._parent=$(a[0])}},_setId:function(a){this.id=a;this.container.attr("id","ctn"+this.id)},hide:function(a){this.container.hide(a);this.visible=false;this._realVisible=this.visible;if(typeof this._onHide!="undefined"){this._onHide()}},show:function(a){if(this._realVisible){return}this.container.show(a);this.visible=true;this._realVisible=this.visible;if(typeof this._onShow!="undefined"){this._onShow()}},toggle:function(a){this.container.toggle("fast");this.visible=!this._visible}});uses("core.display.TproxyDisplayObject");defineClass("TdisplayObjectContainer","core.display.TdisplayObject",{_statesElements:null,currentState:null,defaultState:null,constructor:function(a){TdisplayObjectContainer._super.constructor.call(this,a);this._statesElements=[];this.currentState=[];if(defined(this.html)&&(this.html.trim()!="")){this.container.html(this.html);this._populateElements(this.container[0],true,[])}},processStates:function(a){var c=a.getAttribute("includeIn");if(c!=null){if(c.indexOf(",")>=0){c=c.split(",")}else{c=[c]}}var b=a.getAttribute("excludeFrom");if(b!=null){if(b.indexOf(",")>=0){b=b.split(",")}else{b=[b]}}if((c!=null)||(b!=null)){this._statesElements.push({elem:a,id:a.getAttribute("id"),includeIn:c,excludeFrom:b})}},stateExists:function(d){var c=false;if((d==null)||(d=="")){return false}for(var a=0;a<this._statesElements.length;a++){var b=this._statesElements[a];if((b.includeIn!=null)&&(b.includeIn.indexOf(d)>=0)){c=true;break}else{if((b.excludeFrom!=null)&&(b.excludeFrom.indexOf(d)>=0)){c=true;break}}}return c},_setStateElementVisible:function(b,a){if(b){if(this[a.elem.originalId]){if(this[a.elem.originalId].className){this[a.elem.originalId].load();this[a.elem.originalId].show()}else{$(a.elem).show()}}else{$(a.elem).show()}}else{if(this[a.elem.originalId]){if(this[a.elem.originalId].className){this[a.elem.originalId].hide()}else{$(a.elem).hide()}}else{$(a.elem).hide()}}},setState:function(){var c=this.currentState;this.currentState=[];var b=false;for(var d=0;d<this._statesElements.length;d++){var f=this._statesElements[d];var h=false;for(var e=0;e<arguments.length;e++){var g=arguments[e];if(this.stateExists(g)){if(h==false){if(f.includeIn!=null){h=(f.includeIn.indexOf(g)>=0)}else{h=true}}if(h==true){if(f.excludeFrom!=null){if(f.excludeFrom.indexOf(g)>=0){h=false;break}}}if(b==false){this.currentState.push(g)}}else{logger.warn(f.id+", state "+g+" n'existe pas!")}}b=true;var a=(h);this._setStateElementVisible(a,f)}for(var e=0;e<this.currentState.length;e++){this.dispatchEvent(new Tevent(Tevent.STATE_CHANGED,{oldStates:c,state:this.currentState[e]}))}},_populateElements:function(g,d,a){for(var h=0;h<g.childNodes.length;h++){var e=g.childNodes[h];if(e.nodeType==1){var b=e.getAttribute("id");var l=e.getAttribute("data-compo");if(l==null){if((d)&&(b!=null)){if(defined(this[b])){logger.error('1-Duplication du id "'+b+'" sur objet '+this.className)}this[b]=$(e);a.push(b)}this._populateElements(e,d,a)}else{if(l==this.classPath){logger.error("Référence circulaire dans "+this.classPath)}else{var m=!(e.getAttribute("autoload")==="false");if(m){var f=panjs.createComponent(l,{elem:e,parent:this});f.parent=this;if((d)&&(b!=null)){if(defined(this[b])){logger.error('2-Duplication du id "',b,'" sur objet ',this.className)}this[b]=f;a.push(b)}if(f.visible==true){$(e).replaceWith(f.container);f.container[0].owner=f}else{logger.info("PAS DE replaceWith pour ",f.id," visible = ",f.visible," ",typeof f.visible)}e.loaded=true;f.loaded=true}else{e.setAttribute("id",this.id+"_"+b);var n=new TproxyDisplayObject({sourceElement:e});n.parent=this;e.loaded=false;$(e).hide();if((d)&&(b!=null)){this[b]=n}}}}e.originalId=b;e.owner=this;this.processStates(e)}else{if(e.nodeType==8){var o="";if(iever==-1){o=e.textContent}else{if(iever<=8){o=e.text.droite("<!--").gauche("-->").trim()}}o=o.toUpperCase();if(o=="CONTENT"){var j=document.createElement("div");j.setAttribute("data-class","content");g.replaceChild(j,e);this.content=$(j)}}}}return a}});TdisplayObjectContainer._listeIdElements=[];defineClass("Telement","core.display.TdisplayObjectContainer",{html:null,content:null,sourceElement:null,inheritsStyle:true,enableHashManager:false,hashKey:null,sourceElementStyle:null,constructor:function(e){Telement._super.constructor.call(this,e);if(this.enableHashManager==true){uses("core.managers.Trouter");if(this.hashKey==null){this.hashKey=this.id}panjs.router.registerComponent(this,this._onHashChange,this.hashKey)}var c;if(this.inheritsStyle){c=this.classHierarchy.droite("Telement")}else{c=this.className}this.container.addClass(c);if(defined(e,"elem")){var g=e.elem;for(var f=0;f<g.attributes.length;f++){var b=g.attributes.item(f);var d=b.nodeName.toLowerCase();if((d!="id")&&(d!="data-compo")){if(d.startsWith("data-")){d=d.droite("-")}var h=b.value;if(h=="true"){h=true}if(h=="false"){h=false}e[d]=h}if(d=="includeinstate"){this.includeInState=h;this.container.attr("includeInState",this.includeInState)}}this.sourceElement=e.elem;if(this.content!=null){if(this.sourceElement.innerHTML.trim()!=""){this.content[0].innerHTML=this.sourceElement.innerHTML;if(typeof e.parent!="undefined"){e.parent._populateElements(this.content[0],true,[])}}}}if(e){if(e.style){this.sourceElementStyle=e.style}if(e.elem){var a=e.elem.getAttribute("data-inline-style");if(a!=null){this.sourceElementStyle=a}}}},_onHashChange:function(b){var a=false;if(this.enableHashManager){if(typeof this.onHashChange==="function"){logger.debug("Telement._onHashChange => "+b);a=this.onHashChange(b)}}return a},free:function(){},_onShow:function(){this._onHashChange(panjs.router.getHash(this))},setHash:function(a){if(this.enableHashManager){panjs.router.setHash(this,a)}},getHash:function(){if(this.enableHashManager){return panjs.router.getHash(this)}else{return null}}});defineClass("TrestClient","core.events.TeventDispatcher",{dataType:"json",exitCodeFieldName:null,errorTextFieldName:null,lastTokenId:0,extraUrlParams:null,constructor:function(a){TrestClient._super.constructor.call(this,a);this.injectParam("dataType",a.dataType,false);this.injectParam("exitCodeFieldName",a.exitCodeFieldName,false);this.injectParam("errorTextFieldName",a.errorTextFieldName,false);this.injectParam("baseUrl",a.baseUrl);this.injectParam("extraUrlParams",a.extraUrlParams)},getNewTokenId:function(){TrestClient.lastTokenId++;return TrestClient.lastTokenId},_getSuccessEvent:function(d,c,a){var b=new Tevent(Tevent.SUCCESS,d);return b},_getErrorEvent:function(f,g,d,b,c){var a={method:g,responseText:"",statusText:"Erreur inconnue",status:0,url:"url=?"};if(defined(f,"statusText")){a.statusText=f.statusText}else{a.statusText=""}if(defined(d)){a.statusText=d}if(defined(b)){a.url=b}if(defined(f,"responseText")){a.responseText=f.responseText}if(a.responseText==""){a.responseText=a.statusText}if(defined(f,"status")){a.status=f.status}if(a.status==0){a.status=1}a.token=c;try{a.data=JSON.parse(a.responseText)}catch(e){a.data=a.responseText}return new Tevent(Tevent.ERROR,a)},post:function(b,f,d,e,a,c){this._call("POST",b,f,d,e||null,a||null,c)},get:function(b,f,d,e,a,c){this._call("GET",b,f,d,e||null,a||null,c)},put:function(b,f,d,e,a,c){this._call("PUT",b,f,d,e||null,a||null,c)},del:function(b,f,d,e,a,c){this._call("DELETE",b,f,d,e||null,a||null,c)},_call:function(a,b,f,g,j,c,e){e.id=this.getNewTokenId();var d="";if(defined(f)){if(typeof f=="object"){d="?";for(p in f){d=d+p+"="+f[p]+"&"}if(d=="?"){d=""}}else{d="?"+f}}if(this.extraUrlParams){d+="&"+this.extraUrlParams}var l=this.baseUrl+b+d;logger.debug("Appel ",a,": ",l,", dataType="+this.dataType);var h=$.ajax({url:l,async:true,data:g,context:this,type:a,xhrFields:{withCredentials:true},dataType:this.dataType,success:function(o,r,n){logger.debug("Requête AJAX terminée avec succès: ",b);if(this.exitCodeFieldName!=null){var m=o[this.exitCodeFieldName];if(defined(m)){if(m!=200){var q=this._getErrorEvent(n,a,o[this.errorTextFieldName],l,e);this.dispatchEvent(q);if(defined(c)){c(q,e)}return}}}var q=this._getSuccessEvent(o,n,e);this.dispatchEvent(q);if(defined(j)){j(q,e)}},error:function(o,n,m){var q=this._getErrorEvent(o,a,m,l,e);this.dispatchEvent(q);if(defined(c)){c(q,e)}}});return h}});