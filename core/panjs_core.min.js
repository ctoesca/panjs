window.MsxmlObject=null;function exec(a){""!=a&&("undefined"!=typeof window.execScript?window.execScript(a):window.eval(a))}function getDateFromTimestamp(a){var b="";if(null!=a){b=new Date(1E3*parseInt(a));a=b.getFullYear();var c=b.getMonth()+1;10>c&&(c="0"+c);var d=b.getDate();10>d&&(d="0"+d);var e=b.getHours();10>e&&(e="0"+e);var f=b.getMinutes();10>f&&(f="0"+f);b=b.getSeconds();10>b&&(b="0"+b);b=a+"/"+c+"/"+d+" "+e+":"+f+":"+b}return b}
function generateUUID(){var a=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var c=(a+16*Math.random())%16|0;a=Math.floor(a/16);return("x"==b?c:c&7|8).toString(16)})}function getDocHeight(){var a=document;return Math.max(Math.max(a.body.scrollHeight,a.documentElement.scrollHeight),Math.max(a.body.offsetHeight,a.documentElement.offsetHeight),Math.max(a.body.clientHeight,a.documentElement.clientHeight))}
function getXml(a){return a.xml?a.xml:(new XMLSerializer).serializeToString(a)}function getText(a){return"undefined"!=typeof a.text?a.text:a.textContent}
function CreateMSXMLDocumentObject(){if(null==window.MsxmlObject){if("undefined"!=typeof ActiveXObject)for(var a="Msxml2.DOMDocument.6.0 Msxml2.DOMDocument.5.0 Msxml2.DOMDocument.4.0 Msxml2.DOMDocument.3.0 MSXML2.DOMDocument MSXML.DOMDocument".split(" "),b=0;b<a.length;b++)try{return window.MsxmlObject=new ActiveXObject(a[b]),window.MsxmlObject}catch(c){}}else return window.MsxmlObject;return null}
function getXmlDocument(a){if(window.DOMParser&&(11<=panjs.iever||-1==panjs.iever)){var b=new DOMParser;try{xmlDoc=b.parseFromString(a,"text/xml")}catch(c){throw"XML parsing error.";}}else{xmlDoc=CreateMSXMLDocumentObject();if(!xmlDoc)throw"Cannot create XMLDocument object";xmlDoc.loadXML(a)}a=null;xmlDoc.parseError&&0!=xmlDoc.parseError.errorCode?a="XML Parsing Error: "+xmlDoc.parseError.reason+" at line "+xmlDoc.parseError.line+" at position "+xmlDoc.parseError.linepos:xmlDoc.documentElement?"parsererror"==
xmlDoc.documentElement.nodeName&&(a=xmlDoc.documentElement.childNodes[0].nodeValue):a="XML Parsing Error!";if(a)throw a;return xmlDoc}function defined(a){if("undefined"!=typeof a&&null!=a){for(var b=a,c=1;c<arguments.length;c++)if(defined(b[arguments[c]]))b=b[arguments[c]];else return!1;return!0}return!1}function getIEVersion(){var a=-1;null!=/MSIE ([0-9]{1,}[.0-9]{0,})/.exec(navigator.userAgent)&&(a=parseFloat(RegExp.$1));return a}
function getFirefoxVersion(){var a=-1;null!=/Firefox\/([0-9]*)./.exec(navigator.userAgent)&&(a=parseFloat(RegExp.$1));return a}function getChromeVersion(){var a=-1;null!=/Chrome\/([0-9]*)./.exec(navigator.userAgent)&&(a=parseFloat(RegExp.$1));return a}Number.prototype.toFixed||(Number.prototype.toFixed=function(a){a=Math.pow(10,a||0);return String(Math.round(this*a)/a)});String.prototype.contains=function(a){return-1<this.indexOf(a)};
String.prototype.trim=function(){var a=this.replace(/^\s+/g,"").replace(/\s+$/g,"");return a=a.replace(/^\n+/g,"").replace(/\n+$/g,"")};String.prototype.gauche=function(a){a=this.indexOf(a,0);return 0<=a?this.substring(0,a):""};String.prototype.capitalizeFirstLetter=function(){if(0==this.length)return this;var a=this.charAt(0).toUpperCase();1<this.length&&(a+=this.substr(1));return a};
String.prototype.htmlEntities=function(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};String.prototype.droite=function(a){var b=this.indexOf(a);return-1<b?this.substring(b+a.length,this.length):""};String.prototype.droitedroite=function(a){var b=this.lastIndexOf(a);return 0<b?this.substr(b+a.length):""};String.prototype.isEmpty=function(){return""==this.trim()};String.prototype.startsWith=function(a){return 0==this.indexOf(a)};
String.prototype.endsWith=function(a){return this.lastIndexOf(a)==this.length-a.length};String.prototype.hashCode=function(){var a=0,b,c;if(0==this.length)return a;for(b=0;b<this.length;b++)c=this.charCodeAt(b),a=(a<<5)-a+c,a&=a;return a};String.prototype.removeEnd=function(a){return this.endsWith(a)?this.substring(0,this.length-a.length):this};
String.prototype.removeEndCaseInsensitive=function(a){return this.toLowerCase().lastIndexOf(a)+a.length==this.length==!0?(a=this.toLowerCase().lastIndexOf(a.toLowerCase()),this.substr(0,a)):this};Array.prototype.remove=function(a){for(i=0;i<this.length;i++)if(a==this[i]){this.splice(i,1);break}};String.prototype.nbsouschaine=function(a){for(var b=this,c=0,d=b.indexOf(a,0);-1!=d;)c++,b=b.substring(d+a.length,b.length),d=b.indexOf(a,0);return c};Array.prototype.pushArray=function(a){for(var b=0;b<a.length;b++)this.push(a[b])};
Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){for(var c=b||0,d=this.length;c<d;c++)if(this[c]===a)return c;return-1});
Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!==typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var b=Array.prototype.slice.call(arguments,1),c=this,d=function(){},e=function(){return c.apply(this instanceof d&&a?this:a,b.concat(Array.prototype.slice.call(arguments)))};d.prototype=this.prototype;e.prototype=new d;return e});
Array.prototype.map||(Array.prototype.map=function(a,b){var c,d,e;if(null==this)throw new TypeError(" this is null or not defined");var f=Object(this),g=f.length>>>0;if("function"!==typeof a)throw new TypeError(a+" is not a function");b&&(c=b);d=Array(g);for(e=0;e<g;){var h;e in f&&(h=f[e],h=a.call(c,h,e,f),d[e]=h);e++}return d});
function base64encode(a){if("string"!==typeof a)return a;if("undefined"!==typeof window.btoa)return window.btoa(a);for(var b="",c,d,e,f,g,h,m=0;m<a.length;)c=a.charCodeAt(m++),d=a.charCodeAt(m++),e=a.charCodeAt(m++),f=c>>2,c=(c&3)<<4|d>>4,g=(d&15)<<2|e>>6,h=e&63,isNaN(d)?g=h=64:isNaN(e)&&(h=64),b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(f)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(c)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(g)+
"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(h);return b}
function base64decode(a){if("string"!==typeof a)return a;a.replace(/[^A-Za-z0-9\+\/\=]/g,"");if("undefined"!==typeof window.atob)return window.atob(a);for(var b="",c,d,e,f,g,h=0;h<a.length;)c=map.indexOf(a.charAt(h++)),d=map.indexOf(a.charAt(h++)),f=map.indexOf(a.charAt(h++)),g=map.indexOf(a.charAt(h++)),c=c<<2|d>>4,d=(d&15)<<4|f>>2,e=(f&3)<<6|g,b+=String.fromCharCode(c),64!=f&&(b+=String.fromCharCode(d)),64!=g&&(b+=String.fromCharCode(e));return b}
$.fn.getElement=function(a){a=$(a,this);if(0==a.length)return null;if(1==a.length)return a;if(1<a.length)return $(a[0])};$.fn.getElements=function(a){a=$(a,this);var b=$([]);if(1==a.length)b.push(a);else for(var c=0;c<a.length;c++)b.push($(a[c]));return b};function isNumberKey(a){var b=a.which;a=a.shiftKey;return 96<=b&&105>=b||48<=b&&57>=b&&!0==a}function isControlKey(a){var b=a.which;return 8==b||13==b||46==b||37==b||39==b||9==b||a.ctrlKey&&67||a.ctrlKey&&86||a.ctrlKey&&88}
(function(){panjs.logger=null;panjs.root={id:"root"};panjs.loader=null;panjs.iever=getIEVersion();panjs.chromever=getChromeVersion();panjs.ffver=getFirefoxVersion();panjs.stack=[];panjs.stackLevel=0;panjs.messages={CLASSNAME_MATCHS_FILENAME:"The name of the class (%1) must match the file name %2 (case sensitive)",LESS_IE8:"less.js is not fully compatible with IE%1 : transform less code in css",LESS_NOT_LOADED:"LESS not loaded. Use panjs_core_with_less.min.js or load LESS (before panJs)"};panjs.getMessage=
function(a){for(var c=1;c<arguments.length;c++){var d=arguments[c];null==d&&(d="null");a=a.replace("%"+c,d)}return a};window.less="undefined"!=typeof panjs.less?panjs.less:{env:"production",async:!0,fileAsync:!1,poll:1E3,functions:{},dumpLineNumbers:"comments",relativeUrls:!1,rootpath:":/a.com/"};for(var a=0;a<panjs.namespaces.length;a++)"undefined"!=typeof panjs.namespaces[a]&&(panjs.namespaces[a].path=panjs.namespaces[a].path.replace("{version}",panjs.version));panjs.createComponent=function(a,
c){panjs.stackLevel++;var d=panjs.getClassNameFromClassPath(a),e=null;if("undefined"==typeof window[d]){var f=panjs.loader.usesComponent(a);if(!f.result)return uses("core.display.TerrorElement.html"),e=new TerrorElement(f),panjs.stack.push(f.message),panjs.stackLevel--,0>=panjs.stackLevel&&(panjs.stack=[],panjs.stackLevel=0),e}try{e=new window[d](c)}catch(g){f="Error instantiating "+d+": "+g;logger.error(f);uses("core.display.TerrorElement.html");var e=panjs.getAbsoluteUrlFromClassPath(a),h=panjs.loader.getUrlWithVersion(e),
e=new TerrorElement({message:g,path:e,url:h,className:d});panjs.stack.push(f)}panjs.stackLevel--;0>=panjs.stackLevel&&(panjs.stack=[],panjs.stackLevel=0);e._onInitialized&&e._onInitialized();return e};panjs.load=function(a){panjs._load(a)};panjs._load=function(a){0==arguments.length&&(a=$(document.body));var c=[];null!=a.attr("data-compo")?c.push(a):c=a.getElements("[data-compo]");for(var d=0;d<c.length;d++){var e=c[d],f=e.attr("data-compo"),g="false"!==e.attr("autoload"),h=e.attr("id");!0==g?(f=
panjs.createComponent(f,{elem:e[0]}),e.replaceWith(f.container),f.container[0].owner=f):(uses("core.display.TproxyDisplayObject"),f=new TproxyDisplayObject({sourceElement:e[0]}),e.hide(),e[0].setAttribute("id",panjs.root.id+"_"+h),e[0].originalId=h,e[0].owner=panjs.root);panjs.root[h]=f}logger.info("READY");"undefined"!=typeof onReady&&onReady()};panjs.getClassNameFromClassPath=function(a){var c=".";if(a.startsWith("http://")||a.startsWith("https://")||"/"==a[0])c="/";var d=a;a.endsWith(".html")&&
(d=a.removeEnd(".html"));a=d.split(c);return d=a[a.length-1]};panjs.getNamespace=function(a){for(var c=0;c<panjs.namespaces.length;c++){var d=panjs.namespaces[c];if(d.name==a)return d}return null};panjs.getAbsoluteUrlFromClassPath=function(a){var c=a.endsWith(".html"),d="";if(a.startsWith("http://")||"/"==a[0])d=c?a:a+".js";else for(var e=0;e<panjs.namespaces.length;e++){var f=panjs.namespaces[e];if(a.startsWith(f.name+".")){d=a.removeEnd(".html").replace(/\./g,"/");d=d.replace(f.name,f.path);d=c?
d+".html":d+".js";break}}return d};panjs.isAbsoluteUrl=function(a){a=a.toLowerCase();return"/"==a[0]||a.toLowerCase().startsWith("http://")||a.toLowerCase().startsWith("https://")};panjs.transformUrl=function(a,c){"/"!=a[0]&&"http://"!=a.substring(0,7)&&"https://"!=a.substring(0,8)&&(a=c+"/"+a);return a}})();
var Tobject={classHierarchy:"Tobject",extend:function(a,b,c){var d=this.prototype||Tobject,e={};e.classHierarchy={value:d.classHierarchy+" "+b};if(8!=panjs.iever){for(k in a)e[k]={value:a[k],writable:!0,configurable:!0,enumerable:!0};a=Object.create(d,e);b=a.constructor;if(!(b instanceof Function))throw Error("You must define a method 'constructor'");b.prototype=a;b.prototype.parentClassName=c;b._super=d;b.extend=this.extend}else{e=a.constructor;for(k in d)"constructor"!=k&&"_super"!=k&&(e.prototype[k]=
d[k]);for(k in a)"constructor"!=k&&"_super"!=k&&(e.prototype[k]=a[k]);e.extend=this.extend;e._super=d;e.prototype.parentClassName=c;e.prototype.classHierarchy=d.classHierarchy+" "+b;b=e}return b},copyOwnTo:function(a,b){Object.getOwnPropertyNames(a).forEach(function(c){console.log(c);Object.defineProperty(b,c,Object.getOwnPropertyDescriptor(a,c))});return b},injectParam:function(a,b,c,d){if("undefined"==typeof b||null==b){if("undefined"!=typeof d)return this[a]=d,!0;if("undefined"!=typeof c&&!0==
c)throw"The "+a+" argument has no default value on "+this.className;return!1}this[a]=b;return!0},callLater:function(a,b){setTimeout(a.bind(this,b),50)}};
function defineClass(a,b,c){var d=b.endsWith(".html"),e=panjs.getClassNameFromClassPath(b);if("undefined"==typeof window[e]&&(d?panjs.loader.usesComponent(b):panjs.loader.uses(b),"undefined"==typeof window[e]))return logger&&logger.error("Unable to inherit from "+b+": class is not loaded"),null;window[a]=window[e].extend(c,a,e);panjs.lastDefinedClassName=a}function uses(a){a.endsWith(".html")?panjs.loader.usesComponent(a):panjs.loader.uses(a)}
defineClass("Tlogger","core.Tobject",{_level:null,name:"MAIN",creationDate:null,active:!0,_currentGroup:0,_tabulation:"",tab:[],constructor:function(a){this.injectParam("_level",a.level,!1,Tlogger.INFO);this.injectParam("name",a.name,!1);this.creationDate=(new Date).getTime();this.setLevel(this._level);this.active="undefined"!=typeof console;this.razTime();this.info("Init logger LEVEL=",this.getLevelName())},razTime:function(){this.creationDate=new Date},getLevelName:function(){if(this._level==Tlogger.DEBUG)return"DEBUG";
if(this._level==Tlogger.INFO)return"INFO";if(this._level==Tlogger.WARN)return"WARN";if(this._level==Tlogger.ERROR)return"ERROR"},groupStart:function(){this.active&&(this._currentGroup++,this._calcTabultation())},groupEnd:function(){this.active&&(this._currentGroup--,this._calcTabultation())},_calcTabultation:function(){this._tabulation="";for(var a=0;a<this._currentGroup;a++)this._tabulation+="\t"},_getTime:function(){return(new Date).getTime()-this.creationDate},_debug:function(){this.active&&(console.debug?
console.debug(this._getMessage("DEBUG",arguments)):console.info(this._getMessage("DEBUG",arguments)))},_info:function(){this.active&&console.log(this._getMessage("INFO",arguments))},_warn:function(){this.active&&console.warn(this._getMessage("WARN",arguments))},_error:function(){this.active&&console.error(this._getMessage("ERROR",arguments))},_getMessage:function(a,b){for(var c="",d=0;d<b.length;d++)c+=b[d];d=this._getTime()+"ms("+this._currentGroup+")";100>d&&(d+=" ");1E3>d&&(d+=" ");1E4>d&&(d+=
" ");1E5>d&&(d+=" ");return d+" - "+a+"\t"+this._tabulation+c},setLevel:function(a){this._level=a;this.debug=this._debug;this.info=this._info;this.warn=this._warn;this.error=this._error;a>=Tlogger.INFO&&(this.debug=function(){});a>=Tlogger.WARN&&(this.info=function(){});a>=Tlogger.ERROR&&(this.warn=function(){})}});Tlogger.DEBUG=10;Tlogger.INFO=20;Tlogger.WARN=25;Tlogger.ERROR=30;panjs.logger=new Tlogger({level:Tlogger[panjs.logLevel],name:"main"});logger=panjs.logger;
defineClass("Tloader","core.Tobject",{queue:[],_count:0,maxImbrications:10,loadedJs:null,loadedCss:null,_lessIsLoaded:null,constructor:function(a){this.loadedJs={};this.loadedCss={}},lessIsLoaded:function(){null==this._lessIsLoaded&&(this._lessIsLoaded=defined(window.less,"refresh"));return this._lessIsLoaded},getClassPathDir:function(a){var b=null,b=panjs.getClassNameFromClassPath(a);if(a.endsWith(".js"))b=a.removeEnd(b+".js");else if(a.endsWith(".html"))b=a.removeEnd(b+".html");else return;return b},
getUrlWithVersion:function(a){a=!1==a.contains("?")?a+"?":a+"&";a+="v="+panjs.appVersion;"dev"==panjs.env&&(a=a+"&rid="+Math.random());return a},loadFile:function(a){try{var b={result:!1,exception:"",status:"erreur inconnue"};logger.debug("Loadfile SYNC ",a);jQuery.support.cors=!0;var c=jQuery.ajax({url:a,method:"GET",cache:!0,async:!1,dataType:"html",processData:!1,context:this,success:function(c,d,g){this.onLoadFileSuccess(g,a);b={result:!0,data:c}},error:function(d,f,g){this.onLoadFileError(c,
f,g,a);b={result:!1,jqXHR:c,exception:g};b.status=c&&c.status?c.status:g}})}catch(d){b={result:!1,exception:d,status:d}}return b},onLoadFileSuccess:function(a,b){},onLoadFileError:function(a,b,c,d){logger.error("Echec chargement "+d+": "+c)},usesComponent:function(a){var b=panjs.getClassNameFromClassPath(a),c=null,d=null;if(this._count>this.maxImbrications)return{result:!1,message:"Too much nested components (max: "+this.maxImbrications+")",className:b,classPath:a,url:c,path:"?"};if("undefined"==
typeof window[b]){logger.groupStart();0==this._count&&logger.info(" ************ "," USESCOMPONENT ",a," ************ ");this._count++;var d=panjs.getAbsoluteUrlFromClassPath(a),c=this.getUrlWithVersion(d),e=this.loadFile(c);if(e.result){try{var f=getXmlDocument(e.data)}catch(g){return logger.error(g),{result:!1,message:g,className:b,classPath:a,url:c,path:d}}for(var e=f.getElementsByTagName("head")[0],f=f.getElementsByTagName("body")[0],h=[],m=[],s=d.substring(0,d.lastIndexOf("/")),n=0;n<e.childNodes.length;n++){var q=
e.childNodes[n],r=q.nodeName.toLowerCase();if("script"==r)try{this.addScriptNode(q,s,b)}catch(t){var l="Error processing <"+r+"> in "+b+" => "+t;logger.error(d,l);return{result:!1,message:l,className:b,classPath:a,url:c,path:d,stack:t.stack}}else"link"==r?h.push(q):"style"==r&&m.push(q)}if("undefined"==typeof window[b])return l=a+" class has not been loaded. ",panjs.lastDefinedClassName!=b&&(l+="\n"+panjs.getMessage(panjs.messages.CLASSNAME_MATCHS_FILENAME,panjs.lastDefinedClassName,d)),logger.error(l),
{result:!1,message:l,className:b,classPath:a,url:c,path:d,stack:null};for(n=0;n<h.length;n++)this.addLinkNode(h[n],s);for(n=0;n<m.length;n++)logger.debug("Load style ",a),this.addStyleNode(m[n]);if(defined(f))try{var l=getXml(f),u=window[b].prototype.parentClassName;defined(window[u].prototype.html)?(l=window[u].prototype.html.replace("\x3c!--CONTENT--\x3e",l),l="<div>"+l.replace(/<body>/gi,"").replace(/<\/body>/gi,"")+"</div>"):l=l.replace(/<body>/gi,"<div>").replace(/<\/body>/gi,"</div>");l=l.replace(/\\r/gi,
"").replace(/\\n/gi,"").trim();window[b].prototype.html=l;8==panjs.iever&&(window[b].prototype.html=$(l)[0].innerHTML);window[b].prototype.bodyNode=f}catch(w){return{result:!1,message:w.message,className:b,classPath:a,url:c,path:d}}window[b].prototype.classPath=a;window[b].prototype.classPathDir=this.getClassPathDir(a);window[b].prototype.className=b;window[b].prototype.dirPath=s;window[b].lastId=0;this._count--;0==this._count&&logger.debug(" ************ "," END USESCOMPONENT ",a," ************ ");
logger.groupEnd();return{result:!0,message:"ok",className:b,classPath:a,url:c,path:d}}l="Error loading "+a+": "+e.status;logger.warn(l);this._count--;logger.groupEnd();return{result:!1,message:l,className:b,classPath:a,url:c,path:d}}return{result:!0,message:"Already loaded",className:b,classPath:a,url:c,path:d}},uses:function(a){var b=panjs.getClassNameFromClassPath(a),c=null,c=null;if("undefined"==typeof window[b]){logger.groupStart();0==this._count&&logger.info(" ------------ "," USES ",a," ------------ ");
c=panjs.getAbsoluteUrlFromClassPath(a);if(this.loadedJs[c.toLowerCase()])return!0;this._count++;logger.groupStart();c=this.getUrlWithVersion(c);c=this.loadFile(c);c.result&&(c.data=this.processCode(c.data,b),exec(c.data),window[b].prototype.classPath=a,window[b].prototype.className=b,window[b].prototype.classPathDir=this.getClassPathDir(a),window[b].lastId=0);this._count--;logger.groupEnd();0==this._count&&logger.debug(" ------------ "," END USES ",a," ------------ ");logger.groupEnd();return!0}},
addLinkNode:function(a,b){var c=panjs.transformUrl(a.getAttribute("href"),b),d=a.getAttribute("type")||"text/css",e=a.getAttribute("rel")||"stylesheet";this.loadCssFile(c,d,e)},loadCssFile:function(a,b,c){var d=!1;if(this.loadedCss[a.toLowerCase()])return d;var e=arguments.length;if(0==e)throw"loadCssFile(url, type , rel): Missing url";2==e&&(c="stylesheet/less");a=this.getUrlWithVersion(a);document.createStyleSheet&&8==panjs.iever?(document.createStyleSheet(a),d=!0):(e=document.createElement("link"),
e.rel=c,e.type=b,e.href=a,"stylesheet/less"==c?0<panjs.iever&&8>=panjs.iever?logger.warn(panjs.getMessage(panjs.messages.LESS_IE8,panjs.iever)):this.lessIsLoaded()?(less.sheets.push(e),less.refresh(!0),logger.debug("INJECTION LESS OK"),d=!0):logger.warn(panjs.getMessage(panjs.messages.LESS_NOT_LOADED)):(document.getElementsByTagName("head")[0].appendChild(e),d=!0));!0==d&&logger.debug("Load <link> ASYNC: "+a);this.loadedCss[a.toLowerCase()]=!0;return d},addStyle:function(a,b){"undefined"==typeof b&&
(b="text/css");$('<style type="'+b+'">'+a+"</style>").appendTo("head");"text/less"==b&&(0<panjs.iever&&8>=panjs.iever?logger.warn(panjs.getMessage(panjs.messages.LESS_IE8,panjs.iever)):this.lessIsLoaded()?(less.refresh(),logger.debug("INJECTION LESS OK")):logger.warn(panjs.getMessage(panjs.messages.LESS_NOT_LOADED)))},addStyleNode:function(a){var b=a.getAttribute("type");null==b&&(b="text/css");a=getText(a);this.addStyle(a,b)},processCode:function(a,b){return a.replace(/this._super/g,b+"._super")},
addScriptNode:function(a,b,c){if(null==a.getAttribute("src"))b=getText(a),null!=c&&"text/x-class-definition"==a.getAttribute("type")?b=this.processCode(b,c):null!=c&&logger.warn('type="text/x-class-definition" doesn\'t exist on <script> ('+c+")"),exec(b);else if(b=panjs.transformUrl(a.getAttribute("src"),b),this.loadedJs[b.toLowerCase()])logger.debug("Le script "+b+" est d\u00e9j\u00e0 charg\u00e9");else{var d=this.loadFile(this.getUrlWithVersion(b));null!=c&&"text/x-class-definition"==a.getAttribute("type")&&
(d.data=this.processCode(d.data,c));exec(d.data);this.loadedJs[b.toLowerCase()]=1}return!0}});panjs.loader=new Tloader;defineClass("Tevent","core.Tobject",{type:null,data:null,bubbles:!1,cancelable:!1,currentTarget:null,cancelled:!1,defaultPrevented:!1,constructor:function(a,b,c,d){this.injectParam("type",a,!0);this.injectParam("data",b);this.injectParam("bubbles",c);this.injectParam("cancelable",d)},preventDefault:function(){this.defaultPrevented=!0}});Tevent.CLICK="CLICK";Tevent.CHANGE="CHANGE";
Tevent.SUCCESS="SUCCESS";Tevent.ERROR="ERROR";Tevent.DELETE="DELETE";Tevent.UPDATE="UPDATE";Tevent.ADDED="ADDED";Tevent.LOADED="LOADED";Tevent.DATA_LOADED="DATA_LOADED";Tevent.REFRESH="REFRESH";Tevent.REPLACE="REPLACE";Tevent.ITEM_CLICKED="ITEM_CLICKED";Tevent.OPEN="OPEN";Tevent.CLOSE="CLOSE";Tevent.READY="READY";Tevent.BEFORE_STATE_CHANGE="BEFORE_STATE_CHANGE";Tevent.STATE_CHANGED="STATE_CHANGED";Tevent.SHOW="SHOW";Tevent.SHOWN="SHOWN";Tevent.HIDE="HIDE";Tevent.HIDDEN="HIDDEN";Tevent.WAITING="WAITING";
uses("core.events.Tevent");
defineClass("TeventDispatcher","core.Tobject",{_listeners:null,constructor:function(a){this._listeners={}},_getListenerIndex:function(a,b){if(!this.hasEventListener(a))return-1;for(var c=0;c<this._listeners[a].length;c++)if(this._listeners[a][c].listener==b)return c;return-1},dispatchEvent:function(a){if(this.hasEventListener(a.type))for(var b=this._listeners[a.type],c=0;c<b.length;c++)if(null!=b[c]){var d=b[c];a.currentTarget=this;a.data=a.data||d.data;a.bind=d.bind;null==a.bind?d.listener(a):d.listener.call(a.bind,
a);if(a.cancelled)break}},on:function(a,b,c,d){4>arguments.length&&(d=null);3>arguments.length&&(c=null);var e={listener:b,data:c,bind:d};this.hasEventListener(a)||(this._listeners[a]=[]);for(var f=0;f<this._listeners[a].length;f++)if(null==this._listeners[a][f]){this._listeners[a][f]=e;return}this._listeners[a].push(e)},off:function(a,b){var c=this._getListenerIndex(a,b);0<=c&&(this._listeners[a][c]=null)},removeAllListeners:function(){for(type in this._listeners)this._listeners[type].length=0,this._listeners[type]=
null,delete this._listeners[type]},hasEventListener:function(a){return"undefined"!=typeof this._listeners[a]}});
defineClass("Trouter","core.events.TeventDispatcher",{hash:"",sendEvents:!0,keys:{},listeners:{},base64encode:!1,constructor:function(a){Trouter._super.constructor.call(this,a);"onhashchange"in window?window.onhashchange=this.onhashchange.bind(this):logger.error("Event window.hashchanging not supported!")},refreshkeys:function(){var a=window.location.hash.droite("#");this.keys=this.decode(a)},registerComponent:function(a,b){this.refreshkeys();this.listeners[a.hashKey]={owner:a,onhashchange:b.bind(a)}},
getHash:function(a){this.refreshkeys();return this.keys[a.hashKey]},setHash:function(a,b){if(this.keys[a.hashKey]!=b){this.keys[a.hashKey]=b;var c=this.encode(this.keys);sendEvents=!1;window.location.hash=c;c=this._dispatchOnhashchange(a.hashKey,b);logger.debug("RETOUR Onhashchange="+c);sendEvents=!0}else logger.debug("setHash "+b+" => inchang\u00e9")},_dispatchOnhashchange:function(a,b){return this.listeners[a].onhashchange(b)},decode:function(a){var b={};if(""!=a)try{this.base64encode&&(a=base64decode(a));
a=a.split("&");for(var c=0;c<a.length;c++)if(""!=a[c].trim()){var d=a[c].split("=");k=d[0];v=d[1];""!=v.trim()&&(b[k]=v)}}catch(e){logger.error("Echec decodage de "+a+" en objet: "+e)}else logger.error("Echec decodage  de "+a+" en objet: chaine vide");return b},encode:function(a){var b="";try{for(k in a)""!=a[k].trim()&&(b=b+k+"="+a[k]+"&");this.base64encode&&(b=base64encode(b))}catch(c){logger.error("Echec encodage de "+a+" en string: "+c)}return b},onhashchange:function(a){if(!this.sendEvents)return!1;
this.hash=window.location.hash.droite("#");this.keysTmp=this.decode(this.hash);for(k in this.keysTmp)logger.debug("keys["+k+"] = "+this.keys[k]+" this.keysTmp[k] = "+this.keysTmp[k]),this.keysTmp[k]!=this.keys[k]&&(this.keys[k]=this.keysTmp[k],"undefined"!=typeof this.listeners[k]&&(logger.debug("Le composant "+k+" va \u00eatre notifi\u00e9 que son hash a chang\u00e9: hash="+this.keys[k]),this._dispatchOnhashchange(k,this.keys[k])));a=new Tevent(Trouter.HASH_CHANGE,this.keys);this.dispatchEvent(a);
return!1}});Trouter.HASH_CHANGE="HASH_CHANGE";panjs.router=new Trouter;
defineClass("TproxyDisplayObject","core.events.TeventDispatcher",{autoload:!1,loaded:!1,sourceElement:null,parent:null,constructor:function(a){TproxyDisplayObject._super.constructor.call(this,a);this.className="TproxyDisplayObject";this.injectParam("sourceElement",a.sourceElement,!0);this.sourceElement.style.display="none"},load:function(a){var b=this.sourceElement;if(null!=b&&!1==this.loaded){var c=b.getAttribute("data-compo"),d=b.originalId;0==arguments.length?a={elem:b,parent:this.parent}:(a.elem=
b,a.parent=this.parent);c=panjs.createComponent(c,a);c.parent=this.parent;b.owner[d]=c;$(b).replaceWith(c.container);c.loaded=!0;c.visible&&c.show();b.setAttribute("id",b.owner.id+"_"+d);this.dispatchEvent(new Tevent(Tevent.LOADED,c));return c}},hide:function(){},show:function(){}});
defineClass("TarrayCollection","core.events.TeventDispatcher",{_source:null,length:0,constructor:function(a){TarrayCollection._super.constructor.call(this,a);this._source=a?a:[];this.length=this._source.length},sort:function(a){defined(a)&&this._source.sort(a)},getSource:function(){return this._source},setSource:function(a){this._source!=a&&(this._source=a,this.refresh())},getByProp:function(a,b,c){var d=null,e=!1;2<arguments.length&&!0===c&&(d=[],e=!0);for(var f=0;f<this._source.length;f++){var g=
this._source[f];if("undefined"!=typeof g[a]&&g[a]==b)if(!0==e)d.push(g);else{d=g;break}}return d},replaceItem:function(a,b){var c=this.getItemIndex(a);-1<c&&(this._source[c]=b,this.length=this._source.length,this.dispatchEvent(new Tevent(Tevent.REPLACE,{item:a,newItem:b})))},updateItem:function(a){this.dispatchEvent(new Tevent(Tevent.UPDATE,a))},getItemIndex:function(a){for(var b=0;b<this._source.length;b++)if(this._source[b]==a)return b;return-1},getItemAt:function(a){return this._source[a]},addItem:function(a){-1==
this.getItemIndex(a)&&(this._source.push(a),this.length=this._source.length,this.dispatchEvent(new Tevent(Tevent.ADDED,{item:a,index:this.length-1})))},addItems:function(a){for(var b=0;b<a.length;b++)this._source.push(a[b]);this.length=this._source.length;this.dispatchEvent(new Tevent(Tevent.REFRESH,this))},addItemAt:function(a,b){this._source.splice(b,0,a);this.length=this._source.length;this.dispatchEvent(new Tevent(Tevent.ADDED,{item:a,index:b}))},removeItem:function(a){var b=this.getItemIndex(a);
0<=b&&this._removeItemAt(b,a)},removeItemAt:function(a){var b=this.getItemAt(a);null!=b&&this._removeItemAt(a,b)},removeAll:function(){this._source=[];this.refresh()},refresh:function(){this.length=this._source.length;this.dispatchEvent(new Tevent(Tevent.REFRESH,this))},_removeItemAt:function(a,b){this._source.splice(a,1);this.length=this._source.length;this.dispatchEvent(new Tevent(Tevent.DELETE,b))}});
defineClass("TdisplayObject","core.events.TeventDispatcher",{container:null,id:null,parent:null,_parent:null,visible:!0,autoload:!0,loaded:!1,baseElement:null,_realVisible:!1,load:function(){return this},_onInitialized:function(){},constructor:function(a){TdisplayObject._super.constructor.call(this,a);if(null==this.baseElement)throw'La propri\u00e9t\u00e9 "baseElement" n\'est pas d\u00e9fini sur '+this.className;this.container=$("<"+this.baseElement+"/>");window[this.className].lastId++;defined(a,
"id")?this._setId(a.id):this._setId(this.className+window[this.className].lastId);a&&this.injectParam("visible",a.visible,!1,this.visible);this.container[0].owner=this},appendTo:function(a){null!=this._parent?this._parent[0]!=a[0]&&(this._parent[0].removeChild(this.container[0]),a[0].appendChild(this.container[0]),this._parent=$(a[0])):(a[0].appendChild(this.container[0]),this._parent=$(a[0]))},_setId:function(a){this.id=a;this.container.attr("id","ctn"+this.id)},hide:function(a){this.container.hide(a);
this._realVisible=this.visible=!1;"undefined"!=typeof this._onHide&&this._onHide()},show:function(a){this._realVisible||(this.container.show(a),this._realVisible=this.visible=!0,"undefined"!=typeof this._onShow&&this._onShow())},toggle:function(a){this.container.toggle("fast");this.visible=!this._visible}});uses("core.display.TproxyDisplayObject");
defineClass("TdisplayObjectContainer","core.display.TdisplayObject",{_statesElements:null,currentState:null,defaultState:null,constructor:function(a){TdisplayObjectContainer._super.constructor.call(this,a);this._statesElements=[];this.currentState=[];defined(this.html)&&""!=this.html.trim()&&(this.container.html(this.html),this._populateElements(this.container[0],!0,[]))},processStates:function(a){var b=a.getAttribute("includeIn");null!=b&&(b=0<=b.indexOf(",")?b.split(","):[b]);var c=a.getAttribute("excludeFrom");
null!=c&&(c=0<=c.indexOf(",")?c.split(","):[c]);null==b&&null==c||this._statesElements.push({elem:a,id:a.getAttribute("id"),includeIn:b,excludeFrom:c})},stateExists:function(a){var b=!1;if(null==a||""==a)return!1;for(var c=0;c<this._statesElements.length;c++){var d=this._statesElements[c];if(null!=d.includeIn&&0<=d.includeIn.indexOf(a)){b=!0;break}else if(null!=d.excludeFrom&&0<=d.excludeFrom.indexOf(a)){b=!0;break}}return b},_setStateElementVisible:function(a,b){a?this[b.elem.originalId]?this[b.elem.originalId].className?
(this[b.elem.originalId].load(),this[b.elem.originalId].show()):$(b.elem).show():$(b.elem).show():this[b.elem.originalId]?this[b.elem.originalId].className?this[b.elem.originalId].hide():$(b.elem).hide():$(b.elem).hide()},setState:function(){var a=this.currentState;this.currentState=[];for(var b=!1,c=0;c<this._statesElements.length;c++){for(var d=this._statesElements[c],e=!1,f=0;f<arguments.length;f++){var g=arguments[f];if(this.stateExists(g)){!1==e&&(e=null!=d.includeIn?0<=d.includeIn.indexOf(g):
!0);if(!0==e&&null!=d.excludeFrom&&0<=d.excludeFrom.indexOf(g)){e=!1;break}!1==b&&this.currentState.push(g)}else logger.warn(d.id+", state "+g+" n'existe pas!")}b=!0;this._setStateElementVisible(e,d)}for(f=0;f<this.currentState.length;f++)this.dispatchEvent(new Tevent(Tevent.STATE_CHANGED,{oldStates:a,state:this.currentState[f]}))},_populateElements:function(a,b,c){for(var d=0;d<a.childNodes.length;d++){var e=a.childNodes[d];if(1==e.nodeType){var f=e.getAttribute("id"),g=e.getAttribute("data-compo");
null==g?(b&&null!=f&&(defined(this[f])&&logger.error('1-Duplication du id "'+f+'" sur objet '+this.className),this[f]=$(e),c.push(f)),this._populateElements(e,b,c)):g==this.classPath?logger.error("R\u00e9f\u00e9rence circulaire dans "+this.classPath):"false"!==e.getAttribute("autoload")?(g=panjs.createComponent(g,{elem:e,parent:this}),g.parent=this,b&&null!=f&&(defined(this[f])&&logger.error('2-Duplication du id "',f,'" sur objet ',this.className),this[f]=g,c.push(f)),!0==g.visible?($(e).replaceWith(g.container),
g.container[0].owner=g):logger.info("PAS DE replaceWith pour ",g.id," visible = ",g.visible," ",typeof g.visible),e.loaded=!0,g.loaded=!0):(e.setAttribute("id",this.id+"_"+f),g=new TproxyDisplayObject({sourceElement:e}),g.parent=this,e.loaded=!1,$(e).hide(),b&&null!=f&&(this[f]=g));e.originalId=f;e.owner=this;this.processStates(e)}else 8==e.nodeType&&(f="",f=-1==panjs.iever||8<panjs.iever?e.textContent:e.text.droite("\x3c!--").gauche("--\x3e").trim(),f=f.toUpperCase(),"CONTENT"==f&&(f=document.createElement("div"),
f.setAttribute("data-class","content"),a.replaceChild(f,e),this.content=$(f)))}return c}});TdisplayObjectContainer._listeIdElements=[];
defineClass("Telement","core.display.TdisplayObjectContainer",{html:null,content:null,sourceElement:null,inheritsStyle:!0,enableHashManager:!1,hashKey:null,sourceElementStyle:null,constructor:function(a){Telement._super.constructor.call(this,a);!0==this.enableHashManager&&(uses("core.managers.Trouter"),null==this.hashKey&&(this.hashKey=this.id),panjs.router.registerComponent(this,this._onHashChange,this.hashKey));var b;b=this.inheritsStyle?this.classHierarchy.droite("Telement"):this.className;this.container.addClass(b);
if("undefined"!=typeof a){if(defined(a,"elem")){b=a.elem;for(var c=0;c<b.attributes.length;c++){var d=b.attributes.item(c),e=d.nodeName.toLowerCase();if("id"!=e&&"data-compo"!=e){e.startsWith("data-")&&(e=e.droite("-"));var f=d.value;"true"==f&&(f=!0);"false"==f&&(f=!1);a[e]=f}"includeinstate"==e&&(this.includeInState=f,this.container.attr("includeInState",this.includeInState))}this.sourceElement=a.elem;null!=this.content&&""!=this.sourceElement.innerHTML.trim()&&(this.content[0].innerHTML=this.sourceElement.innerHTML,
"undefined"!=typeof a.parent&&a.parent._populateElements(this.content[0],!0,[]))}a.elem&&(a=a.elem.getAttribute("data-inline-style"),null!=a&&(this.sourceElementStyle=a,this.setStyle(a)))}},setStyle:function(a){this.container.attr("style",a)},_onHashChange:function(a){var b=!1;this.enableHashManager&&"function"===typeof this.onHashChange&&(logger.debug("Telement._onHashChange => "+a),b=this.onHashChange(a));return b},free:function(){},_onShow:function(){this._onHashChange(panjs.router.getHash(this))},
setHash:function(a){this.enableHashManager&&panjs.router.setHash(this,a)},getHash:function(){return this.enableHashManager?panjs.router.getHash(this):null}});
defineClass("TrestClient","core.events.TeventDispatcher",{dataType:"json",exitCodeFieldName:null,errorTextFieldName:null,lastTokenId:0,extraUrlParams:null,constructor:function(a){TrestClient._super.constructor.call(this,a);this.injectParam("dataType",a.dataType,!1);this.injectParam("exitCodeFieldName",a.exitCodeFieldName,!1);this.injectParam("errorTextFieldName",a.errorTextFieldName,!1);this.injectParam("baseUrl",a.baseUrl);this.injectParam("extraUrlParams",a.extraUrlParams)},getNewTokenId:function(){TrestClient.lastTokenId++;
return TrestClient.lastTokenId},_getSuccessEvent:function(a,b,c){return new Tevent(Tevent.SUCCESS,a)},_getErrorEvent:function(a,b,c,d,e){b={method:b,responseText:"",statusText:"Erreur inconnue",status:0,url:"url=?"};defined(a,"statusText")?b.statusText=a.statusText:b.statusText="";defined(c)&&(b.statusText=c);defined(d)&&(b.url=d);defined(a,"responseText")&&(b.responseText=a.responseText);""==b.responseText&&(b.responseText=b.statusText);defined(a,"status")&&(b.status=a.status);0==b.status&&(b.status=
1);b.token=e;try{b.data=JSON.parse(b.responseText)}catch(f){b.data=b.responseText}return new Tevent(Tevent.ERROR,b)},post:function(a,b,c,d,e,f){this._call("POST",a,b,c,d||null,e||null,f)},get:function(a,b,c,d,e,f){this._call("GET",a,b,c,d||null,e||null,f)},put:function(a,b,c,d,e,f){this._call("PUT",a,b,c,d||null,e||null,f)},del:function(a,b,c,d,e,f){this._call("DELETE",a,b,c,d||null,e||null,f)},_call:function(a,b,c,d,e,f,g){g.id=this.getNewTokenId();var h="";if(defined(c))if("object"==typeof c){h=
"?";for(p in c)h=h+p+"="+c[p]+"&";"?"==h&&(h="")}else h="?"+c;this.extraUrlParams&&(h+="&"+this.extraUrlParams);var m=this.baseUrl+b+h;logger.debug("Appel ",a,": ",m,", dataType="+this.dataType);return $.ajax({url:m,async:!0,data:d,context:this,type:a,xhrFields:{withCredentials:!0},dataType:this.dataType,success:function(c,d,h){logger.debug("Requ\u00eate AJAX termin\u00e9e avec succ\u00e8s: ",b);logger.debug("X-Time="+h.getResponseHeader("X-Time"));if(null!=this.exitCodeFieldName&&(d=c[this.exitCodeFieldName],
defined(d)&&200!=d)){c=this._getErrorEvent(h,a,c[this.errorTextFieldName],m,g);this.dispatchEvent(c);defined(f)&&f(c,g);return}c=this._getSuccessEvent(c,h,g);this.dispatchEvent(c);defined(e)&&e(c,g)},error:function(b,c,d){b=this._getErrorEvent(b,a,d,m,g);this.dispatchEvent(b);defined(f)&&f(b,g)}})}});
