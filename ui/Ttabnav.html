 <html>        
<head>
<style type="text/css">

.Ttabnav div.tab-content{
	padding-top:10px;
}


</style>

<script subtype="text/x-class-definition">

//<![CDATA[      

defineClass("Ttabnav", "core.display.Telement", { 

	baseElement: "div",	
	tabs: null,
	selectedIndex: 0,
	headersStyle: null,
	headersClass: null,
	autoloadComponents: true,
	
	constructor: function(args)
	{	
		this._super.constructor.call(this,args);
		this.tabs = [];

		if (defined(args, "selectedIndex"))
			this.selectedIndex = args["selectedIndex"];
		if (defined(args, "headersStyle"))
			this.headersStyle = args["headersStyle"];
		if (defined(args, "headersClass"))
			this.headersClass = args["headersClass"];
		if (defined(args, "autoloadComponents"))
			this.autoloadComponents = args["autoloadComponents"];


		/* Attention sur IE childnodes bouge quand on modifie le conteneur */
		var tabIndx = -1;
		for (var i=0; i < this.content[0].childNodes.length; i++)
		{
			var node = this.content[0].childNodes[i];

			if (node.nodeType == 1)
			{	
				tabIndx ++;
				el = $(node);
				var id = el.attr("id");			
				el.attr("id", this.container.attr("id")+"_tab"+tabIndx);
				this.createTab(el);	
			}	
		}
	
		this.selectTab(this.selectedIndex);
	},
	/*_populateElements: function(element, setObject, r)
	{	
		logger.debug("DEBUT _populateElements ***************** "+element.outerHTML);
		var r = this._super._populateElements.call(this, element, setObject, r);
		logger.debug("FIN _populateElements ***************** "+element.outerHTML);
		return r;
	},*/

    createTab: function(el)
	{
		var label = el.attr("label");

		var visible = false;
		if (el.attr("visible") != "false") visible = true;
		
		el.addClass("tab-pane");


		var headersStyle = "";	
		if (this.headersStyle != null)
			headersStyle = this.headersStyle;

		var headersClass = "";	
		if (this.headersClass != null)
			headersClass = this.headersClass;

		var li = $('<li style="'+headersStyle+'" class="'+headersClass+'"/>');
		if (visible == false)
			li.css("display", "none");
			
		var a = $('<a tabIndex="'+(this.tabs.length)+'" data-toggle="tab" >'+label+'</a>');
		//href="#'+el.attr("id")+'"
		a.on('click', this.onTabClick.bind(this));
		//a.on('show.bs.tab', this.onTabClick.bind(this));

		li.append(a);
		this.myTab.append(li);
		this.tabContent.append(el);
		var tab = {elem:el, link:a, li: li, visible: visible, subComponentsLoaded: false};
		this.tabs.push(tab);
	},

	onTabClick: function(e)
	{
		var a = $(e.target);
		var indx = a.attr("tabIndex");
		this.selectTab(indx);
		e.preventDefault();
		return false;
	},

	_inactivateAll: function()
	{
		for (var i=0; i<this.tabs.length; i++){
			this.tabs[i].elem.removeClass("active");
			this.tabs[i].link.removeClass("active");
			this.tabs[i].li.removeClass("active");
		}
	},
	loadSubComponents: function(tab)
	{
		if  ((this.parent == null)||(tab.subComponentsLoaded)|| (this.autoloadComponents == false))
			return;

		var composToLoad = tab.elem.getElements('[autoload="false"]');
		for (var i = 0; i < composToLoad.length; i++) {
			var compo = composToLoad[i];
			this.parent[compo[0].originalId].load();
		};
		tab.subComponentsLoaded = true;
	},

	selectTab: function(indx)
	{
		var tab = this.tabs[indx];
		if (tab.visible == false)
			this.showTab(indx);

		this.loadSubComponents(tab);

		this._inactivateAll();
		tab.link.parent().addClass("active");
		//tab.link.focus();
		tab.elem.addClass("active");
		if (this.selectedIndex != indx)
		{
			this.selectedIndex = indx;
			this.dispatchEvent(new Tevent("TAB_CHANGE", {tab: tab.elem, indx:indx}));
		}
		
	},

	hideTab: function(indx)
	{
		var tab = this.tabs[indx];		
		tab.li.hide();
		tab.visible = false;
	},
	showTab: function(indx)
	{
		var tab = this.tabs[indx];		
		tab.li.show();
		tab.visible = true;
	}
	
	

});
//]]>
</script>

</head>
<body>	
	
	
	<ul id="myTab" class="nav nav-tabs">
	
	</ul>
	<div id="tabContent" class="tab-content">
		<!--CONTENT-->
	</div>

</body>
</html> 









