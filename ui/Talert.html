<html>        
<head>

<style>
.Talert
{
	color:#222;	
}
.Talert .modal-body
{
	font-size: 1.1em;
}

.Talert .modal-footer button
{
	display:none;
}

</style>

<script type="text/x-class-definition">
//<![CDATA[

defineClass("Talert", "ui.TtitleWindow.html", { 

	_data : null,
	message: "",
	buttons: null,
	closeHandler: null,

	constructor: function(args){ 
		
		this._title = "Demande de confirmation";
		this.iconHtml = '<i class="fa fa-2x fa-question" ></i>';

		this._super.constructor.call(this,args);	
		
		this.iconContainer.css("color", "#F87217");

		this.injectParam("message", args.message,false, this.message);	
		this.injectParam("_data", args.data,false, this._data);
		this.injectParam("closeHandler", args.closehandler,false, null);
		this.injectParam("buttons", args.buttons,false, [Talert.OK]);

		if (typeof this.buttons == "string"){
			var f = function(v)
			{
				eval("var t = "+v+";");
				return t;
			}
			this.buttons = f(this.buttons);
		}

		if (this.buttons != null)
		for (var i=0; i< this.buttons.length; i++)
		{
			var b = this.footer.getElement('button[action="'+this.buttons[i]+'"]');
			if (b != null)
				b.show();
		}
	
		this.buttonClose.remove();

		this.body.html(this.message);
	},	
	
	_setEvents: function()
	{	
		this._super._setEvents.call(this);	
		this.boutonCancel.on("click", this._onClickButton.bind(this));
		this.boutonYes.on("click", this._onClickButton.bind(this));
		this.boutonNo.on("click", this._onClickButton.bind(this));
		this.boutonOk.on("click", this._onClickButton.bind(this));
	},

	_onClickButton: function(e)
	{
		var action = $(e.target).attr("action");
		this.close(e, action);
	},

	_onHide: function()
	{
		logger.debug('Talert._onHide');
	},
	getCloseEvent: function(action)
	{
		var evt =  new Tevent(Tevent.CLOSE);
	},

	close: function(e, action)
	{	
		var evt =  new Tevent(Tevent.CLOSE);
	
		if (typeof action == "undefined")
			evt.action = null; //L'évenement ne vient pas d'un des boutons mais du clavier (ESC) ou appel de close()
		else
			evt.action = action;
		
		evt.data = this._data;
		this.dispatchEvent( evt );

		if (this.closeHandler)
		this.closeHandler(evt);

		return evt;
	}
});

Talert.OK = "Ok";
Talert.YES = "Oui";
Talert.NO = "Non";
Talert.CANCEL = "Annuler";

Talert.show = function(message, buttons, closeHandler, data, iconhtml, title, fade)
{
	uses("ui.managers.TpopupManager.html");
	message = message.replace(/\n/g,'<br/>');
	
	var p = panjs.PopupManager.createPopup(Talert, 
	{
		message:message,
		buttons: buttons,
		closehandler: closeHandler,
		data: data,
		iconhtml: iconhtml,
		title: title
	}, 
	{ 
		fade: fade
	});
	return p;
}
Talert.warn = function(message, buttons, closeHandler, data, iconhtml, title, fade)
{
	if (!defined(iconhtml))
		var iconhtml = '<i class="glyphicon glyphicon-exclamation-sign" style="font-size:200%; color:#f0ad4e"/>';

	var _title = "Avertissement";
	if ((typeof title != "undefined") && (title != null))
		_title = title;

	Talert.show(message, buttons, closeHandler, data, iconhtml, _title, fade);	
}
Talert.info = function(message, buttons, closeHandler, data, iconhtml, title, fade)
{
	if (!defined(iconhtml))
		var iconhtml = '<i class="glyphicon glyphicon-info-sign" style="font-size:200%; color:#428bca"/>';
	
	var _title = "Info";
	if ((typeof title != "undefined") && (title != null))
		_title = title;
	
	Talert.show(message, buttons, closeHandler, data, iconhtml, _title, fade);	
}
Talert.error = function(message, buttons, closeHandler, data, iconhtml, title, fade)
{
	if (!defined(iconhtml))
		var iconhtml = '<i class="glyphicon glyphicon-remove" style="font-size:200%;color:#d9534f"/>';

	var _title = "Erreur";
	if ((typeof title != "undefined") && (title != null))
		_title = title;
	
	Talert.show(message, buttons, closeHandler, data, iconhtml, _title, fade);	
}
//]]>
</script>

</head>
<body>		 

	<div class="modal-body" id="body" >
	<!--CONTENT-->
	</div>

	<div class="modal-footer" id="footer">
		<button type="button" action="Annuler" class="btn btn-default" id="boutonCancel">Annuler</button>
		<button type="button" action="Non" class="btn btn-default" id="boutonNo">Non</button>
		<button type="submit" action="Oui" class="btn btn-primary" id="boutonYes">Oui</button>
		<button type="submit" action="Ok" class="btn btn-primary" id="boutonOk">Ok</button>
	</div>

</body>
</html> 
