<html>        
<head>
  <style type="text/css">
    .app9
    {
      border: 1px solid #bce8f1;
      border-radius: 4px;
      padding:5px;
    }
  </style>

  <script type="text/x-class-definition">
    //<![CDATA[      

    uses("core.helpers.Ttimer");

    defineClass("app9", "core.display.Telement", { 

      baseElement: "div", 
      circles: null,
      N: 10,

      constructor: function(args){
          this._super.constructor.call(this,args);  

          //we dot not affect circles in the properies because it would affect all the prototype chain.
          this.circles = [];

          //Create N circles
          for (var i = 0; i< this.N; i++)
            this.addCircle();

          //Create the timer with a delay of 10 ms and listen for "ON_TIMER" event.
          this.timer = new Ttimer({delay: 10, onTimer: this.onTimer.bind(this)});
        
        },

        addCircle: function(){
          var circle = new this.createComponent("components.Tcircle.html");
          circle.appendTo(this.circlesContainer);
          this.circles.push(circle);
        },

        onTimer: function(evt){
          for (var i = 0; i< this.circles.length; i++)
            this.circles[i].tick();
        }
      });
    //]]>
  </script>

</head>
<body>  
  <!-- in btnStart.onclick and btnStop.onclick, we execute code, so we use {{ }}-->
  <button id="btnStart" data-onclick="{{this.timer.start()}}">Start</button>
  <button id="btnStop" data-onclick="{{this.timer.stop()}}">Stop</button>

  <div id="circlesContainer"/>
  <div style="clear: both"/>
</body>
</html> 
