<html>        
<head>
  <style type="text/css">
    .app9
    {
      border: 1px solid #bce8f1;
      border-radius: 4px;
      padding:5px;
    }
  </style>

  <script type="text/x-class-definition">
    //<![CDATA[      

    uses("core.helpers.Ttimer");

    defineClass("app9", "core.display.Telement", { 

      baseElement: "div", 
      circles: null,
      N: 10,

      constructor: function(args){
          this._super.constructor.call(this,args);  

          this.circles = [];

          //Create N circles
          for (var i = 0; i< this.N; i++){
            this.addCircle();
          }

          //Create the timer with a delay of 10 ms and listen for "ON_TIMER" event.
          this.timer = new Ttimer({delay: 10});
          this.timer.on(Ttimer.ON_TIMER, this.onTimer.bind(this));

          //Listen for click events on buttons
          this.btnStart.on("click", function(){
            this.timer.start();
          }.bind(this));

          this.btnStop.on("click", function(){
            this.timer.stop();
          }.bind(this));
        },

        addCircle: function(){
          var circle = new panjs.createComponent("components.Tcircle.html");
          circle.appendTo(this.circlesContainer);
          this.circles.push(circle);
        },

        onTimer: function(evt){
          for (var i = 0; i< this.circles.length; i++)
            this.circles[i].tick();
        }
      });
    //]]>
  </script>

</head>
<body>  
  <button id="btnStart">Start</button>
  <button id="btnStop">Stop</button>
  <div id="circlesContainer" style="height:40px"/>
</body>
</html> 
